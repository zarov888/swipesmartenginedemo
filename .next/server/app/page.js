(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2319:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>r.a,__next_app__:()=>u,originalPathname:()=>h,pages:()=>d,routeModule:()=>x,tree:()=>c}),s(908),s(1506),s(5866);var i=s(3191),a=s(8716),n=s(7922),r=s.n(n),l=s(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,908)),"/Users/noahzaroff/Downloads/stop-engine-lab/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,1506)),"/Users/noahzaroff/Downloads/stop-engine-lab/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/noahzaroff/Downloads/stop-engine-lab/app/page.tsx"],h="/page",u={require:s,loadChunk:()=>Promise.resolve()},x=new i.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},9702:()=>{},3619:(e,t,s)=>{Promise.resolve().then(s.bind(s,8014))},7811:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},8014:(e,t,s)=>{"use strict";let i;s.r(t),s.d(t,{default:()=>ot});var a,n,r=s(326),l=s(7577);function o(e){return null!==e&&"object"==typeof e&&"function"==typeof e.start}let c=e=>Array.isArray(e);function d(e,t){if(!Array.isArray(t))return!1;let s=t.length;if(s!==e.length)return!1;for(let i=0;i<s;i++)if(t[i]!==e[i])return!1;return!0}function h(e){return"string"==typeof e||Array.isArray(e)}function u(e){let t=[{},{}];return null==e||e.values.forEach((e,s)=>{t[0][s]=e.get(),t[1][s]=e.getVelocity()}),t}function x(e,t,s,i){if("function"==typeof t){let[a,n]=u(i);t=t(void 0!==s?s:e.custom,a,n)}if("string"==typeof t&&(t=e.variants&&e.variants[t]),"function"==typeof t){let[a,n]=u(i);t=t(void 0!==s?s:e.custom,a,n)}return t}function m(e,t,s){let i=e.getProps();return x(i,t,void 0!==s?s:i.custom,e)}let p=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],g=["initial",...p];function f(e){let t;return()=>(void 0===t&&(t=e()),t)}let y=f(()=>void 0!==window.ScrollTimeline);class v{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let s=0;s<this.animations.length;s++)this.animations[s][e]=t}attachTimeline(e,t){let s=this.animations.map(s=>y()&&s.attachTimeline?s.attachTimeline(e):"function"==typeof t?t(s):void 0);return()=>{s.forEach((e,t)=>{e&&e(),this.animations[t].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class b extends v{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function j(e,t){return e?e[t]||e.default||e:void 0}function w(e){let t=0,s=e.next(t);for(;!s.done&&t<2e4;)t+=50,s=e.next(t);return t>=2e4?1/0:t}function N(e){return"function"==typeof e}function k(e,t){e.timeline=t,e.onfinish=null}let S=e=>Array.isArray(e)&&"number"==typeof e[0],C={linearEasing:void 0},R=function(e,t){let s=f(e);return()=>{var e;return null!==(e=C[t])&&void 0!==e?e:s()}}(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0},"linearEasing"),T=(e,t,s)=>{let i=t-e;return 0===i?1:(s-e)/i},P=(e,t,s=10)=>{let i="",a=Math.max(Math.round(t/s),2);for(let t=0;t<a;t++)i+=e(T(0,a-1,t))+", ";return`linear(${i.substring(0,i.length-2)})`},M=([e,t,s,i])=>`cubic-bezier(${e}, ${t}, ${s}, ${i})`,D={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:M([0,.65,.55,1]),circOut:M([.55,0,1,.45]),backIn:M([.31,.01,.66,-.59]),backOut:M([.33,1.53,.69,.99])},A={x:!1,y:!1};function E(e,t){let s=function(e,t,s){if(e instanceof Element)return[e];if("string"==typeof e){let t=document.querySelectorAll(e);return t?Array.from(t):[]}return Array.from(e)}(e),i=new AbortController;return[s,{passive:!0,...t,signal:i.signal},()=>i.abort()]}function F(e){return t=>{"touch"===t.pointerType||A.x||A.y||e(t)}}let $=(e,t)=>!!t&&(e===t||$(e,t.parentElement)),I=e=>"mouse"===e.pointerType?"number"!=typeof e.button||e.button<=0:!1!==e.isPrimary,L=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]),O=new WeakSet;function V(e){return t=>{"Enter"===t.key&&e(t)}}function B(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}let z=(e,t)=>{let s=e.currentTarget;if(!s)return;let i=V(()=>{if(O.has(s))return;B(s,"down");let e=V(()=>{B(s,"up")});s.addEventListener("keyup",e,t),s.addEventListener("blur",()=>B(s,"cancel"),t)});s.addEventListener("keydown",i,t),s.addEventListener("blur",()=>s.removeEventListener("keydown",i),t)};function U(e){return I(e)&&!(A.x||A.y)}let _=e=>1e3*e,Z=e=>e/1e3,H=e=>e,W=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],q=new Set(W),G=new Set(["width","height","top","left","right","bottom",...W]),X=e=>!!(e&&"object"==typeof e&&e.mix&&e.toValue),K=e=>c(e)?e[e.length-1]||0:e,Y={skipAnimations:!1,useManualTiming:!1},J=["read","resolveKeyframes","update","preRender","render","postRender"];function Q(e,t){let s=!1,i=!0,a={delta:0,timestamp:0,isProcessing:!1},n=()=>s=!0,r=J.reduce((e,t)=>(e[t]=function(e){let t=new Set,s=new Set,i=!1,a=!1,n=new WeakSet,r={delta:0,timestamp:0,isProcessing:!1};function l(t){n.has(t)&&(o.schedule(t),e()),t(r)}let o={schedule:(e,a=!1,r=!1)=>{let l=r&&i?t:s;return a&&n.add(e),l.has(e)||l.add(e),e},cancel:e=>{s.delete(e),n.delete(e)},process:e=>{if(r=e,i){a=!0;return}i=!0,[t,s]=[s,t],t.forEach(l),t.clear(),i=!1,a&&(a=!1,o.process(e))}};return o}(n),e),{}),{read:l,resolveKeyframes:o,update:c,preRender:d,render:h,postRender:u}=r,x=()=>{let n=Y.useManualTiming?a.timestamp:performance.now();s=!1,a.delta=i?1e3/60:Math.max(Math.min(n-a.timestamp,40),1),a.timestamp=n,a.isProcessing=!0,l.process(a),o.process(a),c.process(a),d.process(a),h.process(a),u.process(a),a.isProcessing=!1,s&&t&&(i=!1,e(x))},m=()=>{s=!0,i=!0,a.isProcessing||e(x)};return{schedule:J.reduce((e,t)=>{let i=r[t];return e[t]=(e,t=!1,a=!1)=>(s||m(),i.schedule(e,t,a)),e},{}),cancel:e=>{for(let t=0;t<J.length;t++)r[J[t]].cancel(e)},state:a,steps:r}}let{schedule:ee,cancel:et,state:es,steps:ei}=Q("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:H,!0);function ea(){i=void 0}let en={now:()=>(void 0===i&&en.set(es.isProcessing||Y.useManualTiming?es.timestamp:performance.now()),i),set:e=>{i=e,queueMicrotask(ea)}};function er(e,t){-1===e.indexOf(t)&&e.push(t)}function el(e,t){let s=e.indexOf(t);s>-1&&e.splice(s,1)}class eo{constructor(){this.subscriptions=[]}add(e){return er(this.subscriptions,e),()=>el(this.subscriptions,e)}notify(e,t,s){let i=this.subscriptions.length;if(i){if(1===i)this.subscriptions[0](e,t,s);else for(let a=0;a<i;a++){let i=this.subscriptions[a];i&&i(e,t,s)}}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}let ec=e=>!isNaN(parseFloat(e)),ed={current:void 0};class eh{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(e,t=!0)=>{let s=en.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),t&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=en.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=ec(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new eo);let s=this.events[e].add(t);return"change"===e?()=>{s(),ee.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(let e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){t&&this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e,t)}setWithVelocity(e,t,s){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return ed.current&&ed.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){var e;let t=en.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||t-this.updatedAt>30)return 0;let s=Math.min(this.updatedAt-this.prevUpdatedAt,30);return e=parseFloat(this.current)-parseFloat(this.prevFrameValue),s?1e3/s*e:0}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function eu(e,t){return new eh(e,t)}let ex=e=>!!(e&&e.getVelocity);function em(e,t){let s=e.getValue("willChange");if(ex(s)&&s.add)return s.add(t)}let ep=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),eg="data-"+ep("framerAppearId"),ef={current:!1},ey=(e,t,s)=>(((1-3*s+3*t)*e+(3*s-6*t))*e+3*t)*e;function ev(e,t,s,i){if(e===t&&s===i)return H;let a=t=>(function(e,t,s,i,a){let n,r;let l=0;do(n=ey(r=t+(s-t)/2,i,a)-e)>0?s=r:t=r;while(Math.abs(n)>1e-7&&++l<12);return r})(t,0,1,e,s);return e=>0===e||1===e?e:ey(a(e),t,i)}let eb=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,ej=e=>t=>1-e(1-t),ew=ev(.33,1.53,.69,.99),eN=ej(ew),ek=eb(eN),eS=e=>(e*=2)<1?.5*eN(e):.5*(2-Math.pow(2,-10*(e-1))),eC=e=>1-Math.sin(Math.acos(e)),eR=ej(eC),eT=eb(eC),eP=e=>/^0[^.\s]+$/u.test(e),eM=(e,t,s)=>s>t?t:s<e?e:s,eD={test:e=>"number"==typeof e,parse:parseFloat,transform:e=>e},eA={...eD,transform:e=>eM(0,1,e)},eE={...eD,default:1},eF=e=>Math.round(1e5*e)/1e5,e$=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,eI=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,eL=(e,t)=>s=>!!("string"==typeof s&&eI.test(s)&&s.startsWith(e)||t&&null!=s&&Object.prototype.hasOwnProperty.call(s,t)),eO=(e,t,s)=>i=>{if("string"!=typeof i)return i;let[a,n,r,l]=i.match(e$);return{[e]:parseFloat(a),[t]:parseFloat(n),[s]:parseFloat(r),alpha:void 0!==l?parseFloat(l):1}},eV=e=>eM(0,255,e),eB={...eD,transform:e=>Math.round(eV(e))},ez={test:eL("rgb","red"),parse:eO("red","green","blue"),transform:({red:e,green:t,blue:s,alpha:i=1})=>"rgba("+eB.transform(e)+", "+eB.transform(t)+", "+eB.transform(s)+", "+eF(eA.transform(i))+")"},eU={test:eL("#"),parse:function(e){let t="",s="",i="",a="";return e.length>5?(t=e.substring(1,3),s=e.substring(3,5),i=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),s=e.substring(2,3),i=e.substring(3,4),a=e.substring(4,5),t+=t,s+=s,i+=i,a+=a),{red:parseInt(t,16),green:parseInt(s,16),blue:parseInt(i,16),alpha:a?parseInt(a,16)/255:1}},transform:ez.transform},e_=e=>({test:t=>"string"==typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>`${t}${e}`}),eZ=e_("deg"),eH=e_("%"),eW=e_("px"),eq=e_("vh"),eG=e_("vw"),eX={...eH,parse:e=>eH.parse(e)/100,transform:e=>eH.transform(100*e)},eK={test:eL("hsl","hue"),parse:eO("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:s,alpha:i=1})=>"hsla("+Math.round(e)+", "+eH.transform(eF(t))+", "+eH.transform(eF(s))+", "+eF(eA.transform(i))+")"},eY={test:e=>ez.test(e)||eU.test(e)||eK.test(e),parse:e=>ez.test(e)?ez.parse(e):eK.test(e)?eK.parse(e):eU.parse(e),transform:e=>"string"==typeof e?e:e.hasOwnProperty("red")?ez.transform(e):eK.transform(e)},eJ=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,eQ="number",e0="color",e1=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function e2(e){let t=e.toString(),s=[],i={color:[],number:[],var:[]},a=[],n=0,r=t.replace(e1,e=>(eY.test(e)?(i.color.push(n),a.push(e0),s.push(eY.parse(e))):e.startsWith("var(")?(i.var.push(n),a.push("var"),s.push(e)):(i.number.push(n),a.push(eQ),s.push(parseFloat(e))),++n,"${}")).split("${}");return{values:s,split:r,indexes:i,types:a}}function e5(e){return e2(e).values}function e3(e){let{split:t,types:s}=e2(e),i=t.length;return e=>{let a="";for(let n=0;n<i;n++)if(a+=t[n],void 0!==e[n]){let t=s[n];t===eQ?a+=eF(e[n]):t===e0?a+=eY.transform(e[n]):a+=e[n]}return a}}let e4=e=>"number"==typeof e?0:e,e8={test:function(e){var t,s;return isNaN(e)&&"string"==typeof e&&((null===(t=e.match(e$))||void 0===t?void 0:t.length)||0)+((null===(s=e.match(eJ))||void 0===s?void 0:s.length)||0)>0},parse:e5,createTransformer:e3,getAnimatableNone:function(e){let t=e5(e);return e3(e)(t.map(e4))}},e6=new Set(["brightness","contrast","saturate","opacity"]);function e9(e){let[t,s]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;let[i]=s.match(e$)||[];if(!i)return e;let a=s.replace(i,""),n=e6.has(t)?1:0;return i!==s&&(n*=100),t+"("+n+a+")"}let e7=/\b([a-z-]*)\(.*?\)/gu,te={...e8,getAnimatableNone:e=>{let t=e.match(e7);return t?t.map(e9).join(" "):e}},tt={...eD,transform:Math.round},ts={borderWidth:eW,borderTopWidth:eW,borderRightWidth:eW,borderBottomWidth:eW,borderLeftWidth:eW,borderRadius:eW,radius:eW,borderTopLeftRadius:eW,borderTopRightRadius:eW,borderBottomRightRadius:eW,borderBottomLeftRadius:eW,width:eW,maxWidth:eW,height:eW,maxHeight:eW,top:eW,right:eW,bottom:eW,left:eW,padding:eW,paddingTop:eW,paddingRight:eW,paddingBottom:eW,paddingLeft:eW,margin:eW,marginTop:eW,marginRight:eW,marginBottom:eW,marginLeft:eW,backgroundPositionX:eW,backgroundPositionY:eW,rotate:eZ,rotateX:eZ,rotateY:eZ,rotateZ:eZ,scale:eE,scaleX:eE,scaleY:eE,scaleZ:eE,skew:eZ,skewX:eZ,skewY:eZ,distance:eW,translateX:eW,translateY:eW,translateZ:eW,x:eW,y:eW,z:eW,perspective:eW,transformPerspective:eW,opacity:eA,originX:eX,originY:eX,originZ:eW,zIndex:tt,size:eW,fillOpacity:eA,strokeOpacity:eA,numOctaves:tt},ti={...ts,color:eY,backgroundColor:eY,outlineColor:eY,fill:eY,stroke:eY,borderColor:eY,borderTopColor:eY,borderRightColor:eY,borderBottomColor:eY,borderLeftColor:eY,filter:te,WebkitFilter:te},ta=e=>ti[e];function tn(e,t){let s=ta(e);return s!==te&&(s=e8),s.getAnimatableNone?s.getAnimatableNone(t):void 0}let tr=new Set(["auto","none","0"]),tl=e=>e===eD||e===eW,to=(e,t)=>parseFloat(e.split(", ")[t]),tc=(e,t)=>(s,{transform:i})=>{if("none"===i||!i)return 0;let a=i.match(/^matrix3d\((.+)\)$/u);if(a)return to(a[1],t);{let t=i.match(/^matrix\((.+)\)$/u);return t?to(t[1],e):0}},td=new Set(["x","y","z"]),th=W.filter(e=>!td.has(e)),tu={width:({x:e},{paddingLeft:t="0",paddingRight:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),height:({y:e},{paddingTop:t="0",paddingBottom:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:tc(4,13),y:tc(5,14)};tu.translateX=tu.x,tu.translateY=tu.y;let tx=new Set,tm=!1,tp=!1;function tg(){if(tp){let e=Array.from(tx).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),s=new Map;t.forEach(e=>{let t=function(e){let t=[];return th.forEach(s=>{let i=e.getValue(s);void 0!==i&&(t.push([s,i.get()]),i.set(s.startsWith("scale")?1:0))}),t}(e);t.length&&(s.set(e,t),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();let t=s.get(e);t&&t.forEach(([t,s])=>{var i;null===(i=e.getValue(t))||void 0===i||i.set(s)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}tp=!1,tm=!1,tx.forEach(e=>e.complete()),tx.clear()}function tf(){tx.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(tp=!0)})}class ty{constructor(e,t,s,i,a,n=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=s,this.motionValue=i,this.element=a,this.isAsync=n}scheduleResolve(){this.isScheduled=!0,this.isAsync?(tx.add(this),tm||(tm=!0,ee.read(tf),ee.resolveKeyframes(tg))):(this.readKeyframes(),this.complete())}readKeyframes(){let{unresolvedKeyframes:e,name:t,element:s,motionValue:i}=this;for(let a=0;a<e.length;a++)if(null===e[a]){if(0===a){let a=null==i?void 0:i.get(),n=e[e.length-1];if(void 0!==a)e[0]=a;else if(s&&t){let i=s.readValue(t,n);null!=i&&(e[0]=i)}void 0===e[0]&&(e[0]=n),i&&void 0===a&&i.set(e[0])}else e[a]=e[a-1]}}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),tx.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,tx.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}let tv=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),tb=e=>t=>"string"==typeof t&&t.startsWith(e),tj=tb("--"),tw=tb("var(--"),tN=e=>!!tw(e)&&tk.test(e.split("/*")[0].trim()),tk=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,tS=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u,tC=e=>t=>t.test(e),tR=[eD,eW,eH,eZ,eG,eq,{test:e=>"auto"===e,parse:e=>e}],tT=e=>tR.find(tC(e));class tP extends ty{constructor(e,t,s,i,a){super(e,t,s,i,a,!0)}readKeyframes(){let{unresolvedKeyframes:e,element:t,name:s}=this;if(!t||!t.current)return;super.readKeyframes();for(let s=0;s<e.length;s++){let i=e[s];if("string"==typeof i&&tN(i=i.trim())){let a=function e(t,s,i=1){H(i<=4,`Max CSS variable fallback depth detected in property "${t}". This may indicate a circular fallback dependency.`);let[a,n]=function(e){let t=tS.exec(e);if(!t)return[,];let[,s,i,a]=t;return[`--${null!=s?s:i}`,a]}(t);if(!a)return;let r=window.getComputedStyle(s).getPropertyValue(a);if(r){let e=r.trim();return tv(e)?parseFloat(e):e}return tN(n)?e(n,s,i+1):n}(i,t.current);void 0!==a&&(e[s]=a),s===e.length-1&&(this.finalKeyframe=i)}}if(this.resolveNoneKeyframes(),!G.has(s)||2!==e.length)return;let[i,a]=e,n=tT(i),r=tT(a);if(n!==r){if(tl(n)&&tl(r))for(let t=0;t<e.length;t++){let s=e[t];"string"==typeof s&&(e[t]=parseFloat(s))}else this.needsMeasurement=!0}}resolveNoneKeyframes(){let{unresolvedKeyframes:e,name:t}=this,s=[];for(let t=0;t<e.length;t++){var i;("number"==typeof(i=e[t])?0===i:null===i||"none"===i||"0"===i||eP(i))&&s.push(t)}s.length&&function(e,t,s){let i,a=0;for(;a<e.length&&!i;){let t=e[a];"string"==typeof t&&!tr.has(t)&&e2(t).values.length&&(i=e[a]),a++}if(i&&s)for(let a of t)e[a]=tn(s,i)}(e,s,t)}measureInitialState(){let{element:e,unresolvedKeyframes:t,name:s}=this;if(!e||!e.current)return;"height"===s&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=tu[s](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;let i=t[t.length-1];void 0!==i&&e.getValue(s,i).jump(i,!1)}measureEndState(){var e;let{element:t,name:s,unresolvedKeyframes:i}=this;if(!t||!t.current)return;let a=t.getValue(s);a&&a.jump(this.measuredOrigin,!1);let n=i.length-1,r=i[n];i[n]=tu[s](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==r&&void 0===this.finalKeyframe&&(this.finalKeyframe=r),(null===(e=this.removedTransforms)||void 0===e?void 0:e.length)&&this.removedTransforms.forEach(([e,s])=>{t.getValue(e).set(s)}),this.resolveNoneKeyframes()}}let tM=(e,t)=>"zIndex"!==t&&!!("number"==typeof e||Array.isArray(e)||"string"==typeof e&&(e8.test(e)||"0"===e)&&!e.startsWith("url(")),tD=e=>null!==e;function tA(e,{repeat:t,repeatType:s="loop"},i){let a=e.filter(tD),n=t&&"loop"!==s&&t%2==1?0:a.length-1;return n&&void 0!==i?i:a[n]}class tE{constructor({autoplay:e=!0,delay:t=0,type:s="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:n="loop",...r}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=en.now(),this.options={autoplay:e,delay:t,type:s,repeat:i,repeatDelay:a,repeatType:n,...r},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt}get resolved(){return this._resolved||this.hasAttemptedResolve||(tf(),tg()),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=en.now(),this.hasAttemptedResolve=!0;let{name:s,type:i,velocity:a,delay:n,onComplete:r,onUpdate:l,isGenerator:o}=this.options;if(!o&&!function(e,t,s,i){let a=e[0];if(null===a)return!1;if("display"===t||"visibility"===t)return!0;let n=e[e.length-1],r=tM(a,t),l=tM(n,t);return H(r===l,`You are trying to animate ${t} from "${a}" to "${n}". ${a} is not an animatable value - to enable this animation set ${a} to a value animatable to ${n} via the \`style\` property.`),!!r&&!!l&&(function(e){let t=e[0];if(1===e.length)return!0;for(let s=0;s<e.length;s++)if(e[s]!==t)return!0}(e)||("spring"===s||N(s))&&i)}(e,s,i,a)){if(ef.current||!n){l&&l(tA(e,this.options,t)),r&&r(),this.resolveFinishedPromise();return}this.options.duration=0}let c=this.initPlayback(e,t);!1!==c&&(this._resolved={keyframes:e,finalKeyframe:t,...c},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}let tF=(e,t,s)=>e+(t-e)*s;function t$(e,t,s){return(s<0&&(s+=1),s>1&&(s-=1),s<1/6)?e+(t-e)*6*s:s<.5?t:s<2/3?e+(t-e)*(2/3-s)*6:e}function tI(e,t){return s=>s>0?t:e}let tL=(e,t,s)=>{let i=e*e,a=s*(t*t-i)+i;return a<0?0:Math.sqrt(a)},tO=[eU,ez,eK],tV=e=>tO.find(t=>t.test(e));function tB(e){let t=tV(e);if(H(!!t,`'${e}' is not an animatable color. Use the equivalent color code instead.`),!t)return!1;let s=t.parse(e);return t===eK&&(s=function({hue:e,saturation:t,lightness:s,alpha:i}){e/=360,s/=100;let a=0,n=0,r=0;if(t/=100){let i=s<.5?s*(1+t):s+t-s*t,l=2*s-i;a=t$(l,i,e+1/3),n=t$(l,i,e),r=t$(l,i,e-1/3)}else a=n=r=s;return{red:Math.round(255*a),green:Math.round(255*n),blue:Math.round(255*r),alpha:i}}(s)),s}let tz=(e,t)=>{let s=tB(e),i=tB(t);if(!s||!i)return tI(e,t);let a={...s};return e=>(a.red=tL(s.red,i.red,e),a.green=tL(s.green,i.green,e),a.blue=tL(s.blue,i.blue,e),a.alpha=tF(s.alpha,i.alpha,e),ez.transform(a))},tU=(e,t)=>s=>t(e(s)),t_=(...e)=>e.reduce(tU),tZ=new Set(["none","hidden"]);function tH(e,t){return s=>tF(e,t,s)}function tW(e){return"number"==typeof e?tH:"string"==typeof e?tN(e)?tI:eY.test(e)?tz:tX:Array.isArray(e)?tq:"object"==typeof e?eY.test(e)?tz:tG:tI}function tq(e,t){let s=[...e],i=s.length,a=e.map((e,s)=>tW(e)(e,t[s]));return e=>{for(let t=0;t<i;t++)s[t]=a[t](e);return s}}function tG(e,t){let s={...e,...t},i={};for(let a in s)void 0!==e[a]&&void 0!==t[a]&&(i[a]=tW(e[a])(e[a],t[a]));return e=>{for(let t in i)s[t]=i[t](e);return s}}let tX=(e,t)=>{let s=e8.createTransformer(t),i=e2(e),a=e2(t);return i.indexes.var.length===a.indexes.var.length&&i.indexes.color.length===a.indexes.color.length&&i.indexes.number.length>=a.indexes.number.length?tZ.has(e)&&!a.values.length||tZ.has(t)&&!i.values.length?function(e,t){return tZ.has(e)?s=>s<=0?e:t:s=>s>=1?t:e}(e,t):t_(tq(function(e,t){var s;let i=[],a={color:0,var:0,number:0};for(let n=0;n<t.values.length;n++){let r=t.types[n],l=e.indexes[r][a[r]],o=null!==(s=e.values[l])&&void 0!==s?s:0;i[n]=o,a[r]++}return i}(i,a),a.values),s):(H(!0,`Complex values '${e}' and '${t}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`),tI(e,t))};function tK(e,t,s){return"number"==typeof e&&"number"==typeof t&&"number"==typeof s?tF(e,t,s):tW(e)(e,t)}function tY(e,t,s){var i,a;let n=Math.max(t-5,0);return i=s-e(n),(a=t-n)?1e3/a*i:0}let tJ={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1};function tQ(e,t){return e*Math.sqrt(1-t*t)}let t0=["duration","bounce"],t1=["stiffness","damping","mass"];function t2(e,t){return t.some(t=>void 0!==e[t])}function t5(e=tJ.visualDuration,t=tJ.bounce){let s;let i="object"!=typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e,{restSpeed:a,restDelta:n}=i,r=i.keyframes[0],l=i.keyframes[i.keyframes.length-1],o={done:!1,value:r},{stiffness:c,damping:d,mass:h,duration:u,velocity:x,isResolvedFromDuration:m}=function(e){let t={velocity:tJ.velocity,stiffness:tJ.stiffness,damping:tJ.damping,mass:tJ.mass,isResolvedFromDuration:!1,...e};if(!t2(e,t1)&&t2(e,t0)){if(e.visualDuration){let s=2*Math.PI/(1.2*e.visualDuration),i=s*s,a=2*eM(.05,1,1-(e.bounce||0))*Math.sqrt(i);t={...t,mass:tJ.mass,stiffness:i,damping:a}}else{let s=function({duration:e=tJ.duration,bounce:t=tJ.bounce,velocity:s=tJ.velocity,mass:i=tJ.mass}){let a,n;H(e<=_(tJ.maxDuration),"Spring duration must be 10 seconds or less");let r=1-t;r=eM(tJ.minDamping,tJ.maxDamping,r),e=eM(tJ.minDuration,tJ.maxDuration,Z(e)),r<1?(a=t=>{let i=t*r,a=i*e;return .001-(i-s)/tQ(t,r)*Math.exp(-a)},n=t=>{let i=t*r*e,n=Math.pow(r,2)*Math.pow(t,2)*e,l=tQ(Math.pow(t,2),r);return(i*s+s-n)*Math.exp(-i)*(-a(t)+.001>0?-1:1)/l}):(a=t=>-.001+Math.exp(-t*e)*((t-s)*e+1),n=t=>e*e*(s-t)*Math.exp(-t*e));let l=function(e,t,s){let i=s;for(let s=1;s<12;s++)i-=e(i)/t(i);return i}(a,n,5/e);if(e=_(e),isNaN(l))return{stiffness:tJ.stiffness,damping:tJ.damping,duration:e};{let t=Math.pow(l,2)*i;return{stiffness:t,damping:2*r*Math.sqrt(i*t),duration:e}}}(e);(t={...t,...s,mass:tJ.mass}).isResolvedFromDuration=!0}}return t}({...i,velocity:-Z(i.velocity||0)}),p=x||0,g=d/(2*Math.sqrt(c*h)),f=l-r,y=Z(Math.sqrt(c/h)),v=5>Math.abs(f);if(a||(a=v?tJ.restSpeed.granular:tJ.restSpeed.default),n||(n=v?tJ.restDelta.granular:tJ.restDelta.default),g<1){let e=tQ(y,g);s=t=>l-Math.exp(-g*y*t)*((p+g*y*f)/e*Math.sin(e*t)+f*Math.cos(e*t))}else if(1===g)s=e=>l-Math.exp(-y*e)*(f+(p+y*f)*e);else{let e=y*Math.sqrt(g*g-1);s=t=>{let s=Math.exp(-g*y*t),i=Math.min(e*t,300);return l-s*((p+g*y*f)*Math.sinh(i)+e*f*Math.cosh(i))/e}}let b={calculatedDuration:m&&u||null,next:e=>{let t=s(e);if(m)o.done=e>=u;else{let i=0;g<1&&(i=0===e?_(p):tY(s,e,t));let r=Math.abs(i)<=a,c=Math.abs(l-t)<=n;o.done=r&&c}return o.value=o.done?l:t,o},toString:()=>{let e=Math.min(w(b),2e4),t=P(t=>b.next(e*t).value,e,30);return e+"ms "+t}};return b}function t3({keyframes:e,velocity:t=0,power:s=.8,timeConstant:i=325,bounceDamping:a=10,bounceStiffness:n=500,modifyTarget:r,min:l,max:o,restDelta:c=.5,restSpeed:d}){let h,u;let x=e[0],m={done:!1,value:x},p=e=>void 0!==l&&e<l||void 0!==o&&e>o,g=e=>void 0===l?o:void 0===o?l:Math.abs(l-e)<Math.abs(o-e)?l:o,f=s*t,y=x+f,v=void 0===r?y:r(y);v!==y&&(f=v-x);let b=e=>-f*Math.exp(-e/i),j=e=>v+b(e),w=e=>{let t=b(e),s=j(e);m.done=Math.abs(t)<=c,m.value=m.done?v:s},N=e=>{p(m.value)&&(h=e,u=t5({keyframes:[m.value,g(m.value)],velocity:tY(j,e,m.value),damping:a,stiffness:n,restDelta:c,restSpeed:d}))};return N(0),{calculatedDuration:null,next:e=>{let t=!1;return(u||void 0!==h||(t=!0,w(e),N(e)),void 0!==h&&e>=h)?u.next(e-h):(t||w(e),m)}}}let t4=ev(.42,0,1,1),t8=ev(0,0,.58,1),t6=ev(.42,0,.58,1),t9=e=>Array.isArray(e)&&"number"!=typeof e[0],t7={linear:H,easeIn:t4,easeInOut:t6,easeOut:t8,circIn:eC,circInOut:eT,circOut:eR,backIn:eN,backInOut:ek,backOut:ew,anticipate:eS},se=e=>{if(S(e)){H(4===e.length,"Cubic bezier arrays must contain four numerical values.");let[t,s,i,a]=e;return ev(t,s,i,a)}return"string"==typeof e?(H(void 0!==t7[e],`Invalid easing type '${e}'`),t7[e]):e};function st({duration:e=300,keyframes:t,times:s,ease:i="easeInOut"}){let a=t9(i)?i.map(se):se(i),n={done:!1,value:t[0]},r=function(e,t,{clamp:s=!0,ease:i,mixer:a}={}){let n=e.length;if(H(n===t.length,"Both input and output ranges must be the same length"),1===n)return()=>t[0];if(2===n&&t[0]===t[1])return()=>t[1];let r=e[0]===e[1];e[0]>e[n-1]&&(e=[...e].reverse(),t=[...t].reverse());let l=function(e,t,s){let i=[],a=s||tK,n=e.length-1;for(let s=0;s<n;s++){let n=a(e[s],e[s+1]);t&&(n=t_(Array.isArray(t)?t[s]||H:t,n)),i.push(n)}return i}(t,i,a),o=l.length,c=s=>{if(r&&s<e[0])return t[0];let i=0;if(o>1)for(;i<e.length-2&&!(s<e[i+1]);i++);let a=T(e[i],e[i+1],s);return l[i](a)};return s?t=>c(eM(e[0],e[n-1],t)):c}((s&&s.length===t.length?s:function(e){let t=[0];return function(e,t){let s=e[e.length-1];for(let i=1;i<=t;i++){let a=T(0,t,i);e.push(tF(s,1,a))}}(t,e.length-1),t}(t)).map(t=>t*e),t,{ease:Array.isArray(a)?a:t.map(()=>a||t6).splice(0,t.length-1)});return{calculatedDuration:e,next:t=>(n.value=r(t),n.done=t>=e,n)}}let ss=e=>{let t=({timestamp:t})=>e(t);return{start:()=>ee.update(t,!0),stop:()=>et(t),now:()=>es.isProcessing?es.timestamp:en.now()}},si={decay:t3,inertia:t3,tween:st,keyframes:st,spring:t5},sa=e=>e/100;class sn extends tE{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.teardown();let{onStop:e}=this.options;e&&e()};let{name:t,motionValue:s,element:i,keyframes:a}=this.options,n=(null==i?void 0:i.KeyframeResolver)||ty;this.resolver=new n(a,(e,t)=>this.onKeyframesResolved(e,t),t,s,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){let t,s;let{type:i="keyframes",repeat:a=0,repeatDelay:n=0,repeatType:r,velocity:l=0}=this.options,o=N(i)?i:si[i]||st;o!==st&&"number"!=typeof e[0]&&(t=t_(sa,tK(e[0],e[1])),e=[0,100]);let c=o({...this.options,keyframes:e});"mirror"===r&&(s=o({...this.options,keyframes:[...e].reverse(),velocity:-l})),null===c.calculatedDuration&&(c.calculatedDuration=w(c));let{calculatedDuration:d}=c,h=d+n;return{generator:c,mirroredGenerator:s,mapPercentToKeyframes:t,calculatedDuration:d,resolvedDuration:h,totalDuration:h*(a+1)-n}}onPostResolved(){let{autoplay:e=!0}=this.options;this.play(),"paused"!==this.pendingPlayState&&e?this.state=this.pendingPlayState:this.pause()}tick(e,t=!1){let{resolved:s}=this;if(!s){let{keyframes:e}=this.options;return{done:!0,value:e[e.length-1]}}let{finalKeyframe:i,generator:a,mirroredGenerator:n,mapPercentToKeyframes:r,keyframes:l,calculatedDuration:o,totalDuration:c,resolvedDuration:d}=s;if(null===this.startTime)return a.next(0);let{delay:h,repeat:u,repeatType:x,repeatDelay:m,onUpdate:p}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-c/this.speed,this.startTime)),t?this.currentTime=e:null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;let g=this.currentTime-h*(this.speed>=0?1:-1),f=this.speed>=0?g<0:g>c;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=c);let y=this.currentTime,v=a;if(u){let e=Math.min(this.currentTime,c)/d,t=Math.floor(e),s=e%1;!s&&e>=1&&(s=1),1===s&&t--,(t=Math.min(t,u+1))%2&&("reverse"===x?(s=1-s,m&&(s-=m/d)):"mirror"===x&&(v=n)),y=eM(0,1,s)*d}let b=f?{done:!1,value:l[0]}:v.next(y);r&&(b.value=r(b.value));let{done:j}=b;f||null===o||(j=this.speed>=0?this.currentTime>=c:this.currentTime<=0);let w=null===this.holdTime&&("finished"===this.state||"running"===this.state&&j);return w&&void 0!==i&&(b.value=tA(l,this.options,i)),p&&p(b.value),w&&this.finish(),b}get duration(){let{resolved:e}=this;return e?Z(e.calculatedDuration):0}get time(){return Z(this.currentTime)}set time(e){e=_(e),this.currentTime=e,null!==this.holdTime||0===this.speed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){let t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Z(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;let{driver:e=ss,onPlay:t,startTime:s}=this.options;this.driver||(this.driver=e(e=>this.tick(e))),t&&t();let i=this.driver.now();null!==this.holdTime?this.startTime=i-this.holdTime:this.startTime?"finished"===this.state&&(this.startTime=i):this.startTime=null!=s?s:this.calcStartTime(),"finished"===this.state&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=null!==(e=this.currentTime)&&void 0!==e?e:0}complete(){"running"!==this.state&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";let{onComplete:e}=this.options;e&&e()}cancel(){null!==this.cancelTime&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}let sr=new Set(["opacity","clipPath","filter","transform"]),sl=f(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),so={anticipate:eS,backInOut:ek,circInOut:eT};class sc extends tE{constructor(e){super(e);let{name:t,motionValue:s,element:i,keyframes:a}=this.options;this.resolver=new tP(a,(e,t)=>this.onKeyframesResolved(e,t),t,s,i),this.resolver.scheduleResolve()}initPlayback(e,t){var s;let{duration:i=300,times:a,ease:n,type:r,motionValue:l,name:o,startTime:c}=this.options;if(!l.owner||!l.owner.current)return!1;if("string"==typeof n&&R()&&n in so&&(n=so[n]),N((s=this.options).type)||"spring"===s.type||!function e(t){return!!("function"==typeof t&&R()||!t||"string"==typeof t&&(t in D||R())||S(t)||Array.isArray(t)&&t.every(e))}(s.ease)){let{onComplete:t,onUpdate:s,motionValue:l,element:o,...c}=this.options,d=function(e,t){let s=new sn({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0}),i={done:!1,value:e[0]},a=[],n=0;for(;!i.done&&n<2e4;)a.push((i=s.sample(n)).value),n+=10;return{times:void 0,keyframes:a,duration:n-10,ease:"linear"}}(e,c);1===(e=d.keyframes).length&&(e[1]=e[0]),i=d.duration,a=d.times,n=d.ease,r="keyframes"}let d=function(e,t,s,{delay:i=0,duration:a=300,repeat:n=0,repeatType:r="loop",ease:l="easeInOut",times:o}={}){let c={[t]:s};o&&(c.offset=o);let d=function e(t,s){if(t)return"function"==typeof t&&R()?P(t,s):S(t)?M(t):Array.isArray(t)?t.map(t=>e(t,s)||D.easeOut):D[t]}(l,a);return Array.isArray(d)&&(c.easing=d),e.animate(c,{delay:i,duration:a,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:n+1,direction:"reverse"===r?"alternate":"normal"})}(l.owner.current,o,e,{...this.options,duration:i,times:a,ease:n});return d.startTime=null!=c?c:this.calcStartTime(),this.pendingTimeline?(k(d,this.pendingTimeline),this.pendingTimeline=void 0):d.onfinish=()=>{let{onComplete:s}=this.options;l.set(tA(e,this.options,t)),s&&s(),this.cancel(),this.resolveFinishedPromise()},{animation:d,duration:i,times:a,type:r,ease:n,keyframes:e}}get duration(){let{resolved:e}=this;if(!e)return 0;let{duration:t}=e;return Z(t)}get time(){let{resolved:e}=this;if(!e)return 0;let{animation:t}=e;return Z(t.currentTime||0)}set time(e){let{resolved:t}=this;if(!t)return;let{animation:s}=t;s.currentTime=_(e)}get speed(){let{resolved:e}=this;if(!e)return 1;let{animation:t}=e;return t.playbackRate}set speed(e){let{resolved:t}=this;if(!t)return;let{animation:s}=t;s.playbackRate=e}get state(){let{resolved:e}=this;if(!e)return"idle";let{animation:t}=e;return t.playState}get startTime(){let{resolved:e}=this;if(!e)return null;let{animation:t}=e;return t.startTime}attachTimeline(e){if(this._resolved){let{resolved:t}=this;if(!t)return H;let{animation:s}=t;k(s,e)}else this.pendingTimeline=e;return H}play(){if(this.isStopped)return;let{resolved:e}=this;if(!e)return;let{animation:t}=e;"finished"===t.playState&&this.updateFinishedPromise(),t.play()}pause(){let{resolved:e}=this;if(!e)return;let{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.resolveFinishedPromise(),this.updateFinishedPromise();let{resolved:e}=this;if(!e)return;let{animation:t,keyframes:s,duration:i,type:a,ease:n,times:r}=e;if("idle"===t.playState||"finished"===t.playState)return;if(this.time){let{motionValue:e,onUpdate:t,onComplete:l,element:o,...c}=this.options,d=new sn({...c,keyframes:s,duration:i,type:a,ease:n,times:r,isGenerator:!0}),h=_(this.time);e.setWithVelocity(d.sample(h-10).value,d.sample(h).value,10)}let{onStop:l}=this.options;l&&l(),this.cancel()}complete(){let{resolved:e}=this;e&&e.animation.finish()}cancel(){let{resolved:e}=this;e&&e.animation.cancel()}static supports(e){let{motionValue:t,name:s,repeatDelay:i,repeatType:a,damping:n,type:r}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;let{onUpdate:l,transformTemplate:o}=t.owner.getProps();return sl()&&s&&sr.has(s)&&!l&&!o&&!i&&"mirror"!==a&&0!==n&&"inertia"!==r}}let sd={type:"spring",stiffness:500,damping:25,restSpeed:10},sh=e=>({type:"spring",stiffness:550,damping:0===e?2*Math.sqrt(550):30,restSpeed:10}),su={type:"keyframes",duration:.8},sx={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},sm=(e,{keyframes:t})=>t.length>2?su:q.has(e)?e.startsWith("scale")?sh(t[1]):sd:sx,sp=(e,t,s,i={},a,n)=>r=>{let l=j(i,e)||{},o=l.delay||i.delay||0,{elapsed:c=0}=i;c-=_(o);let d={keyframes:Array.isArray(s)?s:[null,s],ease:"easeOut",velocity:t.getVelocity(),...l,delay:-c,onUpdate:e=>{t.set(e),l.onUpdate&&l.onUpdate(e)},onComplete:()=>{r(),l.onComplete&&l.onComplete()},name:e,motionValue:t,element:n?void 0:a};!function({when:e,delay:t,delayChildren:s,staggerChildren:i,staggerDirection:a,repeat:n,repeatType:r,repeatDelay:l,from:o,elapsed:c,...d}){return!!Object.keys(d).length}(l)&&(d={...d,...sm(e,d)}),d.duration&&(d.duration=_(d.duration)),d.repeatDelay&&(d.repeatDelay=_(d.repeatDelay)),void 0!==d.from&&(d.keyframes[0]=d.from);let h=!1;if(!1!==d.type&&(0!==d.duration||d.repeatDelay)||(d.duration=0,0!==d.delay||(h=!0)),(ef.current||Y.skipAnimations)&&(h=!0,d.duration=0,d.delay=0),h&&!n&&void 0!==t.get()){let e=tA(d.keyframes,l);if(void 0!==e)return ee.update(()=>{d.onUpdate(e),d.onComplete()}),new b([])}return!n&&sc.supports(d)?new sc(d):new sn(d)};function sg(e,t,{delay:s=0,transitionOverride:i,type:a}={}){var n;let{transition:r=e.getDefaultTransition(),transitionEnd:l,...o}=t;i&&(r=i);let c=[],d=a&&e.animationState&&e.animationState.getState()[a];for(let t in o){let i=e.getValue(t,null!==(n=e.latestValues[t])&&void 0!==n?n:null),a=o[t];if(void 0===a||d&&function({protectedKeys:e,needsAnimating:t},s){let i=e.hasOwnProperty(s)&&!0!==t[s];return t[s]=!1,i}(d,t))continue;let l={delay:s,...j(r||{},t)},h=!1;if(window.MotionHandoffAnimation){let s=e.props[eg];if(s){let e=window.MotionHandoffAnimation(s,t,ee);null!==e&&(l.startTime=e,h=!0)}}em(e,t),i.start(sp(t,i,a,e.shouldReduceMotion&&G.has(t)?{type:!1}:l,e,h));let u=i.animation;u&&c.push(u)}return l&&Promise.all(c).then(()=>{ee.update(()=>{l&&function(e,t){let{transitionEnd:s={},transition:i={},...a}=m(e,t)||{};for(let t in a={...a,...s}){let s=K(a[t]);e.hasValue(t)?e.getValue(t).set(s):e.addValue(t,eu(s))}}(e,l)})}),c}function sf(e,t,s={}){var i;let a=m(e,t,"exit"===s.type?null===(i=e.presenceContext)||void 0===i?void 0:i.custom:void 0),{transition:n=e.getDefaultTransition()||{}}=a||{};s.transitionOverride&&(n=s.transitionOverride);let r=a?()=>Promise.all(sg(e,a,s)):()=>Promise.resolve(),l=e.variantChildren&&e.variantChildren.size?(i=0)=>{let{delayChildren:a=0,staggerChildren:r,staggerDirection:l}=n;return function(e,t,s=0,i=0,a=1,n){let r=[],l=(e.variantChildren.size-1)*i,o=1===a?(e=0)=>e*i:(e=0)=>l-e*i;return Array.from(e.variantChildren).sort(sy).forEach((e,i)=>{e.notify("AnimationStart",t),r.push(sf(e,t,{...n,delay:s+o(i)}).then(()=>e.notify("AnimationComplete",t)))}),Promise.all(r)}(e,t,a+i,r,l,s)}:()=>Promise.resolve(),{when:o}=n;if(!o)return Promise.all([r(),l(s.delay)]);{let[e,t]="beforeChildren"===o?[r,l]:[l,r];return e().then(()=>t())}}function sy(e,t){return e.sortNodePosition(t)}let sv=g.length,sb=[...p].reverse(),sj=p.length;function sw(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function sN(){return{animate:sw(!0),whileInView:sw(),whileHover:sw(),whileTap:sw(),whileDrag:sw(),whileFocus:sw(),exit:sw()}}class sk{constructor(e){this.isMounted=!1,this.node=e}update(){}}class sS extends sk{constructor(e){super(e),e.animationState||(e.animationState=function(e){let t=t=>Promise.all(t.map(({animation:t,options:s})=>(function(e,t,s={}){let i;if(e.notify("AnimationStart",t),Array.isArray(t))i=Promise.all(t.map(t=>sf(e,t,s)));else if("string"==typeof t)i=sf(e,t,s);else{let a="function"==typeof t?m(e,t,s.custom):t;i=Promise.all(sg(e,a,s))}return i.then(()=>{e.notify("AnimationComplete",t)})})(e,t,s))),s=sN(),i=!0,a=t=>(s,i)=>{var a;let n=m(e,i,"exit"===t?null===(a=e.presenceContext)||void 0===a?void 0:a.custom:void 0);if(n){let{transition:e,transitionEnd:t,...i}=n;s={...s,...i,...t}}return s};function n(n){let{props:r}=e,l=function e(t){if(!t)return;if(!t.isControllingVariants){let s=t.parent&&e(t.parent)||{};return void 0!==t.props.initial&&(s.initial=t.props.initial),s}let s={};for(let e=0;e<sv;e++){let i=g[e],a=t.props[i];(h(a)||!1===a)&&(s[i]=a)}return s}(e.parent)||{},u=[],x=new Set,m={},p=1/0;for(let t=0;t<sj;t++){var f;let g=sb[t],y=s[g],v=void 0!==r[g]?r[g]:l[g],b=h(v),j=g===n?y.isActive:null;!1===j&&(p=t);let w=v===l[g]&&v!==r[g]&&b;if(w&&i&&e.manuallyAnimateOnMount&&(w=!1),y.protectedKeys={...m},!y.isActive&&null===j||!v&&!y.prevProp||o(v)||"boolean"==typeof v)continue;let N=(f=y.prevProp,"string"==typeof v?v!==f:!!Array.isArray(v)&&!d(v,f)),k=N||g===n&&y.isActive&&!w&&b||t>p&&b,S=!1,C=Array.isArray(v)?v:[v],R=C.reduce(a(g),{});!1===j&&(R={});let{prevResolvedValues:T={}}=y,P={...T,...R},M=t=>{k=!0,x.has(t)&&(S=!0,x.delete(t)),y.needsAnimating[t]=!0;let s=e.getValue(t);s&&(s.liveStyle=!1)};for(let e in P){let t=R[e],s=T[e];if(!m.hasOwnProperty(e))(c(t)&&c(s)?d(t,s):t===s)?void 0!==t&&x.has(e)?M(e):y.protectedKeys[e]=!0:null!=t?M(e):x.add(e)}y.prevProp=v,y.prevResolvedValues=R,y.isActive&&(m={...m,...R}),i&&e.blockInitialAnimation&&(k=!1);let D=!(w&&N)||S;k&&D&&u.push(...C.map(e=>({animation:e,options:{type:g}})))}if(x.size){let t={};x.forEach(s=>{let i=e.getBaseTarget(s),a=e.getValue(s);a&&(a.liveStyle=!0),t[s]=null!=i?i:null}),u.push({animation:t})}let y=!!u.length;return i&&(!1===r.initial||r.initial===r.animate)&&!e.manuallyAnimateOnMount&&(y=!1),i=!1,y?t(u):Promise.resolve()}return{animateChanges:n,setActive:function(t,i){var a;if(s[t].isActive===i)return Promise.resolve();null===(a=e.variantChildren)||void 0===a||a.forEach(e=>{var s;return null===(s=e.animationState)||void 0===s?void 0:s.setActive(t,i)}),s[t].isActive=i;let r=n(t);for(let e in s)s[e].protectedKeys={};return r},setAnimateFunction:function(s){t=s(e)},getState:()=>s,reset:()=>{s=sN(),i=!0}}}(e))}updateAnimationControlsSubscription(){let{animate:e}=this.node.getProps();o(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),null===(e=this.unmountControls)||void 0===e||e.call(this)}}let sC=0;class sR extends sk{constructor(){super(...arguments),this.id=sC++}update(){if(!this.node.presenceContext)return;let{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;let i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){let{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}function sT(e,t,s,i={passive:!0}){return e.addEventListener(t,s,i),()=>e.removeEventListener(t,s)}function sP(e){return{point:{x:e.pageX,y:e.pageY}}}let sM=e=>t=>I(t)&&e(t,sP(t));function sD(e,t,s,i){return sT(e,t,sM(s),i)}let sA=(e,t)=>Math.abs(e-t);class sE{constructor(e,t,{transformPagePoint:s,contextWindow:i,dragSnapToOrigin:a=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let e=sI(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,s=function(e,t){return Math.sqrt(sA(e.x,t.x)**2+sA(e.y,t.y)**2)}(e.offset,{x:0,y:0})>=3;if(!t&&!s)return;let{point:i}=e,{timestamp:a}=es;this.history.push({...i,timestamp:a});let{onStart:n,onMove:r}=this.handlers;t||(n&&n(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),r&&r(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=sF(t,this.transformPagePoint),ee.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();let{onEnd:s,onSessionEnd:i,resumeAnimation:a}=this.handlers;if(this.dragSnapToOrigin&&a&&a(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let n=sI("pointercancel"===e.type?this.lastMoveEventInfo:sF(t,this.transformPagePoint),this.history);this.startEvent&&s&&s(e,n),i&&i(e,n)},!I(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=s,this.contextWindow=i||window;let n=sF(sP(e),this.transformPagePoint),{point:r}=n,{timestamp:l}=es;this.history=[{...r,timestamp:l}];let{onSessionStart:o}=t;o&&o(e,sI(n,this.history)),this.removeListeners=t_(sD(this.contextWindow,"pointermove",this.handlePointerMove),sD(this.contextWindow,"pointerup",this.handlePointerUp),sD(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),et(this.updatePoint)}}function sF(e,t){return t?{point:t(e.point)}:e}function s$(e,t){return{x:e.x-t.x,y:e.y-t.y}}function sI({point:e},t){return{point:e,delta:s$(e,sL(t)),offset:s$(e,t[0]),velocity:function(e,t){if(e.length<2)return{x:0,y:0};let s=e.length-1,i=null,a=sL(e);for(;s>=0&&(i=e[s],!(a.timestamp-i.timestamp>_(.1)));)s--;if(!i)return{x:0,y:0};let n=Z(a.timestamp-i.timestamp);if(0===n)return{x:0,y:0};let r={x:(a.x-i.x)/n,y:(a.y-i.y)/n};return r.x===1/0&&(r.x=0),r.y===1/0&&(r.y=0),r}(t,0)}}function sL(e){return e[e.length-1]}function sO(e){return e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function sV(e){return e.max-e.min}function sB(e,t,s,i=.5){e.origin=i,e.originPoint=tF(t.min,t.max,e.origin),e.scale=sV(s)/sV(t),e.translate=tF(s.min,s.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function sz(e,t,s,i){sB(e.x,t.x,s.x,i?i.originX:void 0),sB(e.y,t.y,s.y,i?i.originY:void 0)}function sU(e,t,s){e.min=s.min+t.min,e.max=e.min+sV(t)}function s_(e,t,s){e.min=t.min-s.min,e.max=e.min+sV(t)}function sZ(e,t,s){s_(e.x,t.x,s.x),s_(e.y,t.y,s.y)}function sH(e,t,s){return{min:void 0!==t?e.min+t:void 0,max:void 0!==s?e.max+s-(e.max-e.min):void 0}}function sW(e,t){let s=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&([s,i]=[i,s]),{min:s,max:i}}function sq(e,t,s){return{min:sG(e,t),max:sG(e,s)}}function sG(e,t){return"number"==typeof e?e:e[t]||0}let sX=()=>({translate:0,scale:1,origin:0,originPoint:0}),sK=()=>({x:sX(),y:sX()}),sY=()=>({min:0,max:0}),sJ=()=>({x:sY(),y:sY()});function sQ(e){return[e("x"),e("y")]}function s0({top:e,left:t,right:s,bottom:i}){return{x:{min:t,max:s},y:{min:e,max:i}}}function s1(e){return void 0===e||1===e}function s2({scale:e,scaleX:t,scaleY:s}){return!s1(e)||!s1(t)||!s1(s)}function s5(e){return s2(e)||s3(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function s3(e){var t,s;return(t=e.x)&&"0%"!==t||(s=e.y)&&"0%"!==s}function s4(e,t,s,i,a){return void 0!==a&&(e=i+a*(e-i)),i+s*(e-i)+t}function s8(e,t=0,s=1,i,a){e.min=s4(e.min,t,s,i,a),e.max=s4(e.max,t,s,i,a)}function s6(e,{x:t,y:s}){s8(e.x,t.translate,t.scale,t.originPoint),s8(e.y,s.translate,s.scale,s.originPoint)}function s9(e,t){e.min=e.min+t,e.max=e.max+t}function s7(e,t,s,i,a=.5){let n=tF(e.min,e.max,a);s8(e,t,s,n,i)}function ie(e,t){s7(e.x,t.x,t.scaleX,t.scale,t.originX),s7(e.y,t.y,t.scaleY,t.scale,t.originY)}function it(e,t){return s0(function(e,t){if(!t)return e;let s=t({x:e.left,y:e.top}),i=t({x:e.right,y:e.bottom});return{top:s.y,left:s.x,bottom:i.y,right:i.x}}(e.getBoundingClientRect(),t))}let is=({current:e})=>e?e.ownerDocument.defaultView:null,ii=new WeakMap;class ia{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=sJ(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){let{presenceContext:s}=this.visualElement;if(s&&!1===s.isPresent)return;let{dragSnapToOrigin:i}=this.getProps();this.panSession=new sE(e,{onSessionStart:e=>{let{dragSnapToOrigin:s}=this.getProps();s?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(sP(e).point)},onStart:(e,t)=>{let{drag:s,dragPropagation:i,onDragStart:a}=this.getProps();if(s&&!i&&(this.openDragLock&&this.openDragLock(),this.openDragLock="x"===s||"y"===s?A[s]?null:(A[s]=!0,()=>{A[s]=!1}):A.x||A.y?null:(A.x=A.y=!0,()=>{A.x=A.y=!1}),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),sQ(e=>{let t=this.getAxisMotionValue(e).get()||0;if(eH.test(t)){let{projection:s}=this.visualElement;if(s&&s.layout){let i=s.layout.layoutBox[e];if(i){let e=sV(i);t=parseFloat(t)/100*e}}}this.originPoint[e]=t}),a&&ee.postRender(()=>a(e,t)),em(this.visualElement,"transform");let{animationState:n}=this.visualElement;n&&n.setActive("whileDrag",!0)},onMove:(e,t)=>{let{dragPropagation:s,dragDirectionLock:i,onDirectionLock:a,onDrag:n}=this.getProps();if(!s&&!this.openDragLock)return;let{offset:r}=t;if(i&&null===this.currentDirection){this.currentDirection=function(e,t=10){let s=null;return Math.abs(e.y)>t?s="y":Math.abs(e.x)>t&&(s="x"),s}(r),null!==this.currentDirection&&a&&a(this.currentDirection);return}this.updateAxis("x",t.point,r),this.updateAxis("y",t.point,r),this.visualElement.render(),n&&n(e,t)},onSessionEnd:(e,t)=>this.stop(e,t),resumeAnimation:()=>sQ(e=>{var t;return"paused"===this.getAnimationState(e)&&(null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.play())})},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:i,contextWindow:is(this.visualElement)})}stop(e,t){let s=this.isDragging;if(this.cancel(),!s)return;let{velocity:i}=t;this.startAnimation(i);let{onDragEnd:a}=this.getProps();a&&ee.postRender(()=>a(e,t))}cancel(){this.isDragging=!1;let{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;let{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,s){let{drag:i}=this.getProps();if(!s||!ir(e,i,this.currentDirection))return;let a=this.getAxisMotionValue(e),n=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(n=function(e,{min:t,max:s},i){return void 0!==t&&e<t?e=i?tF(t,e,i.min):Math.max(e,t):void 0!==s&&e>s&&(e=i?tF(s,e,i.max):Math.min(e,s)),e}(n,this.constraints[e],this.elastic[e])),a.set(n)}resolveConstraints(){var e;let{dragConstraints:t,dragElastic:s}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(e=this.visualElement.projection)||void 0===e?void 0:e.layout,a=this.constraints;t&&sO(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=function(e,{top:t,left:s,bottom:i,right:a}){return{x:sH(e.x,s,a),y:sH(e.y,t,i)}}(i.layoutBox,t):this.constraints=!1,this.elastic=function(e=.35){return!1===e?e=0:!0===e&&(e=.35),{x:sq(e,"left","right"),y:sq(e,"top","bottom")}}(s),a!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&sQ(e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){let s={};return void 0!==t.min&&(s.min=t.min-e.min),void 0!==t.max&&(s.max=t.max-e.min),s}(i.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){var e;let{dragConstraints:t,onMeasureDragConstraints:s}=this.getProps();if(!t||!sO(t))return!1;let i=t.current;H(null!==i,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");let{projection:a}=this.visualElement;if(!a||!a.layout)return!1;let n=function(e,t,s){let i=it(e,s),{scroll:a}=t;return a&&(s9(i.x,a.offset.x),s9(i.y,a.offset.y)),i}(i,a.root,this.visualElement.getTransformPagePoint()),r={x:sW((e=a.layout.layoutBox).x,n.x),y:sW(e.y,n.y)};if(s){let e=s(function({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}(r));this.hasMutatedConstraints=!!e,e&&(r=s0(e))}return r}startAnimation(e){let{drag:t,dragMomentum:s,dragElastic:i,dragTransition:a,dragSnapToOrigin:n,onDragTransitionEnd:r}=this.getProps(),l=this.constraints||{};return Promise.all(sQ(r=>{if(!ir(r,t,this.currentDirection))return;let o=l&&l[r]||{};n&&(o={min:0,max:0});let c={type:"inertia",velocity:s?e[r]:0,bounceStiffness:i?200:1e6,bounceDamping:i?40:1e7,timeConstant:750,restDelta:1,restSpeed:10,...a,...o};return this.startAxisValueAnimation(r,c)})).then(r)}startAxisValueAnimation(e,t){let s=this.getAxisMotionValue(e);return em(this.visualElement,e),s.start(sp(e,s,0,t,this.visualElement,!1))}stopAnimation(){sQ(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){sQ(e=>{var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.pause()})}getAnimationState(e){var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.state}getAxisMotionValue(e){let t=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps();return s[t]||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){sQ(t=>{let{drag:s}=this.getProps();if(!ir(t,s,this.currentDirection))return;let{projection:i}=this.visualElement,a=this.getAxisMotionValue(t);if(i&&i.layout){let{min:s,max:n}=i.layout.layoutBox[t];a.set(e[t]-tF(s,n,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:e,dragConstraints:t}=this.getProps(),{projection:s}=this.visualElement;if(!sO(t)||!s||!this.constraints)return;this.stopAnimation();let i={x:0,y:0};sQ(e=>{let t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){let s=t.get();i[e]=function(e,t){let s=.5,i=sV(e),a=sV(t);return a>i?s=T(t.min,t.max-i,e.min):i>a&&(s=T(e.min,e.max-a,t.min)),eM(0,1,s)}({min:s,max:s},this.constraints[e])}});let{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),sQ(t=>{if(!ir(t,e,null))return;let s=this.getAxisMotionValue(t),{min:a,max:n}=this.constraints[t];s.set(tF(a,n,i[t]))})}addListeners(){if(!this.visualElement.current)return;ii.set(this.visualElement,this);let e=sD(this.visualElement.current,"pointerdown",e=>{let{drag:t,dragListener:s=!0}=this.getProps();t&&s&&this.start(e)}),t=()=>{let{dragConstraints:e}=this.getProps();sO(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",t);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),ee.read(t);let a=sT(window,"resize",()=>this.scalePositionWithinConstraints()),n=s.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t})=>{this.isDragging&&t&&(sQ(t=>{let s=this.getAxisMotionValue(t);s&&(this.originPoint[t]+=e[t].translate,s.set(s.get()+e[t].translate))}),this.visualElement.render())});return()=>{a(),e(),i(),n&&n()}}getProps(){let e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:s=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:n=.35,dragMomentum:r=!0}=e;return{...e,drag:t,dragDirectionLock:s,dragPropagation:i,dragConstraints:a,dragElastic:n,dragMomentum:r}}}function ir(e,t,s){return(!0===t||t===e)&&(null===s||s===e)}class il extends sk{constructor(e){super(e),this.removeGroupControls=H,this.removeListeners=H,this.controls=new ia(e)}mount(){let{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||H}unmount(){this.removeGroupControls(),this.removeListeners()}}let io=e=>(t,s)=>{e&&ee.postRender(()=>e(t,s))};class ic extends sk{constructor(){super(...arguments),this.removePointerDownListener=H}onPointerDown(e){this.session=new sE(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:is(this.node)})}createPanHandlers(){let{onPanSessionStart:e,onPanStart:t,onPan:s,onPanEnd:i}=this.node.getProps();return{onSessionStart:io(e),onStart:io(t),onMove:s,onEnd:(e,t)=>{delete this.session,i&&ee.postRender(()=>i(e,t))}}}mount(){this.removePointerDownListener=sD(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let id=(0,l.createContext)(null);function ih(e=!0){let t=(0,l.useContext)(id);if(null===t)return[!0,null];let{isPresent:s,onExitComplete:i,register:a}=t,n=(0,l.useId)();(0,l.useEffect)(()=>{e&&a(n)},[e]);let r=(0,l.useCallback)(()=>e&&i&&i(n),[n,i,e]);return!s&&i?[!1,r]:[!0]}let iu=(0,l.createContext)({}),ix=(0,l.createContext)({}),im={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ip(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}let ig={correct:(e,t)=>{if(!t.target)return e;if("string"==typeof e){if(!eW.test(e))return e;e=parseFloat(e)}let s=ip(e,t.target.x),i=ip(e,t.target.y);return`${s}% ${i}%`}},iy={},{schedule:iv,cancel:ib}=Q(queueMicrotask,!1);class ij extends l.Component{componentDidMount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:s,layoutId:i}=this.props,{projection:a}=e;Object.assign(iy,iN),a&&(t.group&&t.group.add(a),s&&s.register&&i&&s.register(a),a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),im.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){let{layoutDependency:t,visualElement:s,drag:i,isPresent:a}=this.props,n=s.projection;return n&&(n.isPresent=a,i||e.layoutDependency!==t||void 0===t?n.willUpdate():this.safeToRemove(),e.isPresent===a||(a?n.promote():n.relegate()||ee.postRender(()=>{let e=n.getStack();e&&e.members.length||this.safeToRemove()}))),null}componentDidUpdate(){let{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),iv.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:s}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),s&&s.deregister&&s.deregister(i))}safeToRemove(){let{safeToRemove:e}=this.props;e&&e()}render(){return null}}function iw(e){let[t,s]=ih(),i=(0,l.useContext)(iu);return(0,r.jsx)(ij,{...e,layoutGroup:i,switchLayoutGroup:(0,l.useContext)(ix),isPresent:t,safeToRemove:s})}let iN={borderRadius:{...ig,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ig,borderTopRightRadius:ig,borderBottomLeftRadius:ig,borderBottomRightRadius:ig,boxShadow:{correct:(e,{treeScale:t,projectionDelta:s})=>{let i=e8.parse(e);if(i.length>5)return e;let a=e8.createTransformer(e),n="number"!=typeof i[0]?1:0,r=s.x.scale*t.x,l=s.y.scale*t.y;i[0+n]/=r,i[1+n]/=l;let o=tF(r,l,.5);return"number"==typeof i[2+n]&&(i[2+n]/=o),"number"==typeof i[3+n]&&(i[3+n]/=o),a(i)}}},ik=(e,t)=>e.depth-t.depth;class iS{constructor(){this.children=[],this.isDirty=!1}add(e){er(this.children,e),this.isDirty=!0}remove(e){el(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(ik),this.isDirty=!1,this.children.forEach(e)}}function iC(e){let t=ex(e)?e.get():e;return X(t)?t.toValue():t}let iR=["TopLeft","TopRight","BottomLeft","BottomRight"],iT=iR.length,iP=e=>"string"==typeof e?parseFloat(e):e,iM=e=>"number"==typeof e||eW.test(e);function iD(e,t){return void 0!==e[t]?e[t]:e.borderRadius}let iA=iF(0,.5,eR),iE=iF(.5,.95,H);function iF(e,t,s){return i=>i<e?0:i>t?1:s(T(e,t,i))}function i$(e,t){e.min=t.min,e.max=t.max}function iI(e,t){i$(e.x,t.x),i$(e.y,t.y)}function iL(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function iO(e,t,s,i,a){return e-=t,e=i+1/s*(e-i),void 0!==a&&(e=i+1/a*(e-i)),e}function iV(e,t,[s,i,a],n,r){!function(e,t=0,s=1,i=.5,a,n=e,r=e){if(eH.test(t)&&(t=parseFloat(t),t=tF(r.min,r.max,t/100)-r.min),"number"!=typeof t)return;let l=tF(n.min,n.max,i);e===n&&(l-=t),e.min=iO(e.min,t,s,l,a),e.max=iO(e.max,t,s,l,a)}(e,t[s],t[i],t[a],t.scale,n,r)}let iB=["x","scaleX","originX"],iz=["y","scaleY","originY"];function iU(e,t,s,i){iV(e.x,t,iB,s?s.x:void 0,i?i.x:void 0),iV(e.y,t,iz,s?s.y:void 0,i?i.y:void 0)}function i_(e){return 0===e.translate&&1===e.scale}function iZ(e){return i_(e.x)&&i_(e.y)}function iH(e,t){return e.min===t.min&&e.max===t.max}function iW(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function iq(e,t){return iW(e.x,t.x)&&iW(e.y,t.y)}function iG(e){return sV(e.x)/sV(e.y)}function iX(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class iK{constructor(){this.members=[]}add(e){er(this.members,e),e.scheduleRender()}remove(e){if(el(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){let e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){let t;let s=this.members.findIndex(t=>e===t);if(0===s)return!1;for(let e=s;e>=0;e--){let s=this.members[e];if(!1!==s.isPresent){t=s;break}}return!!t&&(this.promote(t),!0)}promote(e,t){let s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,t&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);let{crossfade:i}=e.options;!1===i&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{let{options:t,resumingFrom:s}=e;t.onExitComplete&&t.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}let iY={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},iJ="undefined"!=typeof window&&void 0!==window.MotionDebug,iQ=["","X","Y","Z"],i0={visibility:"hidden"},i1=0;function i2(e,t,s,i){let{latestValues:a}=t;a[e]&&(s[e]=a[e],t.setStaticValue(e,0),i&&(i[e]=0))}function i5({attachResizeListener:e,defaultParent:t,measureScroll:s,checkIsScrollRoot:i,resetTransform:a}){return class{constructor(e={},s=null==t?void 0:t()){this.id=i1++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,iJ&&(iY.totalNodes=iY.resolvedTargetDeltas=iY.recalculatedProjection=0),this.nodes.forEach(i8),this.nodes.forEach(ai),this.nodes.forEach(aa),this.nodes.forEach(i6),iJ&&window.MotionDebug.record(iY)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=s?s.root||s:this,this.path=s?[...s.path,s]:[],this.parent=s,this.depth=s?s.depth+1:0;for(let e=0;e<this.path.length;e++)this.path[e].shouldResetTransform=!0;this.root===this&&(this.nodes=new iS)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new eo),this.eventHandlers.get(e).add(t)}notifyListeners(e,...t){let s=this.eventHandlers.get(e);s&&s.notify(...t)}hasListeners(e){return this.eventHandlers.has(e)}mount(t,s=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=t instanceof SVGElement&&"svg"!==t.tagName,this.instance=t;let{layoutId:i,layout:a,visualElement:n}=this.options;if(n&&!n.current&&n.mount(t),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),s&&(a||i)&&(this.isLayoutDirty=!0),e){let s;let i=()=>this.root.updateBlockedByResize=!1;e(t,()=>{this.root.updateBlockedByResize=!0,s&&s(),s=function(e,t){let s=en.now(),i=({timestamp:t})=>{let a=t-s;a>=250&&(et(i),e(a-250))};return ee.read(i,!0),()=>et(i)}(i,250),im.hasAnimatedSinceResize&&(im.hasAnimatedSinceResize=!1,this.nodes.forEach(as))})}i&&this.root.registerSharedNode(i,this),!1!==this.options.animate&&n&&(i||a)&&this.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t,hasRelativeTargetChanged:s,layout:i})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let a=this.options.transition||n.getDefaultTransition()||ad,{onLayoutAnimationStart:r,onLayoutAnimationComplete:l}=n.getProps(),o=!this.targetLayout||!iq(this.targetLayout,i)||s,c=!t&&s;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||c||t&&(o||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(e,c);let t={...j(a,"layout"),onPlay:r,onComplete:l};(n.shouldReduceMotion||this.options.layoutRoot)&&(t.delay=0,t.type=!1),this.startAnimation(t)}else t||as(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=i})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,et(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){!this.isUpdateBlocked()&&(this.isUpdating=!0,this.nodes&&this.nodes.forEach(an),this.animationId++)}getTransformTemplate(){let{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(e=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&function e(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;let{visualElement:s}=t.options;if(!s)return;let i=s.props[eg];if(window.MotionHasOptimisedAnimation(i,"transform")){let{layout:e,layoutId:s}=t.options;window.MotionCancelOptimisedAnimation(i,"transform",ee,!(e||s))}let{parent:a}=t;a&&!a.hasCheckedOptimisedAppear&&e(a)}(this),this.root.isUpdating||this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let e=0;e<this.path.length;e++){let t=this.path[e];t.shouldResetTransform=!0,t.updateScroll("snapshot"),t.options.layoutRoot&&t.willUpdate(!1)}let{layoutId:t,layout:s}=this.options;if(void 0===t&&!s)return;let i=this.getTransformTemplate();this.prevTransformTemplateValue=i?i(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(i7);return}this.isUpdating||this.nodes.forEach(ae),this.isUpdating=!1,this.nodes.forEach(at),this.nodes.forEach(i3),this.nodes.forEach(i4),this.clearAllSnapshots();let e=en.now();es.delta=eM(0,1e3/60,e-es.timestamp),es.timestamp=e,es.isProcessing=!0,ei.update.process(es),ei.preRender.process(es),ei.render.process(es),es.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,iv.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(i9),this.sharedNodes.forEach(ar)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ee.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ee.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let e=0;e<this.path.length;e++)this.path[e].updateScroll();let e=this.layout;this.layout=this.measure(!1),this.layoutCorrected=sJ(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(e="measure"){let t=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t){let t=i(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:s(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!a)return;let e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!iZ(this.projectionDelta),s=this.getTransformTemplate(),i=s?s(this.latestValues,""):void 0,n=i!==this.prevTransformTemplateValue;e&&(t||s5(this.latestValues)||n)&&(a(this.instance,i),this.shouldResetTransform=!1,this.scheduleRender())}measure(e=!0){var t;let s=this.measurePageBox(),i=this.removeElementScroll(s);return e&&(i=this.removeTransform(i)),ax((t=i).x),ax(t.y),{animationId:this.root.animationId,measuredBox:s,layoutBox:i,latestValues:{},source:this.id}}measurePageBox(){var e;let{visualElement:t}=this.options;if(!t)return sJ();let s=t.measureViewportBox();if(!((null===(e=this.scroll)||void 0===e?void 0:e.wasRoot)||this.path.some(ap))){let{scroll:e}=this.root;e&&(s9(s.x,e.offset.x),s9(s.y,e.offset.y))}return s}removeElementScroll(e){var t;let s=sJ();if(iI(s,e),null===(t=this.scroll)||void 0===t?void 0:t.wasRoot)return s;for(let t=0;t<this.path.length;t++){let i=this.path[t],{scroll:a,options:n}=i;i!==this.root&&a&&n.layoutScroll&&(a.wasRoot&&iI(s,e),s9(s.x,a.offset.x),s9(s.y,a.offset.y))}return s}applyTransform(e,t=!1){let s=sJ();iI(s,e);for(let e=0;e<this.path.length;e++){let i=this.path[e];!t&&i.options.layoutScroll&&i.scroll&&i!==i.root&&ie(s,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),s5(i.latestValues)&&ie(s,i.latestValues)}return s5(this.latestValues)&&ie(s,this.latestValues),s}removeTransform(e){let t=sJ();iI(t,e);for(let e=0;e<this.path.length;e++){let s=this.path[e];if(!s.instance||!s5(s.latestValues))continue;s2(s.latestValues)&&s.updateSnapshot();let i=sJ();iI(i,s.measurePageBox()),iU(t,s.latestValues,s.snapshot?s.snapshot.layoutBox:void 0,i)}return s5(this.latestValues)&&iU(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==es.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(e=!1){var t,s,i,a;let n=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=n.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=n.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=n.isSharedProjectionDirty);let r=!!this.resumingFrom||this!==n;if(!(e||r&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(t=this.parent)||void 0===t?void 0:t.isProjectionDirty)||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;let{layout:l,layoutId:o}=this.options;if(this.layout&&(l||o)){if(this.resolvedRelativeTargetAt=es.timestamp,!this.targetDelta&&!this.relativeTarget){let e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget=sJ(),this.relativeTargetOrigin=sJ(),sZ(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),iI(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){if((this.target||(this.target=sJ(),this.targetWithTransforms=sJ()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target)?(this.forceRelativeParentToResolveTarget(),s=this.target,i=this.relativeTarget,a=this.relativeParent.target,sU(s.x,i.x,a.x),sU(s.y,i.y,a.y)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):iI(this.target,this.layout.layoutBox),s6(this.target,this.targetDelta)):iI(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;let e=this.getClosestProjectingParent();e&&!!e.resumingFrom==!!this.resumingFrom&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget=sJ(),this.relativeTargetOrigin=sJ(),sZ(this.relativeTargetOrigin,this.target,e.target),iI(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}iJ&&iY.resolvedTargetDeltas++}}}getClosestProjectingParent(){return!this.parent||s2(this.parent.latestValues)||s3(this.parent.latestValues)?void 0:this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;let t=this.getLead(),s=!!this.resumingFrom||this!==t,i=!0;if((this.isProjectionDirty||(null===(e=this.parent)||void 0===e?void 0:e.isProjectionDirty))&&(i=!1),s&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(i=!1),this.resolvedRelativeTargetAt===es.timestamp&&(i=!1),i)return;let{layout:a,layoutId:n}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(a||n))return;iI(this.layoutCorrected,this.layout.layoutBox);let r=this.treeScale.x,l=this.treeScale.y;(function(e,t,s,i=!1){let a,n;let r=s.length;if(r){t.x=t.y=1;for(let l=0;l<r;l++){n=(a=s[l]).projectionDelta;let{visualElement:r}=a.options;(!r||!r.props.style||"contents"!==r.props.style.display)&&(i&&a.options.layoutScroll&&a.scroll&&a!==a.root&&ie(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),n&&(t.x*=n.x.scale,t.y*=n.y.scale,s6(e,n)),i&&s5(a.latestValues)&&ie(e,a.latestValues))}t.x<1.0000000000001&&t.x>.999999999999&&(t.x=1),t.y<1.0000000000001&&t.y>.999999999999&&(t.y=1)}})(this.layoutCorrected,this.treeScale,this.path,s),t.layout&&!t.target&&(1!==this.treeScale.x||1!==this.treeScale.y)&&(t.target=t.layout.layoutBox,t.targetWithTransforms=sJ());let{target:o}=t;if(!o){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}this.projectionDelta&&this.prevProjectionDelta?(iL(this.prevProjectionDelta.x,this.projectionDelta.x),iL(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),sz(this.projectionDelta,this.layoutCorrected,o,this.latestValues),this.treeScale.x===r&&this.treeScale.y===l&&iX(this.projectionDelta.x,this.prevProjectionDelta.x)&&iX(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",o)),iJ&&iY.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(e=!0){var t;if(null===(t=this.options.visualElement)||void 0===t||t.scheduleRender(),e){let e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=sK(),this.projectionDelta=sK(),this.projectionDeltaWithTransform=sK()}setAnimationOrigin(e,t=!1){let s;let i=this.snapshot,a=i?i.latestValues:{},n={...this.latestValues},r=sK();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;let l=sJ(),o=(i?i.source:void 0)!==(this.layout?this.layout.source:void 0),c=this.getStack(),d=!c||c.members.length<=1,h=!!(o&&!d&&!0===this.options.crossfade&&!this.path.some(ac));this.animationProgress=0,this.mixTargetDelta=t=>{let i=t/1e3;if(al(r.x,e.x,i),al(r.y,e.y,i),this.setTargetDelta(r),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout){var c,u,x,m;sZ(l,this.layout.layoutBox,this.relativeParent.layout.layoutBox),x=this.relativeTarget,m=this.relativeTargetOrigin,ao(x.x,m.x,l.x,i),ao(x.y,m.y,l.y,i),s&&(c=this.relativeTarget,u=s,iH(c.x,u.x)&&iH(c.y,u.y))&&(this.isProjectionDirty=!1),s||(s=sJ()),iI(s,this.relativeTarget)}o&&(this.animationValues=n,function(e,t,s,i,a,n){a?(e.opacity=tF(0,void 0!==s.opacity?s.opacity:1,iA(i)),e.opacityExit=tF(void 0!==t.opacity?t.opacity:1,0,iE(i))):n&&(e.opacity=tF(void 0!==t.opacity?t.opacity:1,void 0!==s.opacity?s.opacity:1,i));for(let a=0;a<iT;a++){let n=`border${iR[a]}Radius`,r=iD(t,n),l=iD(s,n);(void 0!==r||void 0!==l)&&(r||(r=0),l||(l=0),0===r||0===l||iM(r)===iM(l)?(e[n]=Math.max(tF(iP(r),iP(l),i),0),(eH.test(l)||eH.test(r))&&(e[n]+="%")):e[n]=l)}(t.rotate||s.rotate)&&(e.rotate=tF(t.rotate||0,s.rotate||0,i))}(n,a,this.latestValues,i,h,d)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=i},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(et(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ee.update(()=>{im.hasAnimatedSinceResize=!0,this.currentAnimation=function(e,t,s){let i=ex(0)?0:eu(0);return i.start(sp("",i,1e3,s)),i.animation}(0,0,{...e,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onComplete:()=>{e.onComplete&&e.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let e=this.getLead(),{targetWithTransforms:t,target:s,layout:i,latestValues:a}=e;if(t&&s&&i){if(this!==e&&this.layout&&i&&am(this.options.animationType,this.layout.layoutBox,i.layoutBox)){s=this.target||sJ();let t=sV(this.layout.layoutBox.x);s.x.min=e.target.x.min,s.x.max=s.x.min+t;let i=sV(this.layout.layoutBox.y);s.y.min=e.target.y.min,s.y.max=s.y.min+i}iI(t,s),ie(t,a),sz(this.projectionDeltaWithTransform,this.layoutCorrected,t,a)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new iK),this.sharedNodes.get(e).add(t);let s=t.options.initialPromotionConfig;t.promote({transition:s?s.transition:void 0,preserveFollowOpacity:s&&s.shouldPreserveFollowOpacity?s.shouldPreserveFollowOpacity(t):void 0})}isLead(){let e=this.getStack();return!e||e.lead===this}getLead(){var e;let{layoutId:t}=this.options;return t&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this}getPrevLead(){var e;let{layoutId:t}=this.options;return t?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0}getStack(){let{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote({needsReset:e,transition:t,preserveFollowOpacity:s}={}){let i=this.getStack();i&&i.promote(this,s),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){let e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){let{visualElement:e}=this.options;if(!e)return;let t=!1,{latestValues:s}=e;if((s.z||s.rotate||s.rotateX||s.rotateY||s.rotateZ||s.skewX||s.skewY)&&(t=!0),!t)return;let i={};s.z&&i2("z",e,i,this.animationValues);for(let t=0;t<iQ.length;t++)i2(`rotate${iQ[t]}`,e,i,this.animationValues),i2(`skew${iQ[t]}`,e,i,this.animationValues);for(let t in e.render(),i)e.setStaticValue(t,i[t]),this.animationValues&&(this.animationValues[t]=i[t]);e.scheduleRender()}getProjectionStyles(e){var t,s;if(!this.instance||this.isSVG)return;if(!this.isVisible)return i0;let i={visibility:""},a=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,i.opacity="",i.pointerEvents=iC(null==e?void 0:e.pointerEvents)||"",i.transform=a?a(this.latestValues,""):"none",i;let n=this.getLead();if(!this.projectionDelta||!this.layout||!n.target){let t={};return this.options.layoutId&&(t.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,t.pointerEvents=iC(null==e?void 0:e.pointerEvents)||""),this.hasProjected&&!s5(this.latestValues)&&(t.transform=a?a({},""):"none",this.hasProjected=!1),t}let r=n.animationValues||n.latestValues;this.applyTransformsToTarget(),i.transform=function(e,t,s){let i="",a=e.x.translate/t.x,n=e.y.translate/t.y,r=(null==s?void 0:s.z)||0;if((a||n||r)&&(i=`translate3d(${a}px, ${n}px, ${r}px) `),(1!==t.x||1!==t.y)&&(i+=`scale(${1/t.x}, ${1/t.y}) `),s){let{transformPerspective:e,rotate:t,rotateX:a,rotateY:n,skewX:r,skewY:l}=s;e&&(i=`perspective(${e}px) ${i}`),t&&(i+=`rotate(${t}deg) `),a&&(i+=`rotateX(${a}deg) `),n&&(i+=`rotateY(${n}deg) `),r&&(i+=`skewX(${r}deg) `),l&&(i+=`skewY(${l}deg) `)}let l=e.x.scale*t.x,o=e.y.scale*t.y;return(1!==l||1!==o)&&(i+=`scale(${l}, ${o})`),i||"none"}(this.projectionDeltaWithTransform,this.treeScale,r),a&&(i.transform=a(r,i.transform));let{x:l,y:o}=this.projectionDelta;for(let e in i.transformOrigin=`${100*l.origin}% ${100*o.origin}% 0`,n.animationValues?i.opacity=n===this?null!==(s=null!==(t=r.opacity)&&void 0!==t?t:this.latestValues.opacity)&&void 0!==s?s:1:this.preserveOpacity?this.latestValues.opacity:r.opacityExit:i.opacity=n===this?void 0!==r.opacity?r.opacity:"":void 0!==r.opacityExit?r.opacityExit:0,iy){if(void 0===r[e])continue;let{correct:t,applyTo:s}=iy[e],a="none"===i.transform?r[e]:t(r[e],n);if(s){let e=s.length;for(let t=0;t<e;t++)i[s[t]]=a}else i[e]=a}return this.options.layoutId&&(i.pointerEvents=n===this?iC(null==e?void 0:e.pointerEvents)||"":"none"),i}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>{var t;return null===(t=e.currentAnimation)||void 0===t?void 0:t.stop()}),this.root.nodes.forEach(i7),this.root.sharedNodes.clear()}}}function i3(e){e.updateLayout()}function i4(e){var t;let s=(null===(t=e.resumeFrom)||void 0===t?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&s&&e.hasListeners("didUpdate")){let{layoutBox:t,measuredBox:i}=e.layout,{animationType:a}=e.options,n=s.source!==e.layout.source;"size"===a?sQ(e=>{let i=n?s.measuredBox[e]:s.layoutBox[e],a=sV(i);i.min=t[e].min,i.max=i.min+a}):am(a,s.layoutBox,t)&&sQ(i=>{let a=n?s.measuredBox[i]:s.layoutBox[i],r=sV(t[i]);a.max=a.min+r,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[i].max=e.relativeTarget[i].min+r)});let r=sK();sz(r,t,s.layoutBox);let l=sK();n?sz(l,e.applyTransform(i,!0),s.measuredBox):sz(l,t,s.layoutBox);let o=!iZ(r),c=!1;if(!e.resumeFrom){let i=e.getClosestProjectingParent();if(i&&!i.resumeFrom){let{snapshot:a,layout:n}=i;if(a&&n){let r=sJ();sZ(r,s.layoutBox,a.layoutBox);let l=sJ();sZ(l,t,n.layoutBox),iq(r,l)||(c=!0),i.options.layoutRoot&&(e.relativeTarget=l,e.relativeTargetOrigin=r,e.relativeParent=i)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:s,delta:l,layoutDelta:r,hasLayoutChanged:o,hasRelativeTargetChanged:c})}else if(e.isLead()){let{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function i8(e){iJ&&iY.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function i6(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function i9(e){e.clearSnapshot()}function i7(e){e.clearMeasurements()}function ae(e){e.isLayoutDirty=!1}function at(e){let{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function as(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function ai(e){e.resolveTargetDelta()}function aa(e){e.calcProjection()}function an(e){e.resetSkewAndRotation()}function ar(e){e.removeLeadSnapshot()}function al(e,t,s){e.translate=tF(t.translate,0,s),e.scale=tF(t.scale,1,s),e.origin=t.origin,e.originPoint=t.originPoint}function ao(e,t,s,i){e.min=tF(t.min,s.min,i),e.max=tF(t.max,s.max,i)}function ac(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}let ad={duration:.45,ease:[.4,0,.1,1]},ah=e=>"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),au=ah("applewebkit/")&&!ah("chrome/")?Math.round:H;function ax(e){e.min=au(e.min),e.max=au(e.max)}function am(e,t,s){return"position"===e||"preserve-aspect"===e&&!(.2>=Math.abs(iG(t)-iG(s)))}function ap(e){var t;return e!==e.root&&(null===(t=e.scroll)||void 0===t?void 0:t.wasRoot)}let ag=i5({attachResizeListener:(e,t)=>sT(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),af={current:void 0},ay=i5({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!af.current){let e=new ag({});e.mount(window),e.setOptions({layoutScroll:!0}),af.current=e}return af.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>"fixed"===window.getComputedStyle(e).position});function av(e,t,s){let{props:i}=e;e.animationState&&i.whileHover&&e.animationState.setActive("whileHover","Start"===s);let a=i["onHover"+s];a&&ee.postRender(()=>a(t,sP(t)))}class ab extends sk{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,t,s={}){let[i,a,n]=E(e,s),r=F(e=>{let{target:s}=e,i=t(e);if("function"!=typeof i||!s)return;let n=F(e=>{i(e),s.removeEventListener("pointerleave",n)});s.addEventListener("pointerleave",n,a)});return i.forEach(e=>{e.addEventListener("pointerenter",r,a)}),n}(e,e=>(av(this.node,e,"Start"),e=>av(this.node,e,"End"))))}unmount(){}}class aj extends sk{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(t){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=t_(sT(this.node.current,"focus",()=>this.onFocus()),sT(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function aw(e,t,s){let{props:i}=e;e.animationState&&i.whileTap&&e.animationState.setActive("whileTap","Start"===s);let a=i["onTap"+("End"===s?"":s)];a&&ee.postRender(()=>a(t,sP(t)))}class aN extends sk{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,t,s={}){let[i,a,n]=E(e,s),r=e=>{let i=e.currentTarget;if(!U(e)||O.has(i))return;O.add(i);let n=t(e),r=(e,t)=>{window.removeEventListener("pointerup",l),window.removeEventListener("pointercancel",o),U(e)&&O.has(i)&&(O.delete(i),"function"==typeof n&&n(e,{success:t}))},l=e=>{r(e,s.useGlobalTarget||$(i,e.target))},o=e=>{r(e,!1)};window.addEventListener("pointerup",l,a),window.addEventListener("pointercancel",o,a)};return i.forEach(e=>{L.has(e.tagName)||-1!==e.tabIndex||null!==e.getAttribute("tabindex")||(e.tabIndex=0),(s.useGlobalTarget?window:e).addEventListener("pointerdown",r,a),e.addEventListener("focus",e=>z(e,a),a)}),n}(e,e=>(aw(this.node,e,"Start"),(e,{success:t})=>aw(this.node,e,t?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}let ak=new WeakMap,aS=new WeakMap,aC=e=>{let t=ak.get(e.target);t&&t(e)},aR=e=>{e.forEach(aC)},aT={some:0,all:1};class aP extends sk{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();let{viewport:e={}}=this.node.getProps(),{root:t,margin:s,amount:i="some",once:a}=e,n={root:t?t.current:void 0,rootMargin:s,threshold:"number"==typeof i?i:aT[i]};return function(e,t,s){let i=function({root:e,...t}){let s=e||document;aS.has(s)||aS.set(s,{});let i=aS.get(s),a=JSON.stringify(t);return i[a]||(i[a]=new IntersectionObserver(aR,{root:e,...t})),i[a]}(t);return ak.set(e,s),i.observe(e),()=>{ak.delete(e),i.unobserve(e)}}(this.node.current,n,e=>{let{isIntersecting:t}=e;if(this.isInView===t||(this.isInView=t,a&&!t&&this.hasEnteredView))return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);let{onViewportEnter:s,onViewportLeave:i}=this.node.getProps(),n=t?s:i;n&&n(e)})}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;let{props:e,prevProps:t}=this.node;["amount","margin","root"].some(function({viewport:e={}},{viewport:t={}}={}){return s=>e[s]!==t[s]}(e,t))&&this.startObserver()}unmount(){}}let aM=(0,l.createContext)({strict:!1}),aD=(0,l.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),aA=(0,l.createContext)({});function aE(e){return o(e.animate)||g.some(t=>h(e[t]))}function aF(e){return!!(aE(e)||e.variants)}function a$(e){return Array.isArray(e)?e.join(" "):e}let aI="undefined"!=typeof window,aL={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},aO={};for(let e in aL)aO[e]={isEnabled:t=>aL[e].some(e=>!!t[e])};let aV=Symbol.for("motionComponentSymbol"),aB=aI?l.useLayoutEffect:l.useEffect,az=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function aU(e){if("string"!=typeof e||e.includes("-"));else if(az.indexOf(e)>-1||/[A-Z]/u.test(e))return!0;return!1}function a_(e){let t=(0,l.useRef)(null);return null===t.current&&(t.current=e()),t.current}let aZ=e=>(t,s)=>{let i=(0,l.useContext)(aA),a=(0,l.useContext)(id),n=()=>(function({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:s},i,a,n){let r={latestValues:function(e,t,s,i){let a={},n=i(e,{});for(let e in n)a[e]=iC(n[e]);let{initial:r,animate:l}=e,c=aE(e),d=aF(e);t&&d&&!c&&!1!==e.inherit&&(void 0===r&&(r=t.initial),void 0===l&&(l=t.animate));let h=!!s&&!1===s.initial,u=(h=h||!1===r)?l:r;if(u&&"boolean"!=typeof u&&!o(u)){let t=Array.isArray(u)?u:[u];for(let s=0;s<t.length;s++){let i=x(e,t[s]);if(i){let{transitionEnd:e,transition:t,...s}=i;for(let e in s){let t=s[e];if(Array.isArray(t)){let e=h?t.length-1:0;t=t[e]}null!==t&&(a[e]=t)}for(let t in e)a[t]=e[t]}}}return a}(i,a,n,e),renderState:t()};return s&&(r.onMount=e=>s({props:i,current:e,...r}),r.onUpdate=e=>s(e)),r})(e,t,i,a);return s?n():a_(n)},aH=(e,t)=>t&&"number"==typeof e?t.transform(e):e,aW={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},aq=W.length;function aG(e,t,s){let{style:i,vars:a,transformOrigin:n}=e,r=!1,l=!1;for(let e in t){let s=t[e];if(q.has(e)){r=!0;continue}if(tj(e)){a[e]=s;continue}{let t=aH(s,ts[e]);e.startsWith("origin")?(l=!0,n[e]=t):i[e]=t}}if(!t.transform&&(r||s?i.transform=function(e,t,s){let i="",a=!0;for(let n=0;n<aq;n++){let r=W[n],l=e[r];if(void 0===l)continue;let o=!0;if(!(o="number"==typeof l?l===(r.startsWith("scale")?1:0):0===parseFloat(l))||s){let e=aH(l,ts[r]);if(!o){a=!1;let t=aW[r]||r;i+=`${t}(${e}) `}s&&(t[r]=e)}}return i=i.trim(),s?i=s(t,a?"":i):a&&(i="none"),i}(t,e.transform,s):i.transform&&(i.transform="none")),l){let{originX:e="50%",originY:t="50%",originZ:s=0}=n;i.transformOrigin=`${e} ${t} ${s}`}}let aX={offset:"stroke-dashoffset",array:"stroke-dasharray"},aK={offset:"strokeDashoffset",array:"strokeDasharray"};function aY(e,t,s){return"string"==typeof e?e:eW.transform(t+s*e)}function aJ(e,{attrX:t,attrY:s,attrScale:i,originX:a,originY:n,pathLength:r,pathSpacing:l=1,pathOffset:o=0,...c},d,h){if(aG(e,c,h),d){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};let{attrs:u,style:x,dimensions:m}=e;u.transform&&(m&&(x.transform=u.transform),delete u.transform),m&&(void 0!==a||void 0!==n||x.transform)&&(x.transformOrigin=function(e,t,s){let i=aY(t,e.x,e.width),a=aY(s,e.y,e.height);return`${i} ${a}`}(m,void 0!==a?a:.5,void 0!==n?n:.5)),void 0!==t&&(u.x=t),void 0!==s&&(u.y=s),void 0!==i&&(u.scale=i),void 0!==r&&function(e,t,s=1,i=0,a=!0){e.pathLength=1;let n=a?aX:aK;e[n.offset]=eW.transform(-i);let r=eW.transform(t),l=eW.transform(s);e[n.array]=`${r} ${l}`}(u,r,l,o,!1)}let aQ=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),a0=()=>({...aQ(),attrs:{}}),a1=e=>"string"==typeof e&&"svg"===e.toLowerCase();function a2(e,{style:t,vars:s},i,a){for(let n in Object.assign(e.style,t,a&&a.getProjectionStyles(i)),s)e.style.setProperty(n,s[n])}let a5=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function a3(e,t,s,i){for(let s in a2(e,t,void 0,i),t.attrs)e.setAttribute(a5.has(s)?s:ep(s),t.attrs[s])}function a4(e,{layout:t,layoutId:s}){return q.has(e)||e.startsWith("origin")||(t||void 0!==s)&&(!!iy[e]||"opacity"===e)}function a8(e,t,s){var i;let{style:a}=e,n={};for(let r in a)(ex(a[r])||t.style&&ex(t.style[r])||a4(r,e)||(null===(i=null==s?void 0:s.getValue(r))||void 0===i?void 0:i.liveStyle)!==void 0)&&(n[r]=a[r]);return n}function a6(e,t,s){let i=a8(e,t,s);for(let s in e)(ex(e[s])||ex(t[s]))&&(i[-1!==W.indexOf(s)?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s]=e[s]);return i}let a9=["x","y","width","height","cx","cy","r"],a7={useVisualState:aZ({scrapeMotionValuesFromProps:a6,createRenderState:a0,onUpdate:({props:e,prevProps:t,current:s,renderState:i,latestValues:a})=>{if(!s)return;let n=!!e.drag;if(!n){for(let e in a)if(q.has(e)){n=!0;break}}if(!n)return;let r=!t;if(t)for(let s=0;s<a9.length;s++){let i=a9[s];e[i]!==t[i]&&(r=!0)}r&&ee.read(()=>{(function(e,t){try{t.dimensions="function"==typeof e.getBBox?e.getBBox():e.getBoundingClientRect()}catch(e){t.dimensions={x:0,y:0,width:0,height:0}}})(s,i),ee.render(()=>{aJ(i,a,a1(s.tagName),e.transformTemplate),a3(s,i)})})}})},ne={useVisualState:aZ({scrapeMotionValuesFromProps:a8,createRenderState:aQ})};function nt(e,t,s){for(let i in t)ex(t[i])||a4(i,s)||(e[i]=t[i])}let ns=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function ni(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||ns.has(e)}let na=e=>!ni(e);try{!function(e){e&&(na=t=>t.startsWith("on")?!ni(t):e(t))}(require("@emotion/is-prop-valid").default)}catch(e){}let nn={current:null},nr={current:!1},nl=[...tR,eY,e8],no=e=>nl.find(tC(e)),nc=new WeakMap,nd=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class nh{scrapeMotionValuesFromProps(e,t,s){return{}}constructor({parent:e,props:t,presenceContext:s,reducedMotionConfig:i,blockInitialAnimation:a,visualState:n},r={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=ty,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{let e=en.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,ee.render(this.render,!1,!0))};let{latestValues:l,renderState:o,onUpdate:c}=n;this.onUpdate=c,this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=o,this.parent=e,this.props=t,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=r,this.blockInitialAnimation=!!a,this.isControllingVariants=aE(t),this.isVariantNode=aF(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);let{willChange:d,...h}=this.scrapeMotionValuesFromProps(t,{},this);for(let e in h){let t=h[e];void 0!==l[e]&&ex(t)&&t.set(l[e],!1)}}mount(e){this.current=e,nc.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),nr.current||function(){if(nr.current=!0,aI){if(window.matchMedia){let e=window.matchMedia("(prefers-reduced-motion)"),t=()=>nn.current=e.matches;e.addListener(t),t()}else nn.current=!1}}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||nn.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){for(let e in nc.delete(this.current),this.projection&&this.projection.unmount(),et(this.notifyUpdate),et(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this),this.events)this.events[e].clear();for(let e in this.features){let t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){let s;this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();let i=q.has(e),a=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&ee.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),n=t.on("renderRequest",this.scheduleRender);window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{a(),n(),s&&s(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in aO){let t=aO[e];if(!t)continue;let{isEnabled:s,Feature:i}=t;if(!this.features[e]&&i&&s(this.props)&&(this.features[e]=new i(this)),this.features[e]){let t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):sJ()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let t=0;t<nd.length;t++){let s=nd[t];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);let i=e["on"+s];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=function(e,t,s){for(let i in t){let a=t[i],n=s[i];if(ex(a))e.addValue(i,a);else if(ex(n))e.addValue(i,eu(a,{owner:e}));else if(n!==a){if(e.hasValue(i)){let t=e.getValue(i);!0===t.liveStyle?t.jump(a):t.hasAnimated||t.set(a)}else{let t=e.getStaticValue(i);e.addValue(i,eu(void 0!==t?t:a,{owner:e}))}}}for(let i in s)void 0===t[i]&&e.removeValue(i);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){let t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){let s=this.values.get(e);t!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);let t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return void 0===s&&void 0!==t&&(s=eu(null===t?void 0:t,{owner:this}),this.addValue(e,s)),s}readValue(e,t){var s;let i=void 0===this.latestValues[e]&&this.current?null!==(s=this.getBaseTargetFromProps(this.props,e))&&void 0!==s?s:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];return null!=i&&("string"==typeof i&&(tv(i)||eP(i))?i=parseFloat(i):!no(i)&&e8.test(t)&&(i=tn(e,t)),this.setBaseTarget(e,ex(i)?i.get():i)),ex(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;let s;let{initial:i}=this.props;if("string"==typeof i||"object"==typeof i){let a=x(this.props,i,null===(t=this.presenceContext)||void 0===t?void 0:t.custom);a&&(s=a[e])}if(i&&void 0!==s)return s;let a=this.getBaseTargetFromProps(this.props,e);return void 0===a||ex(a)?void 0!==this.initialValues[e]&&void 0===s?void 0:this.baseTarget[e]:a}on(e,t){return this.events[e]||(this.events[e]=new eo),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class nu extends nh{constructor(){super(...arguments),this.KeyframeResolver=tP}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:s}){delete t[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:e}=this.props;ex(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}class nx extends nu{constructor(){super(...arguments),this.type="html",this.renderInstance=a2}readValueFromInstance(e,t){if(q.has(t)){let e=ta(t);return e&&e.default||0}{let s=window.getComputedStyle(e),i=(tj(t)?s.getPropertyValue(t):s[t])||0;return"string"==typeof i?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return it(e,t)}build(e,t,s){aG(e,t,s.transformTemplate)}scrapeMotionValuesFromProps(e,t,s){return a8(e,t,s)}}class nm extends nu{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=sJ}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(q.has(t)){let e=ta(t);return e&&e.default||0}return t=a5.has(t)?t:ep(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,s){return a6(e,t,s)}build(e,t,s){aJ(e,t,this.isSVGTag,s.transformTemplate)}renderInstance(e,t,s,i){a3(e,t,s,i)}mount(e){this.isSVGTag=a1(e.tagName),super.mount(e)}}let np=function(e){if("undefined"==typeof Proxy)return e;let t=new Map;return new Proxy((...t)=>e(...t),{get:(s,i)=>"create"===i?e:(t.has(i)||t.set(i,e(i)),t.get(i))})}((a={animation:{Feature:sS},exit:{Feature:sR},inView:{Feature:aP},tap:{Feature:aN},focus:{Feature:aj},hover:{Feature:ab},pan:{Feature:ic},drag:{Feature:il,ProjectionNode:ay,MeasureLayout:iw},layout:{ProjectionNode:ay,MeasureLayout:iw}},n=(e,t)=>aU(e)?new nm(t):new nx(t,{allowProjection:e!==l.Fragment}),function(e,{forwardMotionProps:t}={forwardMotionProps:!1}){return function({preloadedFeatures:e,createVisualElement:t,useRender:s,useVisualState:i,Component:a}){var n,o;function c(e,n){var o;let c;let d={...(0,l.useContext)(aD),...e,layoutId:function({layoutId:e}){let t=(0,l.useContext)(iu).id;return t&&void 0!==e?t+"-"+e:e}(e)},{isStatic:u}=d,x=function(e){let{initial:t,animate:s}=function(e,t){if(aE(e)){let{initial:t,animate:s}=e;return{initial:!1===t||h(t)?t:void 0,animate:h(s)?s:void 0}}return!1!==e.inherit?t:{}}(e,(0,l.useContext)(aA));return(0,l.useMemo)(()=>({initial:t,animate:s}),[a$(t),a$(s)])}(e),m=i(e,u);if(!u&&aI){(0,l.useContext)(aM).strict;let e=function(e){let{drag:t,layout:s}=aO;if(!t&&!s)return{};let i={...t,...s};return{MeasureLayout:(null==t?void 0:t.isEnabled(e))||(null==s?void 0:s.isEnabled(e))?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}(d);c=e.MeasureLayout,x.visualElement=function(e,t,s,i,a){var n,r;let{visualElement:o}=(0,l.useContext)(aA),c=(0,l.useContext)(aM),d=(0,l.useContext)(id),h=(0,l.useContext)(aD).reducedMotion,u=(0,l.useRef)(null);i=i||c.renderer,!u.current&&i&&(u.current=i(e,{visualState:t,parent:o,props:s,presenceContext:d,blockInitialAnimation:!!d&&!1===d.initial,reducedMotionConfig:h}));let x=u.current,m=(0,l.useContext)(ix);x&&!x.projection&&a&&("html"===x.type||"svg"===x.type)&&function(e,t,s,i){let{layoutId:a,layout:n,drag:r,dragConstraints:l,layoutScroll:o,layoutRoot:c}=t;e.projection=new s(e.latestValues,t["data-framer-portal-id"]?void 0:function e(t){if(t)return!1!==t.options.allowProjection?t.projection:e(t.parent)}(e.parent)),e.projection.setOptions({layoutId:a,layout:n,alwaysMeasureLayout:!!r||l&&sO(l),visualElement:e,animationType:"string"==typeof n?n:"both",initialPromotionConfig:i,layoutScroll:o,layoutRoot:c})}(u.current,s,a,m);let p=(0,l.useRef)(!1);(0,l.useInsertionEffect)(()=>{x&&p.current&&x.update(s,d)});let g=s[eg],f=(0,l.useRef)(!!g&&!(null===(n=window.MotionHandoffIsComplete)||void 0===n?void 0:n.call(window,g))&&(null===(r=window.MotionHasOptimisedAnimation)||void 0===r?void 0:r.call(window,g)));return aB(()=>{x&&(p.current=!0,window.MotionIsMounted=!0,x.updateFeatures(),iv.render(x.render),f.current&&x.animationState&&x.animationState.animateChanges())}),(0,l.useEffect)(()=>{x&&(!f.current&&x.animationState&&x.animationState.animateChanges(),f.current&&(queueMicrotask(()=>{var e;null===(e=window.MotionHandoffMarkAsComplete)||void 0===e||e.call(window,g)}),f.current=!1))}),x}(a,m,d,t,e.ProjectionNode)}return(0,r.jsxs)(aA.Provider,{value:x,children:[c&&x.visualElement?(0,r.jsx)(c,{visualElement:x.visualElement,...d}):null,s(a,e,(o=x.visualElement,(0,l.useCallback)(e=>{e&&m.onMount&&m.onMount(e),o&&(e?o.mount(e):o.unmount()),n&&("function"==typeof n?n(e):sO(n)&&(n.current=e))},[o])),m,u,x.visualElement)]})}e&&function(e){for(let t in e)aO[t]={...aO[t],...e[t]}}(e),c.displayName=`motion.${"string"==typeof a?a:`create(${null!==(o=null!==(n=a.displayName)&&void 0!==n?n:a.name)&&void 0!==o?o:""})`}`;let d=(0,l.forwardRef)(c);return d[aV]=a,d}({...aU(e)?a7:ne,preloadedFeatures:a,useRender:function(e=!1){return(t,s,i,{latestValues:a},n)=>{let r=(aU(t)?function(e,t,s,i){let a=(0,l.useMemo)(()=>{let s=a0();return aJ(s,t,a1(i),e.transformTemplate),{...s.attrs,style:{...s.style}}},[t]);if(e.style){let t={};nt(t,e.style,e),a.style={...t,...a.style}}return a}:function(e,t){let s={},i=function(e,t){let s=e.style||{},i={};return nt(i,s,e),Object.assign(i,function({transformTemplate:e},t){return(0,l.useMemo)(()=>{let s=aQ();return aG(s,t,e),Object.assign({},s.vars,s.style)},[t])}(e,t)),i}(e,t);return e.drag&&!1!==e.dragListener&&(s.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=!0===e.drag?"none":`pan-${"x"===e.drag?"y":"x"}`),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(s.tabIndex=0),s.style=i,s})(s,a,n,t),o=function(e,t,s){let i={};for(let a in e)("values"!==a||"object"!=typeof e.values)&&(na(a)||!0===s&&ni(a)||!t&&!ni(a)||e.draggable&&a.startsWith("onDrag"))&&(i[a]=e[a]);return i}(s,"string"==typeof t,e),c=t!==l.Fragment?{...o,...r,ref:i}:{},{children:d}=s,h=(0,l.useMemo)(()=>ex(d)?d.get():d,[d]);return(0,l.createElement)(t,{...c,children:h})}}(t),createVisualElement:n,Component:e})}));class ng extends l.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function nf({children:e,isPresent:t}){let s=(0,l.useId)(),i=(0,l.useRef)(null),a=(0,l.useRef)({width:0,height:0,top:0,left:0}),{nonce:n}=(0,l.useContext)(aD);return(0,l.useInsertionEffect)(()=>{let{width:e,height:r,top:l,left:o}=a.current;if(t||!i.current||!e||!r)return;i.current.dataset.motionPopId=s;let c=document.createElement("style");return n&&(c.nonce=n),document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${r}px !important;
            top: ${l}px !important;
            left: ${o}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[t]),(0,r.jsx)(ng,{isPresent:t,childRef:i,sizeRef:a,children:l.cloneElement(e,{ref:i})})}let ny=({children:e,initial:t,isPresent:s,onExitComplete:i,custom:a,presenceAffectsLayout:n,mode:o})=>{let c=a_(nv),d=(0,l.useId)(),h=(0,l.useCallback)(e=>{for(let t of(c.set(e,!0),c.values()))if(!t)return;i&&i()},[c,i]),u=(0,l.useMemo)(()=>({id:d,initial:t,isPresent:s,custom:a,onExitComplete:h,register:e=>(c.set(e,!1),()=>c.delete(e))}),n?[Math.random(),h]:[s,h]);return(0,l.useMemo)(()=>{c.forEach((e,t)=>c.set(t,!1))},[s]),l.useEffect(()=>{s||c.size||!i||i()},[s]),"popLayout"===o&&(e=(0,r.jsx)(nf,{isPresent:s,children:e})),(0,r.jsx)(id.Provider,{value:u,children:e})};function nv(){return new Map}let nb=e=>e.key||"";function nj(e){let t=[];return l.Children.forEach(e,e=>{(0,l.isValidElement)(e)&&t.push(e)}),t}let nw=({children:e,custom:t,initial:s=!0,onExitComplete:i,presenceAffectsLayout:a=!0,mode:n="sync",propagate:o=!1})=>{let[c,d]=ih(o),h=(0,l.useMemo)(()=>nj(e),[e]),u=o&&!c?[]:h.map(nb),x=(0,l.useRef)(!0),m=(0,l.useRef)(h),p=a_(()=>new Map),[g,f]=(0,l.useState)(h),[y,v]=(0,l.useState)(h);aB(()=>{x.current=!1,m.current=h;for(let e=0;e<y.length;e++){let t=nb(y[e]);u.includes(t)?p.delete(t):!0!==p.get(t)&&p.set(t,!1)}},[y,u.length,u.join("-")]);let b=[];if(h!==g){let e=[...h];for(let t=0;t<y.length;t++){let s=y[t],i=nb(s);u.includes(i)||(e.splice(t,0,s),b.push(s))}"wait"===n&&b.length&&(e=b),v(nj(e)),f(h);return}let{forceRender:j}=(0,l.useContext)(iu);return(0,r.jsx)(r.Fragment,{children:y.map(e=>{let l=nb(e),g=(!o||!!c)&&(h===y||u.includes(l));return(0,r.jsx)(ny,{isPresent:g,initial:(!x.current||!!s)&&void 0,custom:g?void 0:t,presenceAffectsLayout:a,mode:n,onExitComplete:g?void 0:()=>{if(!p.has(l))return;p.set(l,!0);let e=!0;p.forEach(t=>{t||(e=!1)}),e&&(null==j||j(),v(m.current),o&&(null==d||d()),i&&i())},children:e},l)})})};var nN=s(3634),nk=s(2881);let nS=(0,nk.Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),nC=(0,nk.Z)("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]),nR=(0,nk.Z)("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]),nT=(0,nk.Z)("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]),nP=(0,nk.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),nM=(0,nk.Z)("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]),nD=(0,nk.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),nA=(0,nk.Z)("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]),nE=(0,nk.Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var nF=s(434);function n$({correlationId:e,seed:t,policyVersion:s,policySignature:i,policyCacheHit:a,isPinned:n,simulatedLatency:l,actualLatency:o,authResult:c,authProbability:d,selectedRoute:h,selectionMethod:u,isRunning:x,isPaused:m,speedMode:p,onSpeedModeChange:g,onRun:f,onStep:y,onPause:v,onReplay:b,onNewSeed:j,onExportTrace:w,onExportAudit:N,extraActions:k}){let S={normal:"1x",fast:"4x",turbo:"MAX"},C=u?"FORCED"===u.type?`FORCED by ${u.ruleLabel}`:"AUTO optimizer":"";return(0,r.jsxs)("div",{className:"h-auto min-h-[64px] bg-void-light border-b border-neon-cyan/20 px-4 py-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx(nN.Z,{className:"w-6 h-6 text-neon-cyan"}),(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"font-display text-lg font-bold text-neon-cyan neon-text",children:"SwipeSmart"}),r.jsx("span",{className:"text-[10px] text-gray-500 font-mono",children:"Intelligent payment routing engine with deterministic replay"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsxs)("button",{onClick:f,disabled:x&&!m,className:"btn-primary px-2.5 py-1 rounded flex items-center gap-1 text-xs font-mono",children:[r.jsx(nS,{className:"w-3.5 h-3.5"})," Run"]}),(0,r.jsxs)("button",{onClick:y,disabled:x&&!m,className:"btn-primary px-2.5 py-1 rounded flex items-center gap-1 text-xs font-mono",children:[r.jsx(nC,{className:"w-3.5 h-3.5"})," Step"]}),(0,r.jsxs)("button",{onClick:v,disabled:!x,className:"btn-primary px-2.5 py-1 rounded flex items-center gap-1 text-xs font-mono",children:[r.jsx(nR,{className:"w-3.5 h-3.5"})," ",m?"Resume":"Pause"]}),r.jsx("div",{className:"w-px h-5 bg-gray-700 mx-1"}),(0,r.jsxs)("button",{onClick:b,className:"btn-primary px-2.5 py-1 rounded flex items-center gap-1 text-xs font-mono",children:[r.jsx(nT,{className:"w-3.5 h-3.5"})," Replay"]}),(0,r.jsxs)("button",{onClick:j,className:"btn-primary px-2.5 py-1 rounded flex items-center gap-1 text-xs font-mono",children:[r.jsx(nP,{className:"w-3.5 h-3.5"})," New Seed"]}),r.jsx("div",{className:"w-px h-5 bg-gray-700 mx-1"}),(0,r.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 rounded bg-void border border-gray-700",children:[r.jsx(nM,{className:`w-3.5 h-3.5 ${{normal:"text-gray-400",fast:"text-neon-cyan",turbo:"text-neon-green"}[p]}`}),["normal","fast","turbo"].map(e=>r.jsx("button",{onClick:()=>g(e),className:`px-1.5 py-0.5 rounded text-[10px] font-mono font-bold transition-all ${p===e?"turbo"===e?"bg-neon-green/20 text-neon-green border border-neon-green/50":"fast"===e?"bg-neon-cyan/20 text-neon-cyan border border-neon-cyan/50":"bg-gray-700 text-white border border-gray-600":"text-gray-500 hover:text-gray-300"}`,children:S[e]},e))]}),r.jsx("div",{className:"w-px h-5 bg-gray-700 mx-1"}),(0,r.jsxs)("button",{onClick:w,className:"btn-primary px-2.5 py-1 rounded flex items-center gap-1 text-xs font-mono",children:[r.jsx(nD,{className:"w-3.5 h-3.5"})," Trace"]}),(0,r.jsxs)("button",{onClick:N,className:"btn-primary px-2.5 py-1 rounded flex items-center gap-1 text-xs font-mono",children:[r.jsx(nA,{className:"w-3.5 h-3.5"})," Audit"]}),r.jsx("div",{className:"w-px h-5 bg-gray-700 mx-1"}),(0,r.jsxs)(nF.default,{href:"/about",className:"btn-primary px-2.5 py-1 rounded flex items-center gap-1 text-xs font-mono",children:[r.jsx(nE,{className:"w-3.5 h-3.5"})," About"]}),k&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"w-px h-5 bg-gray-700 mx-1"}),k]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5 mt-2 flex-wrap",children:[r.jsx(nI,{label:"correlation_id",value:e.slice(0,8)||""}),r.jsx(nI,{label:"seed",value:t.toString()}),r.jsx(nI,{label:"policy",value:`v${s}`,variant:n?"warning":"default"}),r.jsx(nI,{label:"cache",value:a?"HIT":"MISS",variant:a?"success":"default"}),r.jsx(nI,{label:"sig",value:i||"",mono:!0}),n&&r.jsx(nI,{label:"pinned",value:"",variant:"warning"}),r.jsx(nI,{label:"actual",value:`${o.toFixed(0)}ms`,variant:o>100?"warning":"success"}),r.jsx(nI,{label:"simulated",value:`${l}ms`,variant:l>400?"warning":"default"}),r.jsx(nI,{label:"auth",value:c||"",variant:"APPROVED"===c?"success":"DECLINED"===c?"error":"default"}),r.jsx(nI,{label:"P(decline)",value:`${(100*d).toFixed(1)}%`,variant:d>.3?"warning":"default"}),r.jsx(nI,{label:"route",value:h.slice(0,15)||"",variant:"success"}),r.jsx(nI,{label:"method",value:C,variant:u?.type==="FORCED"?"warning":"default"})]})]})}function nI({label:e,value:t,variant:s="default",mono:i=!1}){return(0,r.jsxs)(np.div,{className:`inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-mono border ${{default:"border-neon-cyan/30 text-neon-cyan",success:"border-neon-green/30 text-neon-green bg-neon-green/5",warning:"border-warn-amber/30 text-warn-amber bg-warn-amber/5",error:"border-error-red/30 text-error-red bg-error-red/5"}[s]}`,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},children:[(0,r.jsxs)("span",{className:"text-gray-500",children:[e,":"]}),r.jsx("span",{className:`font-semibold ${i?"tracking-tight":""}`,children:t})]})}let nL=(0,nk.Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var nO=s(9183),nV=s(8916);let nB=(0,nk.Z)("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]),nz={id:"user_demo_001",name:"Demo User",tokens:[{id:"token_chase_sapphire",name:"Chase Sapphire Preferred",dpan:"**** **** **** 4521",type:"credit",network:"visa",limit:1e4,balance:2500,utilization:.25,apr:21.99,ftf:0,blockedMCCs:[],rewardsByCategory:{dining:3,travel:2,streaming:2,default:1},isEligible:!0,cashbackRate:0,signupBonus:{threshold:4e3,current:2800,reward:6e4}},{id:"token_amex_gold",name:"Amex Gold",dpan:"**** **** **** 3782",type:"credit",network:"amex",limit:15e3,balance:4500,utilization:.3,apr:19.99,ftf:0,blockedMCCs:[5542,5541],rewardsByCategory:{dining:4,groceries:4,travel:3,default:1},isEligible:!0,cashbackRate:0},{id:"token_citi_double",name:"Citi Double Cash",dpan:"**** **** **** 8834",type:"credit",network:"mastercard",limit:8e3,balance:1200,utilization:.15,apr:18.99,ftf:3,blockedMCCs:[],rewardsByCategory:{default:2},isEligible:!0,cashbackRate:2},{id:"token_discover_it",name:"Discover It",dpan:"**** **** **** 6011",type:"credit",network:"discover",limit:5e3,balance:800,utilization:.16,apr:22.99,ftf:0,blockedMCCs:[],rewardsByCategory:{dining:5,groceries:5,gas:5,default:1},isEligible:!0,cashbackRate:1},{id:"token_debit_checking",name:"Chase Debit",dpan:"**** **** **** 9912",type:"debit",network:"visa",limit:0,balance:3500,utilization:0,apr:0,ftf:3,blockedMCCs:[],rewardsByCategory:{default:0},isEligible:!0,cashbackRate:0}],drtTokens:[{id:"drt_premium_wallet",name:"Premium Wallet DRT",dpan:"**** **** **** 0001",type:"drt",network:"visa",limit:0,balance:0,utilization:0,apr:0,ftf:0,blockedMCCs:[],rewardsByCategory:{},isEligible:!0,cashbackRate:0,routingStrategy:"optimal_score",childDPANs:[{id:"child_venture_x",name:"Capital One Venture X",dpan:"**** **** **** 7744",type:"credit",network:"visa",limit:2e4,balance:3e3,utilization:.15,apr:20.99,ftf:0,blockedMCCs:[],rewardsByCategory:{travel:10,dining:2,default:2},isEligible:!0,cashbackRate:0},{id:"child_freedom_flex",name:"Chase Freedom Flex",dpan:"**** **** **** 5566",type:"credit",network:"visa",limit:6e3,balance:900,utilization:.15,apr:19.99,ftf:3,blockedMCCs:[],rewardsByCategory:{dining:3,drugstores:3,default:1},isEligible:!0,cashbackRate:0},{id:"child_blue_cash",name:"Amex Blue Cash Preferred",dpan:"**** **** **** 2233",type:"credit",network:"amex",limit:12e3,balance:2400,utilization:.2,apr:17.99,ftf:2.7,blockedMCCs:[],rewardsByCategory:{groceries:6,streaming:6,gas:3,default:1},isEligible:!0,cashbackRate:0}]}],cashBalance:3500,daysToPaycheck:12,preferenceWeights:{rewards:.4,credit:.25,cashflow:.2,risk:.15},riskTolerance:"medium",defaultToken:"token_chase_sapphire"},nU=[{id:"rule_dining_premium",label:"Force Amex Gold for Dining",type:"HARD",priority:1,enabled:!0,condition:{field:"mcc",operator:"in",value:[5812,5814,5813]},action:{type:"FORCE",targetTokenId:"token_amex_gold",reason:"Amex Gold has 4x on dining (hard override)"},compiledDSL:"IF mcc IN [5812, 5814, 5813] THEN FORCE token_amex_gold"},{id:"rule_foreign_exclude_ftf",label:"Exclude FTF Cards Abroad",type:"HARD",priority:2,enabled:!0,condition:{field:"country",operator:"neq",value:"US"},action:{type:"EXCLUDE",targetTokenProperty:"ftf",targetPropertyValue:{gt:0},reason:"Foreign transaction fee applies"},compiledDSL:'IF country != "US" THEN EXCLUDE tokens WHERE ftf > 0'},{id:"rule_high_util_exclude",label:"Exclude High Utilization (>30%)",type:"SOFT",priority:3,enabled:!0,condition:{field:"projected_utilization",operator:"gt",value:.3},action:{type:"EXCLUDE",reason:"Projected utilization exceeds 30% threshold"},compiledDSL:"IF projected_utilization > 0.30 THEN EXCLUDE token"},{id:"rule_signup_bonus_boost",label:"Boost Signup Bonus Progress",type:"SOFT",priority:4,enabled:!0,condition:{field:"has_active_signup_bonus",operator:"eq",value:!0},action:{type:"BOOST",boostAmount:15,reason:"Active signup bonus in progress (+15 normalized)"},compiledDSL:"IF has_active_signup_bonus = true THEN BOOST +15"},{id:"rule_discover_acceptance",label:"Penalize Low-Acceptance Networks",type:"SOFT",priority:5,enabled:!0,condition:{field:"network_acceptance_risk",operator:"eq",value:"high"},action:{type:"PENALIZE",penaltyAmount:10,reason:"Network acceptance risk penalty (-10)"},compiledDSL:'IF network_acceptance_risk = "high" THEN PENALIZE -10'},{id:"rule_gas_station_block",label:"Exclude Amex at Gas Stations",type:"HARD",priority:6,enabled:!0,condition:{field:"mcc",operator:"in",value:[5541,5542]},action:{type:"EXCLUDE",targetTokenProperty:"network",targetPropertyValue:"amex",reason:"Amex blocked at gas pumps"},compiledDSL:'IF mcc IN [5541, 5542] THEN EXCLUDE WHERE network = "amex"'},{id:"rule_travel_boost",label:"Boost Travel Cards for Travel",type:"SOFT",priority:7,enabled:!0,condition:{field:"category",operator:"eq",value:"travel"},action:{type:"BOOST",boostAmount:8,targetTokenProperty:"rewardsByCategory.travel",targetPropertyValue:{gt:2},reason:"Travel category bonus (+8)"},compiledDSL:'IF category = "travel" THEN BOOST tokens WHERE travel > 2 BY +8'},{id:"rule_low_balance_debit",label:"Penalize Low Debit Balance",type:"SOFT",priority:8,enabled:!0,condition:{field:"debit_balance_low",operator:"eq",value:!0},action:{type:"PENALIZE",penaltyAmount:20,reason:"Insufficient debit buffer (-20)"},compiledDSL:"IF debit_balance < amount \xd7 2 THEN PENALIZE -20"}],n_=[{id:"scenario_dining_domestic",name:"\uD83C\uDF7D Domestic Dining",description:"Restaurant purchase in the US",expectedOutcome:"HARD RULE forces Amex Gold (4x dining). Optimizer would pick Discover It (5x) but rule overrides.",context:{amount:85.5,currency:"USD",merchant:"The Capital Grille",mcc:5812,category:"dining",country:"US",walletType:"apple_pay",isInPerson:!0,riskFlags:[]}},{id:"scenario_intl_travel",name:" International Travel",description:"Hotel booking abroad (France)",expectedOutcome:"Excludes Citi Double Cash (3% FTF) and Debit (3% FTF). Selects best no-FTF card by score.",context:{amount:450,currency:"EUR",merchant:"Hotel & Spa Paris",mcc:7011,category:"travel",country:"FR",walletType:"browser",isInPerson:!1,riskFlags:[]}},{id:"scenario_gas_station",name:" Gas Station",description:"Gas pump purchase",expectedOutcome:"HARD RULE excludes all Amex cards (blocked MCC). Selects Discover It (5x gas) or Citi.",context:{amount:62.3,currency:"USD",merchant:"Shell Gas Station",mcc:5541,category:"gas",country:"US",walletType:"google_pay",isInPerson:!0,riskFlags:[]}},{id:"scenario_grocery",name:"\uD83D\uDED2 Grocery Shopping",description:"Weekly grocery run at Whole Foods",expectedOutcome:"No hard override. Optimizer selects Amex Gold (4x groceries) or Discover It (5x groceries).",context:{amount:156.78,currency:"USD",merchant:"Whole Foods Market",mcc:5411,category:"groceries",country:"US",walletType:"apple_pay",isInPerson:!0,riskFlags:[]}},{id:"scenario_high_risk",name:" High Risk Online",description:"Large online purchase with multiple risk flags",expectedOutcome:"Risk score elevated (>0.5). May veto selection or increase decline probability significantly.",context:{amount:2500,currency:"USD",merchant:"Electronics Warehouse",mcc:5732,category:"electronics",country:"US",walletType:"browser",isInPerson:!1,riskFlags:["high_amount","new_merchant","velocity_spike"]}},{id:"scenario_signup_bonus",name:"\uD83C\uDFAF Signup Bonus Chase",description:"Purchase to hit Chase Sapphire bonus",expectedOutcome:"Signup bonus rule boosts Chase Sapphire (+15). May win over cards with higher base rewards.",context:{amount:350,currency:"USD",merchant:"Best Buy",mcc:5732,category:"electronics",country:"US",walletType:"samsung_pay",isInPerson:!0,riskFlags:[]}},{id:"scenario_streaming",name:"\uD83D\uDCFA Streaming Service",description:"Monthly streaming subscription renewal",expectedOutcome:"Optimizer picks card with best streaming rewards. Chase Sapphire (2x) or Blue Cash Preferred (6x).",context:{amount:15.99,currency:"USD",merchant:"Netflix",mcc:4899,category:"streaming",country:"US",walletType:"browser",isInPerson:!1,riskFlags:[]}},{id:"scenario_large_purchase",name:"\uD83D\uDC8E Large Purchase",description:"High-value electronics purchase testing utilization limits",expectedOutcome:"May exclude cards that would exceed 30% utilization threshold. Tests credit health scoring.",context:{amount:1899,currency:"USD",merchant:"Apple Store",mcc:5732,category:"electronics",country:"US",walletType:"apple_pay",isInPerson:!0,riskFlags:["high_amount"]}},{id:"scenario_drt_test",name:"\uD83D\uDD00 DRT Selection",description:"Tests Dynamic Routing Token child selection",expectedOutcome:"DRT resolves to best child card based on routing strategy (optimal_score picks highest scoring child).",context:{amount:275,currency:"USD",merchant:"Marriott Hotels",mcc:7011,category:"travel",country:"US",walletType:"browser",isInPerson:!1,riskFlags:[]}}],nZ=[{code:"US",name:"United States"},{code:"CA",name:"Canada"},{code:"GB",name:"United Kingdom"},{code:"FR",name:"France"},{code:"DE",name:"Germany"},{code:"JP",name:"Japan"},{code:"MX",name:"Mexico"}],nH=[{value:"apple_pay",label:"Apple Pay"},{value:"google_pay",label:"Google Pay"},{value:"samsung_pay",label:"Samsung Pay"},{value:"browser",label:"Browser/Online"}],nW=["high_amount","new_merchant","velocity_spike","geo_anomaly","time_anomaly","device_change","card_not_present"];function nq({context:e,user:t,selectedScenario:s,onContextChange:i,onUserChange:a,onScenarioSelect:n}){let[o,c]=(0,l.useState)({scenario:!0,transaction:!0,userState:!1,tokens:!1}),d=e=>{c(t=>({...t,[e]:!t[e]}))};return(0,r.jsxs)("div",{className:"h-full overflow-y-auto p-3 space-y-3",children:[r.jsx(nG,{title:"Scenario",expanded:o.scenario,onToggle:()=>d("scenario"),children:(0,r.jsxs)("div",{className:"grid gap-2",children:[n_.map(e=>(0,r.jsxs)("button",{onClick:()=>n(e.id),className:`text-left p-2 rounded border transition-all ${s===e.id?"border-neon-cyan bg-neon-cyan/10":"border-gray-700 hover:border-gray-600"}`,children:[r.jsx("div",{className:"text-sm font-medium text-gray-200",children:e.name}),r.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:e.description}),s===e.id&&e.expectedOutcome&&(0,r.jsxs)("div",{className:"text-[10px] text-neon-green/80 mt-1 p-1.5 bg-neon-green/5 rounded border border-neon-green/20",children:[r.jsx("span",{className:"font-semibold",children:"Expected:"})," ",e.expectedOutcome]})]},e.id)),(0,r.jsxs)("button",{onClick:()=>n("custom"),className:`text-left p-2 rounded border transition-all ${"custom"===s?"border-neon-purple bg-neon-purple/10":"border-gray-700 hover:border-gray-600"}`,children:[r.jsx("div",{className:"text-sm font-medium text-neon-purple",children:"Custom"}),r.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"Define your own transaction"})]})]})}),r.jsx(nG,{title:"Transaction Context",expanded:o.transaction,onToggle:()=>d("transaction"),children:(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx(nX,{label:"Amount",children:r.jsx("input",{type:"number",value:e.amount,onChange:t=>i({...e,amount:parseFloat(t.target.value)||0}),className:"input-field w-full px-2 py-1 rounded text-sm"})}),r.jsx(nX,{label:"Merchant",children:r.jsx("input",{type:"text",value:e.merchant,onChange:t=>i({...e,merchant:t.target.value}),className:"input-field w-full px-2 py-1 rounded text-sm"})}),r.jsx(nX,{label:"MCC",children:r.jsx("input",{type:"number",value:e.mcc,onChange:t=>i({...e,mcc:parseInt(t.target.value)||0}),className:"input-field w-full px-2 py-1 rounded text-sm"})}),r.jsx(nX,{label:"Category",children:(0,r.jsxs)("select",{value:e.category,onChange:t=>i({...e,category:t.target.value}),className:"input-field w-full px-2 py-1 rounded text-sm",children:[r.jsx("option",{value:"dining",children:"Dining"}),r.jsx("option",{value:"travel",children:"Travel"}),r.jsx("option",{value:"groceries",children:"Groceries"}),r.jsx("option",{value:"gas",children:"Gas"}),r.jsx("option",{value:"electronics",children:"Electronics"}),r.jsx("option",{value:"retail",children:"Retail"}),r.jsx("option",{value:"other",children:"Other"})]})}),r.jsx(nX,{label:"Country",children:r.jsx("select",{value:e.country,onChange:t=>i({...e,country:t.target.value}),className:"input-field w-full px-2 py-1 rounded text-sm",children:nZ.map(e=>r.jsx("option",{value:e.code,children:e.name},e.code))})}),r.jsx(nX,{label:"Wallet",children:r.jsx("select",{value:e.walletType,onChange:t=>i({...e,walletType:t.target.value}),className:"input-field w-full px-2 py-1 rounded text-sm",children:nH.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))})}),r.jsx(nX,{label:"In-Person",children:(0,r.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:e.isInPerson,onChange:t=>i({...e,isInPerson:t.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-void-light"}),r.jsx("span",{className:"text-sm text-gray-400",children:e.isInPerson?"Yes":"No"})]})}),r.jsx(nX,{label:"Risk Flags",children:r.jsx("div",{className:"flex flex-wrap gap-1",children:nW.map(t=>r.jsx("button",{onClick:()=>{let s=e.riskFlags.includes(t)?e.riskFlags.filter(e=>e!==t):[...e.riskFlags,t];i({...e,riskFlags:s})},className:`px-2 py-0.5 text-xs rounded transition-all ${e.riskFlags.includes(t)?"bg-error-red/20 border border-error-red/50 text-error-red":"bg-void border border-gray-700 text-gray-500 hover:border-gray-600"}`,children:t},t))})})]})}),r.jsx(nG,{title:"User State",expanded:o.userState,onToggle:()=>d("userState"),children:(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx(nX,{label:"Cash Balance",children:r.jsx("input",{type:"number",value:t.cashBalance,onChange:e=>a({...t,cashBalance:parseFloat(e.target.value)||0}),className:"input-field w-full px-2 py-1 rounded text-sm"})}),r.jsx(nX,{label:"Days to Paycheck",children:r.jsx("input",{type:"number",value:t.daysToPaycheck,onChange:e=>a({...t,daysToPaycheck:parseInt(e.target.value)||0}),className:"input-field w-full px-2 py-1 rounded text-sm"})}),(0,r.jsxs)("div",{className:"pt-2 border-t border-gray-800",children:[r.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Preference Weights"}),r.jsx(nK,{label:"Rewards",value:t.preferenceWeights.rewards,onChange:e=>a({...t,preferenceWeights:{...t.preferenceWeights,rewards:e}}),color:"neon-green"}),r.jsx(nK,{label:"Credit",value:t.preferenceWeights.credit,onChange:e=>a({...t,preferenceWeights:{...t.preferenceWeights,credit:e}}),color:"neon-cyan"}),r.jsx(nK,{label:"Cashflow",value:t.preferenceWeights.cashflow,onChange:e=>a({...t,preferenceWeights:{...t.preferenceWeights,cashflow:e}}),color:"neon-orange"}),r.jsx(nK,{label:"Risk",value:t.preferenceWeights.risk,onChange:e=>a({...t,preferenceWeights:{...t.preferenceWeights,risk:e}}),color:"neon-pink"})]})]})}),r.jsx(nG,{title:"Token Manager",expanded:o.tokens,onToggle:()=>d("tokens"),badge:`${t.tokens.length} cards + ${t.drtTokens.length} DRT`,children:(0,r.jsxs)("div",{className:"space-y-2",children:[t.tokens.map(e=>r.jsx(nY,{token:e,onToggle:()=>{let s=t.tokens.map(t=>t.id===e.id?{...t,isEligible:!t.isEligible}:t);a({...t,tokens:s})},onEdit:()=>{}},e.id)),t.drtTokens.map(e=>r.jsx(nJ,{drt:e,onToggle:()=>{let s=t.drtTokens.map(t=>t.id===e.id?{...t,isEligible:!t.isEligible}:t);a({...t,drtTokens:s})}},e.id))]})})]})}function nG({title:e,expanded:t,onToggle:s,badge:i,children:a}){return(0,r.jsxs)("div",{className:"panel rounded-lg overflow-hidden",children:[(0,r.jsxs)("button",{onClick:s,className:"w-full panel-header px-3 py-2 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[t?r.jsx(nL,{className:"w-4 h-4 text-neon-cyan"}):r.jsx(nO.Z,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"text-sm font-medium",children:e})]}),i&&r.jsx("span",{className:"text-xs text-gray-500 font-mono",children:i})]}),r.jsx(nw,{children:t&&r.jsx(np.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:r.jsx("div",{className:"p-3 border-t border-gray-800/50",children:a})})})]})}function nX({label:e,children:t}){return(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("label",{className:"text-xs text-gray-500 w-24 shrink-0",children:e}),r.jsx("div",{className:"flex-1",children:t})]})}function nK({label:e,value:t,onChange:s,color:i}){return(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("span",{className:"text-xs text-gray-500 w-16",children:e}),r.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:t,onChange:e=>s(parseFloat(e.target.value)),className:"flex-1 h-1 bg-gray-700 rounded appearance-none cursor-pointer",style:{accentColor:`var(--${i})`}}),(0,r.jsxs)("span",{className:"text-xs font-mono text-gray-400 w-8",children:[(100*t).toFixed(0),"%"]})]})}function nY({token:e,onToggle:t,onEdit:s}){return(0,r.jsxs)("div",{className:`p-2 rounded border transition-all ${e.isEligible?"border-gray-700 bg-void-light/50":"border-gray-800 bg-void opacity-50"}`,children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(nV.Z,{className:`w-4 h-4 ${{visa:"text-blue-400",mastercard:"text-orange-400",amex:"text-cyan-400",discover:"text-amber-400"}[e.network]||"text-gray-400"}`}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-medium truncate",children:e.name}),r.jsx("div",{className:"text-xs text-gray-500 font-mono",children:e.dpan})]}),r.jsx("button",{onClick:t,className:`w-8 h-4 rounded-full transition-all ${e.isEligible?"bg-neon-green/30":"bg-gray-700"}`,children:r.jsx("div",{className:`w-3 h-3 rounded-full bg-white transition-all ${e.isEligible?"ml-4":"ml-0.5"}`})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 mt-1.5 text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:["Util: ",(100*e.utilization).toFixed(0),"%"]}),(0,r.jsxs)("span",{children:["Limit: $",e.limit.toLocaleString()]}),e.ftf>0&&(0,r.jsxs)("span",{className:"text-warn-amber",children:["FTF: ",e.ftf,"%"]})]})]})}function nJ({drt:e,onToggle:t}){return(0,r.jsxs)("div",{className:`p-2 rounded border transition-all ${e.isEligible?"border-neon-purple/50 bg-neon-purple/5":"border-gray-800 bg-void opacity-50"}`,children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(nB,{className:"w-4 h-4 text-neon-purple"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-medium truncate text-neon-purple",children:e.name}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[e.childDPANs.length," child DPANs"]})]}),r.jsx("button",{onClick:t,className:`w-8 h-4 rounded-full transition-all ${e.isEligible?"bg-neon-purple/30":"bg-gray-700"}`,children:r.jsx("div",{className:`w-3 h-3 rounded-full bg-white transition-all ${e.isEligible?"ml-4":"ml-0.5"}`})})]}),r.jsx("div",{className:"mt-2 pl-4 border-l border-neon-purple/30 space-y-1",children:e.childDPANs.map(e=>(0,r.jsxs)("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[r.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-neon-purple/50"}),e.name]},e.id))})]})}let nQ=(0,nk.Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),n0=(0,nk.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var n1=s(949),n2=s(8998);let n5=["Ingest Event","Context Extraction","Profile Fetch","Policy Load (Registry)","Rule Compile","Rule Evaluation","Candidate Filtering","Optimization Scoring","Route Selection","DRT Resolution","DPAN Swap / Injection","Authorization Gateway","Audit Record Emit"],n3={"Ingest Event":[2,6],"Context Extraction":[6,12],"Profile Fetch":[10,25],"Policy Load (Registry)":[14,30],"Rule Compile":[8,16],"Rule Evaluation":[4,10],"Candidate Filtering":[6,14],"Optimization Scoring":[18,45],"Route Selection":[3,8],"DRT Resolution":[5,12],"DPAN Swap / Injection":[7,15],"Authorization Gateway":[80,220],"Audit Record Emit":[4,10]},n4={rewards:{name:"Rewards Score",short:"RWD",description:"Expected reward value for this transaction based on category multipliers, caps, and point valuation.",formula:"min(100, categoryRate \xd7 baseValue + signupBonus)"},credit:{name:"Credit Health Score",short:"CRD",description:"Projected credit utilization impact. Penalizes cards approaching limits.",formula:"100 \xd7 (1 - projectedUtilization) with threshold penalties"},cashflow:{name:"Cash Flow Score",short:"CSH",description:"Carry cost proxy based on APR and days to paycheck.",formula:"Balance buffer ratio \xd7 paycheck timing factor"},risk:{name:"Risk Score",short:"RSK",description:"Decline probability (0-1). May veto unless hard-rule forced.",formula:"(risk factors) normalized to 0-1"}};function n8({stageResults:e,currentStageIndex:t,isRunning:s}){let[i,a]=(0,l.useState)(new Set),n=e=>{a(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},o=e.reduce((e,t)=>e+t.durationMs,0);return(0,r.jsxs)("div",{className:"h-full flex flex-col",children:[(0,r.jsxs)("div",{className:"panel-header px-4 py-3 flex items-center justify-between border-b border-neon-cyan/20",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:`status-dot ${s?"active":e.length>0?"success":""}`}),r.jsx("span",{className:"font-mono text-sm",children:"Pipeline Execution"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-xs font-mono text-gray-500",children:[(0,r.jsxs)("span",{children:["Stages: ",e.length,"/",n5.length]}),(0,r.jsxs)("span",{children:["Total: ",o,"ms"]})]})]}),r.jsx("div",{className:"h-1 bg-void-lighter",children:r.jsx(np.div,{className:"h-full bg-gradient-to-r from-neon-cyan to-neon-green",initial:{width:0},animate:{width:`${e.length/n5.length*100}%`},transition:{duration:.3}})}),r.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-1",children:n5.map((a,l)=>{let o=e.find(e=>e.stageIndex===l),c=s&&t===l,d=i.has(l);return r.jsx(n6,{index:l,name:a,result:o,isActive:c,isPending:!o&&!c,isExpanded:d,onToggle:()=>n(l)},l)})})]})}function n6({index:e,name:t,result:s,isActive:i,isPending:a,isExpanded:n,onToggle:l}){let o=s?.status||(i?"active":"pending"),c=function(e){switch(e){case"completed":return nQ;case"error":return n0;case"warning":return n1.Z;case"skipped":return nC;default:return n2.Z}}(o),d=function(e){switch(e){case"completed":return"neon-green";case"error":return"error-red";case"warning":return"warn-amber";case"skipped":return"gray-500";case"active":return"neon-cyan";default:return"gray-600"}}(o);return(0,r.jsxs)(np.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.02*e},className:`stage-card rounded overflow-hidden ${o}`,children:[(0,r.jsxs)("button",{onClick:l,disabled:a,className:"w-full px-3 py-2 flex items-center gap-3 text-left",children:[r.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${a?"bg-gray-800 text-gray-600":`bg-${d}/20 text-${d}`}`,children:e+1}),r.jsx(c,{className:`w-4 h-4 ${a?"text-gray-600":`text-${d}`} ${i?"animate-pulse":""}`}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:`text-sm font-medium truncate ${a?"text-gray-600":"text-gray-200"}`,children:t}),s&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-0.5",children:[(0,r.jsxs)("span",{className:"text-xs text-gray-500 font-mono",children:[s.durationMs,"ms"]}),s.warning&&(0,r.jsxs)("span",{className:"text-xs text-warn-amber",children:[" ",s.warning.slice(0,30)]})]})]}),s&&r.jsx("div",{className:"text-gray-500",children:n?r.jsx(nL,{className:"w-4 h-4"}):r.jsx(nO.Z,{className:"w-4 h-4"})})]}),r.jsx(nw,{children:n&&s&&r.jsx(np.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,r.jsxs)("div",{className:"px-3 pb-3 border-t border-gray-800/50",children:[(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2 py-2 text-xs",children:[(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-gray-500",children:"Start:"}),(0,r.jsxs)("span",{className:"ml-1 font-mono text-gray-400",children:["t+",s.startTime-(s.startTime-s.durationMs),"ms"]})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-gray-500",children:"End:"}),(0,r.jsxs)("span",{className:"ml-1 font-mono text-gray-400",children:["t+",s.endTime-(s.startTime-s.durationMs),"ms"]})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-gray-500",children:"Duration:"}),(0,r.jsxs)("span",{className:"ml-1 font-mono text-neon-cyan",children:[s.durationMs,"ms"]})]})]}),(0,r.jsxs)("div",{className:"mt-2",children:[r.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Inputs"}),r.jsx("div",{className:"json-viewer max-h-32 overflow-auto",children:r.jsx(n9,{data:s.inputs})})]}),(0,r.jsxs)("div",{className:"mt-2",children:[r.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Outputs"}),r.jsx("div",{className:"json-viewer max-h-32 overflow-auto",children:r.jsx(n9,{data:s.outputs})})]}),s.logs.length>0&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:["Logs (",s.logs.length,")"]}),r.jsx("div",{className:"space-y-0.5 max-h-24 overflow-auto",children:s.logs.map((e,t)=>(0,r.jsxs)("div",{className:`log-entry ${e.level}`,children:[(0,r.jsxs)("span",{className:"text-gray-500",children:["t+",e.offsetMs,"ms"]}),r.jsx("span",{className:"mx-1.5",children:"|"}),r.jsx("span",{className:`uppercase text-xs ${"error"===e.level?"text-error-red":"warn"===e.level?"text-warn-amber":"debug"===e.level?"text-gray-500":"text-neon-cyan"}`,children:e.level}),r.jsx("span",{className:"mx-1.5",children:"|"}),r.jsx("span",{children:e.message})]},t))})]})]})})})]})}function n9({data:e}){let t=(e,s=0)=>{if(null===e)return r.jsx("span",{className:"json-null",children:"null"});if(void 0===e)return r.jsx("span",{className:"json-null",children:"undefined"});if("boolean"==typeof e)return r.jsx("span",{className:"json-boolean",children:e.toString()});if("number"==typeof e)return r.jsx("span",{className:"json-number",children:e});if("string"==typeof e)return(0,r.jsxs)("span",{className:"json-string",children:['"',e.length>50?e.slice(0,50)+"...":e,'"']});if(Array.isArray(e))return 0===e.length?"[]":e.length>5?(0,r.jsxs)("span",{children:["[",e.slice(0,3).map((e,s)=>(0,r.jsxs)("span",{children:[t(e),s<2?", ":""]},s)),"... +",e.length-3," more]"]}):(0,r.jsxs)("span",{children:["[",e.map((s,i)=>(0,r.jsxs)("span",{children:[t(s),i<e.length-1?", ":""]},i)),"]"]});if("object"==typeof e){let i=Object.entries(e);return 0===i.length?"{}":(0,r.jsxs)("div",{style:{marginLeft:8*s},children:["{",i.slice(0,6).map(([e,a],n)=>(0,r.jsxs)("div",{style:{marginLeft:8},children:[r.jsx("span",{className:"json-key",children:e}),": ",t(a,s+1),n<Math.min(i.length-1,5)?",":""]},e)),i.length>6&&(0,r.jsxs)("div",{style:{marginLeft:8},className:"text-gray-500",children:["... +",i.length-6," more"]}),"}"]})}return String(e)};return r.jsx(r.Fragment,{children:t(e)})}let n7=(0,nk.Z)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),re=(0,nk.Z)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),rt=(0,nk.Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),rs=(0,nk.Z)("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),ri=(0,nk.Z)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);var ra=s(165);function rn({trace:e,auditRecord:t,logs:s,sensitivity:i}){let[a,n]=(0,l.useState)("scoring"),o=t?.errors?.length||0,c=[{id:"scoring",label:"Scoring",icon:n7},{id:"trace",label:"Trace",icon:re},{id:"logs",label:"Logs",icon:rt},{id:"explainer",label:"Explainer",icon:rs},{id:"errors",label:"Errors",icon:n1.Z,badge:o},{id:"audit",label:"Audit",icon:nA}];return(0,r.jsxs)("div",{className:"h-full flex flex-col",children:[r.jsx("div",{className:"flex border-b border-gray-800 overflow-x-auto",children:c.map(e=>(0,r.jsxs)("button",{onClick:()=>n(e.id),className:`tab-button flex items-center gap-1 whitespace-nowrap ${a===e.id?"active":""}`,children:[r.jsx(e.icon,{className:"w-3 h-3"}),e.label,void 0!==e.badge&&e.badge>0&&r.jsx("span",{className:"ml-1 px-1 py-0.5 text-[9px] bg-error-red/20 text-error-red rounded",children:e.badge})]},e.id))}),(0,r.jsxs)("div",{className:"flex-1 overflow-hidden",children:["scoring"===a&&r.jsx(rr,{auditRecord:t,sensitivity:i}),"trace"===a&&r.jsx(ro,{trace:e}),"logs"===a&&r.jsx(rc,{logs:s}),"explainer"===a&&r.jsx(rd,{auditRecord:t}),"errors"===a&&r.jsx(rh,{auditRecord:t}),"audit"===a&&r.jsx(ru,{auditRecord:t})]})]})}function rr({auditRecord:e,sensitivity:t}){let[s,i]=(0,l.useState)(null),[a,n]=(0,l.useState)(!1);if(!e)return r.jsx(rx,{icon:n7,text:"Run pipeline to see scoring model"});let o=e.weightsUsed,c=e.candidateScores.sort((e,t)=>t.finalScore-e.finalScore),d=t.filter(e=>e.winnerChanged);return(0,r.jsxs)("div",{className:"h-full overflow-y-auto p-3 space-y-4",children:[(0,r.jsxs)("div",{className:"p-3 bg-void-light rounded border border-gray-800",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-xs font-semibold text-gray-300",children:"Scoring Model"}),(0,r.jsxs)("button",{onClick:()=>n(!a),className:"text-[10px] text-neon-cyan flex items-center gap-1",children:[r.jsx(nE,{className:"w-3 h-3"})," What does this mean?"]})]}),(0,r.jsxs)("div",{className:"font-mono text-[10px] text-gray-400 bg-black/30 p-2 rounded mb-2",children:["TotalScore = (weight",r.jsx("sub",{children:"i"})," \xd7 subscore",r.jsx("sub",{children:"i"}),") + bonuses  penalties"]}),r.jsx("div",{className:"grid grid-cols-4 gap-2 text-[10px]",children:["rewards","credit","cashflow","risk"].map(e=>(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"text-gray-500",children:n4[e].short}),(0,r.jsxs)("div",{className:"font-mono font-bold text-neon-cyan",children:[(100*o[e]).toFixed(0),"%"]})]},e))}),r.jsx(nw,{children:a&&r.jsx(np.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0},className:"overflow-hidden",children:r.jsx("div",{className:"mt-3 pt-3 border-t border-gray-800 space-y-2",children:["rewards","credit","cashflow","risk"].map(e=>(0,r.jsxs)("div",{className:"text-[10px]",children:[(0,r.jsxs)("span",{className:"font-semibold text-gray-300",children:[n4[e].name,":"]}),r.jsx("span",{className:"text-gray-500 ml-1",children:n4[e].description})]},e))})})})]}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Top Candidates (normalized 0-100)"}),r.jsx("div",{className:"space-y-1",children:c.slice(0,5).map((e,t)=>r.jsx(rl,{score:e,rank:t+1,isWinner:0===t,isExpanded:s===e.tokenId,onToggle:()=>i(s===e.tokenId?null:e.tokenId),weights:o},e.tokenId))})]}),d.length>0&&(0,r.jsxs)("div",{className:"p-2 bg-warn-amber/10 border border-warn-amber/30 rounded",children:[(0,r.jsxs)("div",{className:"text-[10px] font-semibold text-warn-amber mb-1 flex items-center gap-1",children:[r.jsx(n1.Z,{className:"w-3 h-3"})," Sensitivity Alert"]}),(0,r.jsxs)("div",{className:"text-[10px] text-gray-400",children:["Winner changes with \xb110% weight adjustment:",d.slice(0,2).map(e=>(0,r.jsxs)("div",{className:"ml-2",children:[" ",e.criterion," ",e.direction,": ",e.originalWinner.slice(6,18),"  ",e.newWinner.slice(6,18)]},`${e.criterion}-${e.direction}`))]})]})]})}function rl({score:e,rank:t,isWinner:s,isExpanded:i,onToggle:a,weights:n}){return(0,r.jsxs)("div",{className:`rounded border ${s?"border-neon-green/40 bg-neon-green/5":"border-gray-800"}`,children:[(0,r.jsxs)("button",{onClick:a,className:"w-full p-2 flex items-center gap-2 text-left",children:[r.jsx("span",{className:`w-5 h-5 rounded-full flex items-center justify-center text-[10px] font-bold ${s?"bg-neon-green/20 text-neon-green":"bg-gray-800 text-gray-500"}`,children:t}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-xs font-medium truncate",children:e.tokenName}),r.jsx("div",{className:"text-[10px] text-gray-500 font-mono",children:e.tokenId.slice(0,20)})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("div",{className:"text-sm font-bold font-mono",children:e.finalScore.toFixed(1)}),r.jsx("div",{className:"text-[9px] text-gray-500",children:"/100"})]}),i?r.jsx(nL,{className:"w-3 h-3 text-gray-500"}):r.jsx(nO.Z,{className:"w-3 h-3 text-gray-500"})]}),r.jsx(nw,{children:i&&r.jsx(np.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0},className:"overflow-hidden",children:(0,r.jsxs)("div",{className:"px-2 pb-2 border-t border-gray-800/50 pt-2 space-y-2",children:[r.jsx("div",{className:"text-[10px] text-gray-500 mb-1",children:"Subscore Breakdown"}),["rewards","credit","cashflow","risk"].map(t=>{let s=e.subscores[t];return(0,r.jsxs)("div",{className:"flex items-center gap-2 text-[10px]",children:[r.jsx("span",{className:"w-12 text-gray-500",children:n4[t].short}),r.jsx("div",{className:"flex-1 h-1.5 bg-gray-800 rounded overflow-hidden",children:r.jsx("div",{className:"h-full bg-neon-cyan/50",style:{width:`${s.normalized}%`}})}),r.jsx("span",{className:"w-8 text-right font-mono",children:s.normalized.toFixed(0)}),r.jsx("span",{className:"text-gray-600",children:"\xd7"}),(0,r.jsxs)("span",{className:"w-8 font-mono text-gray-400",children:[(100*s.weight).toFixed(0),"%"]}),r.jsx("span",{className:"text-gray-600",children:"="}),r.jsx("span",{className:"w-8 text-right font-mono text-neon-cyan",children:s.weighted.toFixed(1)})]},t)}),(0,r.jsxs)("div",{className:"flex justify-between text-[10px] pt-1 border-t border-gray-800/50",children:[r.jsx("span",{className:"text-gray-500",children:"Base Score"}),r.jsx("span",{className:"font-mono",children:e.baseScore.toFixed(1)})]}),e.bonuses.length>0&&e.bonuses.map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between text-[10px] text-neon-green",children:[(0,r.jsxs)("span",{children:["+ ",e.label]}),(0,r.jsxs)("span",{className:"font-mono",children:["+",e.amount]})]},t)),e.penalties.length>0&&e.penalties.map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between text-[10px] text-error-red",children:[(0,r.jsxs)("span",{children:[" ",e.label]}),(0,r.jsxs)("span",{className:"font-mono",children:["",e.amount]})]},t)),(0,r.jsxs)("div",{className:"flex justify-between text-xs font-bold pt-1 border-t border-gray-800",children:[r.jsx("span",{children:"Final Score"}),(0,r.jsxs)("span",{className:"font-mono text-neon-cyan",children:[e.finalScore.toFixed(1),"/100"]})]}),r.jsx("div",{className:"text-[9px] text-gray-600 mt-1",children:e.subscores.rewards.factors.slice(0,2).map((e,t)=>(0,r.jsxs)("div",{children:[" ",e]},t))})]})})})]})}function ro({trace:e}){return e?(0,r.jsxs)("div",{className:"h-full overflow-y-auto p-3",children:[(0,r.jsxs)("div",{className:"mb-3 p-2 bg-void-light rounded border border-gray-800 grid grid-cols-2 gap-2 text-[10px]",children:[(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-gray-500",children:"Trace ID:"})," ",(0,r.jsxs)("span",{className:"font-mono text-neon-cyan",children:[e.traceId.slice(0,12),"..."]})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-gray-500",children:"Seed:"})," ",r.jsx("span",{className:"font-mono text-neon-green",children:e.seed})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-gray-500",children:"Duration:"})," ",(0,r.jsxs)("span",{className:"font-mono text-neon-orange",children:[e.totalDurationMs,"ms"]})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-gray-500",children:"Spans:"})," ",r.jsx("span",{className:"font-mono",children:e.spans.length})]})]}),r.jsx("div",{className:"space-y-1",children:e.spans.map((t,s)=>{let i=Math.max(2,t.durationMs/e.totalDurationMs*100),a=t.startOffset/e.totalDurationMs*100,n="completed"===t.status?"bg-neon-green":"error"===t.status?"bg-error-red":"skipped"===t.status?"bg-gray-600":"bg-neon-cyan";return(0,r.jsxs)(np.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.02*s},className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-28 text-[10px] text-gray-400 truncate",children:t.operationName}),(0,r.jsxs)("div",{className:"flex-1 h-4 bg-void-lighter rounded relative",children:[r.jsx("div",{className:`absolute h-full ${n} rounded opacity-70`,style:{left:`${a}%`,width:`${i}%`}}),(0,r.jsxs)("span",{className:"absolute inset-0 flex items-center justify-center text-[9px] font-mono text-white/70",children:[t.durationMs,"ms"]})]}),(0,r.jsxs)("div",{className:"w-16 text-[10px] text-gray-500 font-mono",children:["t+",t.startOffset,"",t.endOffset]})]},t.spanId)})})]}):r.jsx(rx,{icon:re,text:"Run pipeline to see trace"})}function rc({logs:e}){let[t,s]=(0,l.useState)("decision"),i=e[t];return(0,r.jsxs)("div",{className:"h-full flex flex-col",children:[r.jsx("div",{className:"flex gap-1 p-2 border-b border-gray-800",children:["decision","policy","risk"].map(i=>(0,r.jsxs)("button",{onClick:()=>s(i),className:`px-2 py-1 text-[10px] rounded ${t===i?"bg-neon-cyan/20 text-neon-cyan":"text-gray-500"}`,children:[i," (",e[i].length,")"]},i))}),r.jsx("div",{className:"flex-1 overflow-y-auto p-2 font-mono text-[10px] space-y-0.5",children:0===i.length?r.jsx("div",{className:"text-gray-500 text-center py-4",children:"No logs"}):i.map((e,t)=>(0,r.jsxs)("div",{className:`log-entry ${e.level}`,children:[(0,r.jsxs)("span",{className:"text-gray-600",children:["t+",e.offsetMs.toString().padStart(3),"ms"]}),r.jsx("span",{className:"mx-1 text-gray-700",children:""}),r.jsx("span",{className:"error"===e.level?"text-error-red":"warn"===e.level?"text-warn-amber":"text-neon-cyan",children:e.level.slice(0,4).toUpperCase()}),r.jsx("span",{className:"mx-1 text-gray-700",children:""}),r.jsx("span",{children:e.message})]},t))})]})}function rd({auditRecord:e}){return e?(0,r.jsxs)("div",{className:"h-full overflow-y-auto p-3 space-y-3",children:[(0,r.jsxs)("div",{className:"p-3 bg-neon-green/10 border border-neon-green/30 rounded",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(ri,{className:"w-4 h-4 text-neon-green"}),r.jsx("span",{className:"text-xs font-semibold text-neon-green",children:"Selected Route"})]}),r.jsx("div",{className:"font-mono text-sm",children:e.selectedRouteName}),(0,r.jsxs)("div",{className:"text-[10px] text-gray-500",children:["DPAN: ",e.selectedDpan]}),(0,r.jsxs)("div",{className:"text-[10px] mt-1",children:["Method: ",r.jsx("span",{className:"FORCED"===e.selectionMethod.type?"text-warn-amber":"text-neon-cyan",children:"FORCED"===e.selectionMethod.type?`FORCED by ${e.selectionMethod.ruleLabel}`:"AUTO optimizer"})]})]}),e.shadowOptimization&&(0,r.jsxs)("div",{className:"p-2 bg-neon-purple/10 border border-neon-purple/30 rounded text-[10px]",children:[r.jsx("div",{className:"font-semibold text-neon-purple mb-1",children:"Shadow Winner (optimizer)"}),(0,r.jsxs)("div",{children:["Would have selected: ",r.jsx("span",{className:"font-mono",children:e.shadowOptimization.wouldHaveSelectedName})]}),(0,r.jsxs)("div",{children:["Score: ",e.shadowOptimization.wouldHaveScore.toFixed(1)," vs ",e.shadowOptimization.actualScore.toFixed(1)]})]}),e.violationsOverridden.length>0&&(0,r.jsxs)("div",{className:"p-2 bg-warn-amber/10 border border-warn-amber/30 rounded",children:[(0,r.jsxs)("div",{className:"text-[10px] font-semibold text-warn-amber mb-1 flex items-center gap-1",children:[r.jsx(ra.Z,{className:"w-3 h-3"})," Violations Overridden (",e.violationsOverridden.length,")"]}),e.violationsOverridden.map((e,t)=>(0,r.jsxs)("div",{className:"text-[10px] text-gray-400",children:[" ",e.tokenName,": ",e.constraint," (by ",e.overriddenBy,")"]},t))]}),e.excludedTokens.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"text-[10px] text-gray-500 mb-1 flex items-center gap-1",children:[r.jsx(n0,{className:"w-3 h-3"})," Excluded Tokens (",e.excludedTokens.length,")"]}),e.excludedTokens.map((e,t)=>(0,r.jsxs)("div",{className:"text-[10px] flex gap-2",children:[r.jsx("span",{className:"font-mono text-gray-500",children:e.tokenName}),(0,r.jsxs)("span",{className:"text-error-red/70",children:[" ",e.reason]}),(0,r.jsxs)("span",{className:"text-gray-600",children:["@",e.stage]})]},t))]}),r.jsx("div",{className:"text-[10px] p-2 bg-void-light rounded border border-gray-800",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-gray-500",children:"Risk Score:"})," ",(0,r.jsxs)("span",{className:"font-mono",children:[(100*e.riskScore).toFixed(1),"%"]})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-gray-500",children:"Decline Prob:"})," ",(0,r.jsxs)("span",{className:"font-mono",children:[(100*e.declineProbability).toFixed(1),"%"]})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-gray-500",children:"Auth Result:"})," ",r.jsx("span",{className:e.authResult.approved?"text-neon-green":"text-error-red",children:e.authResult.approved?"APPROVED":"DECLINED"})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-gray-500",children:"Auth Code:"})," ",r.jsx("span",{className:"font-mono",children:e.authResult.authCode||""})]})]})})]}):r.jsx(rx,{icon:rs,text:"Run pipeline for explanation"})}function rh({auditRecord:e}){let t=e?.errors||[],s=e?.failedRules||[];return 0===t.length&&0===s.length?r.jsx(rx,{icon:n1.Z,text:"No errors"}):(0,r.jsxs)("div",{className:"h-full overflow-y-auto p-3 space-y-2",children:[t.map((e,t)=>(0,r.jsxs)("div",{className:"p-2 bg-error-red/10 border border-error-red/30 rounded",children:[r.jsx("div",{className:"text-xs font-semibold text-error-red",children:e.code}),r.jsx("div",{className:"text-[10px] text-gray-400",children:e.message}),e.ruleId&&(0,r.jsxs)("div",{className:"text-[10px] text-gray-500",children:["Rule: ",e.ruleId]}),e.dslSnippet&&r.jsx("div",{className:"font-mono text-[9px] bg-black/30 p-1 mt-1 rounded",children:e.dslSnippet})]},t)),s.length>0&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)("div",{className:"text-[10px] text-gray-500 mb-1",children:["Failed Rules (",s.length,")"]}),s.slice(0,5).map((e,t)=>(0,r.jsxs)("div",{className:"text-[10px] text-gray-500 p-1 border-l-2 border-gray-700 mb-1",children:[r.jsx("span",{className:"font-mono",children:e.ruleId}),": ",e.reason,e.dslSnippet&&r.jsx("div",{className:"font-mono text-[9px] text-gray-600 mt-0.5",children:e.dslSnippet})]},t))]})]})}function ru({auditRecord:e}){return e?r.jsx("div",{className:"h-full overflow-auto p-3",children:r.jsx("pre",{className:"json-viewer text-[9px] whitespace-pre-wrap break-all",children:JSON.stringify(e,null,2)})}):r.jsx(rx,{icon:nA,text:"Run pipeline for audit"})}function rx({icon:e,text:t}){return r.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(e,{className:"w-6 h-6 mx-auto mb-2 opacity-50"}),r.jsx("p",{className:"text-xs",children:t})]})})}let rm=(0,nk.Z)("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]),rp=(0,nk.Z)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),rg=(0,nk.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),rf=(0,nk.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function ry({rules:e,evaluationResults:t,isExpanded:s,onToggleExpand:i,onToggleRule:a}){let n=e=>t.find(t=>t.ruleId===e),l=t.filter(e=>e.matched).length;return(0,r.jsxs)("div",{className:"bg-void-light border-t border-neon-cyan/20",children:[(0,r.jsxs)("button",{onClick:i,className:"w-full px-4 py-2 flex items-center justify-between hover:bg-void-lighter transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx(rm,{className:"w-4 h-4 text-neon-cyan"}),r.jsx("span",{className:"font-mono text-sm",children:"Rule Builder + DSL"}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["(",e.length," rules, ",l," matched)"]})]}),s?r.jsx(nL,{className:"w-4 h-4 text-gray-500"}):r.jsx(rp,{className:"w-4 h-4 text-gray-500"})]}),r.jsx(nw,{children:s&&r.jsx(np.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0},className:"overflow-hidden",children:r.jsx("div",{className:"p-3 border-t border-gray-800 max-h-64 overflow-y-auto",children:r.jsx("div",{className:"grid gap-2",children:e.map((e,t)=>{let s=n(e.id),i=s?.matched;return(0,r.jsxs)("div",{className:`p-2 rounded border ${i?"border-neon-green/30 bg-neon-green/5":"border-gray-800 bg-void"}`,children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsxs)("span",{className:"text-xs text-gray-500 w-6",children:["#",t+1]}),r.jsx("span",{className:`px-1.5 py-0.5 text-xs rounded ${"HARD"===e.type?"bg-error-red/20 text-error-red":"bg-neon-cyan/20 text-neon-cyan"}`,children:e.type}),r.jsx("span",{className:"flex-1 text-sm font-medium truncate",children:e.label}),void 0!==i&&(i?r.jsx(rg,{className:"w-4 h-4 text-neon-green"}):r.jsx(rf,{className:"w-4 h-4 text-gray-600"})),r.jsx("button",{onClick:()=>a(e.id),className:`w-8 h-4 rounded-full ${e.enabled?"bg-neon-green/30":"bg-gray-700"}`,children:r.jsx("div",{className:`w-3 h-3 rounded-full bg-white transition-all ${e.enabled?"ml-4":"ml-0.5"}`})})]}),(0,r.jsxs)("div",{className:"dsl-block mt-1",children:[r.jsx("span",{className:"dsl-keyword",children:"IF"})," ",r.jsx("span",{className:"dsl-field",children:e.condition.field})," ",r.jsx("span",{className:"dsl-operator",children:e.condition.operator})," ",r.jsx("span",{className:"dsl-value",children:JSON.stringify(e.condition.value)})," ",r.jsx("span",{className:"dsl-keyword",children:"THEN"})," ",r.jsx("span",{className:"dsl-operator",children:e.action.type})]}),s&&r.jsx("div",{className:"mt-1 text-xs text-gray-500",children:s.matched?` ${s.reason}`:` ${s.reason}`})]},e.id)})})})})})]})}let rv=(0,nk.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var rb=s(7069);let rj=(0,nk.Z)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),rw=(0,nk.Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);function rN({diff:e,onClose:t}){return e?(0,r.jsxs)(np.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed bottom-20 left-1/2 -translate-x-1/2 w-[600px] bg-void-light border border-neon-orange/30 rounded-lg shadow-2xl z-50",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-800",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-neon-orange animate-pulse"}),r.jsx("span",{className:"font-mono text-sm text-neon-orange",children:"Route Changed"})]}),r.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-300",children:r.jsx(rf,{className:"w-4 h-4"})})]}),(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,r.jsxs)("div",{className:"px-3 py-2 bg-error-red/10 border border-error-red/30 rounded",children:[r.jsx("span",{className:"text-xs text-gray-500 block",children:"Previous"}),r.jsx("span",{className:"font-mono text-sm text-error-red",children:e.previousSelection||"none"})]}),r.jsx(rv,{className:"w-5 h-5 text-neon-orange"}),(0,r.jsxs)("div",{className:"px-3 py-2 bg-neon-green/10 border border-neon-green/30 rounded",children:[r.jsx("span",{className:"text-xs text-gray-500 block",children:"New"}),r.jsx("span",{className:"font-mono text-sm text-neon-green",children:e.newSelection})]})]}),(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("span",{className:"text-xs text-gray-500",children:"Changed at: "}),r.jsx("span",{className:"text-xs font-mono text-neon-cyan",children:e.changedAtStage}),r.jsx("p",{className:"text-sm text-gray-400 mt-1",children:e.reason})]}),e.scoreDeltas.length>0&&(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Score Changes"}),r.jsx("div",{className:"grid gap-1",children:e.scoreDeltas.slice(0,5).map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[r.jsx("span",{className:"font-mono text-gray-400 w-32 truncate",children:e.tokenId}),r.jsx("span",{className:"text-gray-500",children:e.previousScore.toFixed(1)}),r.jsx(rv,{className:"w-3 h-3 text-gray-600"}),r.jsx("span",{className:"text-gray-400",children:e.newScore.toFixed(1)}),(0,r.jsxs)("span",{className:`flex items-center gap-0.5 ${e.delta>0?"text-neon-green":e.delta<0?"text-error-red":"text-gray-500"}`,children:[e.delta>0?r.jsx(rb.Z,{className:"w-3 h-3"}):e.delta<0?r.jsx(rj,{className:"w-3 h-3"}):r.jsx(rw,{className:"w-3 h-3"}),e.delta>0?"+":"",e.delta.toFixed(1)]})]},e.tokenId))})]})]})]}):null}let rk=(0,nk.Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function rS({isVisible:e,scores:t,matchedRules:s,excludedTokens:i,selectedTokenId:a,selectedTokenName:n,isForced:l,forcingRule:o}){if(!e||0===t.length)return null;let c=t.filter(e=>!e.excluded),d=c.length>0?c.reduce((e,t)=>e.finalScore>t.finalScore?e:t):null,h=[{id:"tokens",label:"Tokens",icon:nV.Z,count:t.length},{id:"rules",label:"Rules",icon:ra.Z,count:s.length},{id:"filter",label:"Filter",icon:rk,count:i.length},{id:"score",label:"Score",icon:n7,count:c.length},{id:"select",label:"Select",icon:ri,count:1}];return(0,r.jsxs)(np.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-void-light border border-gray-800 rounded-lg p-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx(nN.Z,{className:"w-4 h-4 text-neon-cyan"}),r.jsx("h3",{className:"text-sm font-semibold text-white",children:"Decision Flow"}),l&&r.jsx("span",{className:"text-[10px] bg-warn-amber/20 text-warn-amber px-2 py-0.5 rounded-full",children:"HARD OVERRIDE"})]}),r.jsx("div",{className:"flex items-center justify-between mb-6 overflow-x-auto pb-2",children:h.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)(np.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.1*t},className:"flex flex-col items-center",children:[r.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center border-2 ${t===h.length-1?"border-neon-green bg-neon-green/20":"border-neon-cyan/50 bg-neon-cyan/10"}`,children:r.jsx(e.icon,{className:`w-5 h-5 ${t===h.length-1?"text-neon-green":"text-neon-cyan"}`})}),r.jsx("span",{className:"text-[10px] text-gray-400 mt-1",children:e.label}),r.jsx("span",{className:"text-xs font-mono text-neon-cyan",children:e.count})]}),t<h.length-1&&r.jsx(np.div,{initial:{scaleX:0},animate:{scaleX:1},transition:{delay:.1*t+.05},className:"w-8 md:w-16 h-0.5 bg-gradient-to-r from-neon-cyan/50 to-neon-cyan/20 mx-1"})]},e.id))}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:t.map((e,t)=>(0,r.jsxs)(np.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*t},className:`px-2 py-1 rounded text-xs font-mono flex items-center gap-1 ${e.excluded?"bg-error-red/10 border border-error-red/30 text-error-red line-through":e.tokenId===a?"bg-neon-green/20 border border-neon-green/50 text-neon-green":"bg-gray-800 border border-gray-700 text-gray-400"}`,children:[e.excluded?r.jsx(n0,{className:"w-3 h-3"}):e.tokenId===a?r.jsx(nQ,{className:"w-3 h-3"}):r.jsx(nV.Z,{className:"w-3 h-3"}),r.jsx("span",{className:"truncate max-w-[80px]",children:e.tokenName}),!e.excluded&&r.jsx("span",{className:"text-[10px] opacity-70",children:e.finalScore.toFixed(0)})]},e.tokenId))}),i.length>0&&(0,r.jsxs)(np.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mb-3 p-2 bg-error-red/5 border border-error-red/20 rounded",children:[(0,r.jsxs)("div",{className:"text-[10px] text-error-red font-semibold mb-1 flex items-center gap-1",children:[r.jsx(n0,{className:"w-3 h-3"})," Excluded (",i.length,")"]}),(0,r.jsxs)("div",{className:"space-y-1",children:[i.slice(0,3).map(e=>(0,r.jsxs)("div",{className:"text-[10px] text-gray-500",children:[(0,r.jsxs)("span",{className:"text-gray-400",children:[e.tokenName,":"]})," ",e.reason]},e.tokenId)),i.length>3&&(0,r.jsxs)("div",{className:"text-[10px] text-gray-600",children:["+",i.length-3," more"]})]})]}),r.jsx(np.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.5},className:`p-3 rounded-lg border ${l?"bg-warn-amber/10 border-warn-amber/30":"bg-neon-green/10 border-neon-green/30"}`,children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${l?"bg-warn-amber/20":"bg-neon-green/20"}`,children:r.jsx(ri,{className:`w-5 h-5 ${l?"text-warn-amber":"text-neon-green"}`})}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Selected Route"}),r.jsx("div",{className:`text-lg font-bold ${l?"text-warn-amber":"text-neon-green"}`,children:n}),l&&o&&(0,r.jsxs)("div",{className:"text-xs text-warn-amber/80 flex items-center gap-1 mt-1",children:[r.jsx(n1.Z,{className:"w-3 h-3"}),"Forced by: ",o]}),!l&&d&&(0,r.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Score: ",d.finalScore.toFixed(1)," / 100"]})]}),d&&!l&&(0,r.jsxs)("div",{className:"text-right",children:[r.jsx(rC,{label:"RWD",value:d.subscores.rewards.weighted,color:"green"}),r.jsx(rC,{label:"CRD",value:d.subscores.credit.weighted,color:"cyan"}),r.jsx(rC,{label:"CSH",value:d.subscores.cashflow.weighted,color:"orange"}),r.jsx(rC,{label:"RSK",value:d.subscores.risk.weighted,color:"pink"})]})]})})]})]})}function rC({label:e,value:t,color:s}){return(0,r.jsxs)("div",{className:"flex items-center gap-1 text-[10px]",children:[r.jsx("span",{className:"text-gray-500",children:e}),r.jsx("span",{className:{green:"text-neon-green",cyan:"text-neon-cyan",orange:"text-neon-orange",pink:"text-neon-pink"}[s],children:t.toFixed(1)})]})}function rR({scores:e,selectedTokenId:t}){let s=e.filter(e=>!e.excluded),i=Math.max(...s.map(e=>e.finalScore),100);return 0===s.length?null:(0,r.jsxs)("div",{className:"bg-surface-50 rounded-xl border border-white/10 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-5 py-4 border-b border-white/5",children:[r.jsx("h3",{className:"text-base font-semibold text-white",children:"Token Comparison"}),r.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Ranked by final weighted score"})]}),r.jsx("div",{className:"p-5 space-y-6",children:s.sort((e,t)=>t.finalScore-e.finalScore).map((e,s)=>r.jsx(rP,{score:e,maxScore:i,isSelected:e.tokenId===t,rank:s+1},e.tokenId))}),r.jsx("div",{className:"px-5 py-4 border-t border-white/5 bg-black/20",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-6",children:[r.jsx(rT,{icon:rb.Z,label:"Rewards",color:"bg-accent-green"}),r.jsx(rT,{icon:nV.Z,label:"Credit",color:"bg-accent-teal"}),r.jsx(rT,{icon:nB,label:"Cashflow",color:"bg-accent-orange"}),r.jsx(rT,{icon:ra.Z,label:"Risk",color:"bg-accent-pink"})]})})]})}function rT({icon:e,label:t,color:s}){return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:`w-3 h-3 rounded ${s}`}),r.jsx("span",{className:"text-xs text-text-secondary",children:t})]})}function rP({score:e,maxScore:t,isSelected:s,rank:i}){let a=e.finalScore/t*100,n=[{key:"rewards",value:e.subscores.rewards.weighted,color:"bg-accent-green",label:"RWD"},{key:"credit",value:e.subscores.credit.weighted,color:"bg-accent-teal",label:"CRD"},{key:"cashflow",value:e.subscores.cashflow.weighted,color:"bg-accent-orange",label:"CSH"},{key:"risk",value:e.subscores.risk.weighted,color:"bg-accent-pink",label:"RSK"}],l=n.reduce((e,t)=>e+t.value,0);return(0,r.jsxs)("div",{className:`transition-all duration-200 ${s?"scale-[1.01]":""}`,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:`
            w-7 h-7 rounded-lg flex items-center justify-center text-sm font-bold
            ${1===i?"bg-accent-green/20 text-accent-green":"bg-white/5 text-text-tertiary"}
          `,children:i}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:`text-sm font-medium ${s?"text-white":"text-text-secondary"}`,children:e.tokenName}),s&&(0,r.jsxs)("span",{className:"flex items-center gap-1 text-[10px] bg-accent-green/20 text-accent-green px-2 py-0.5 rounded-full font-medium",children:[r.jsx(rg,{className:"w-3 h-3"}),"Selected"]})]}),(e.totalBonuses>0||e.totalPenalties>0)&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-0.5",children:[e.totalBonuses>0&&(0,r.jsxs)("span",{className:"text-[10px] text-accent-green",children:["+",e.totalBonuses.toFixed(0)," bonus"]}),e.totalPenalties>0&&(0,r.jsxs)("span",{className:"text-[10px] text-error-red",children:["-",e.totalPenalties.toFixed(0)," penalty"]})]})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("span",{className:`text-xl font-mono font-bold ${s?"text-accent-green":"text-white"}`,children:e.finalScore.toFixed(1)}),r.jsx("span",{className:"text-xs text-text-tertiary ml-1",children:"/ 100"})]})]}),(0,r.jsxs)("div",{className:"space-y-1.5",children:[r.jsx("div",{className:"flex",style:{width:`${a}%`},children:n.map((e,t)=>{let s=l>0?e.value/l*100:25;return r.jsx("div",{className:"flex flex-col items-center justify-end",style:{width:`${s}%`},children:r.jsx("span",{className:`text-[10px] font-mono font-medium ${"rewards"===e.key?"text-accent-green":"credit"===e.key?"text-accent-teal":"cashflow"===e.key?"text-accent-orange":"text-accent-pink"}`,children:e.value.toFixed(1)})},e.key)})}),r.jsx("div",{className:"h-6 bg-black/30 rounded-lg overflow-hidden",children:r.jsx(np.div,{className:"h-full flex",initial:{width:0},animate:{width:`${a}%`},transition:{duration:.6,ease:"easeOut",delay:.1*i},children:n.map((e,t)=>{let s=l>0?e.value/l*100:25;return r.jsx(np.div,{className:`h-full ${e.color} ${0===t?"rounded-l-lg":""} ${t===n.length-1?"rounded-r-lg":""}`,style:{width:`${s}%`},initial:{opacity:0},animate:{opacity:1},transition:{delay:.3+.1*t}},e.key)})})})]}),s&&(0,r.jsxs)(np.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-4 grid grid-cols-4 gap-3",children:[r.jsx(rM,{icon:rb.Z,label:"Rewards",raw:e.subscores.rewards.raw,weighted:e.subscores.rewards.weighted,weight:e.subscores.rewards.weight,factors:e.subscores.rewards.factors,color:"green"}),r.jsx(rM,{icon:nV.Z,label:"Credit",raw:e.subscores.credit.raw,weighted:e.subscores.credit.weighted,weight:e.subscores.credit.weight,factors:e.subscores.credit.factors,color:"teal"}),r.jsx(rM,{icon:nB,label:"Cashflow",raw:e.subscores.cashflow.raw,weighted:e.subscores.cashflow.weighted,weight:e.subscores.cashflow.weight,factors:e.subscores.cashflow.factors,color:"orange"}),r.jsx(rM,{icon:ra.Z,label:"Risk",raw:e.subscores.risk.raw,weighted:e.subscores.risk.weighted,weight:e.subscores.risk.weight,factors:e.subscores.risk.factors,color:"pink"})]})]})}function rM({icon:e,label:t,raw:s,weighted:i,weight:a,factors:n,color:l}){let o={green:"text-accent-green",teal:"text-accent-teal",orange:"text-accent-orange",pink:"text-accent-pink"};return(0,r.jsxs)("div",{className:`p-3 rounded-xl border ${{green:"border-accent-green/30 bg-accent-green/10",teal:"border-accent-teal/30 bg-accent-teal/10",orange:"border-accent-orange/30 bg-accent-orange/10",pink:"border-accent-pink/30 bg-accent-pink/10"}[l]}`,children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5 mb-2",children:[r.jsx(e,{className:`w-4 h-4 ${o[l]}`}),r.jsx("span",{className:`text-xs font-semibold ${o[l]}`,children:t})]}),r.jsx("div",{className:`text-2xl font-mono font-bold ${o[l]}`,children:i.toFixed(1)}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-[10px] text-text-tertiary mt-1",children:[(0,r.jsxs)("span",{children:["Raw: ",s.toFixed(0)]}),(0,r.jsxs)("span",{className:"bg-white/5 px-1.5 py-0.5 rounded",children:[(100*a).toFixed(0),"%"]})]}),n.length>0&&r.jsx("div",{className:"mt-2 pt-2 border-t border-white/5",children:r.jsx("div",{className:"text-[9px] text-text-tertiary leading-relaxed line-clamp-2",children:n[0]})})]})}let rD=(0,nk.Z)("SlidersVertical",[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]]),rA=(0,nk.Z)("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),rE=(0,nk.Z)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]),rF=(0,nk.Z)("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]),r$=(0,nk.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),rI=[{target:"welcome",title:"Welcome to SwipeSmart",description:"Experience intelligent payment routing that optimizes every transaction. Ready to see it in action?",icon:nN.Z,position:"bottom",action:"run-demo"},{target:"run-button",title:"Run the Pipeline",description:"Press the Run button (or hit Space) to execute a transaction routing decision.",icon:nS,position:"bottom"},{target:"scenarios",title:"Choose a Scenario",description:"Select different transaction scenarios to see how the routing changes based on context.",icon:rD,position:"right"},{target:"pipeline",title:"Watch the Decision Flow",description:"See the token scores, rule evaluations, and final selection in real-time.",icon:rA,position:"left"},{target:"rules",title:"Explore the Rules",description:"Toggle rules on/off to see how policy changes affect routing decisions.",icon:ra.Z,position:"top"},{target:"export",title:"Export for Analysis",description:"Download the full audit trail and trace data as JSON for detailed analysis.",icon:nA,position:"bottom"}];function rL({isOpen:e,onClose:t,onRunDemo:s}){let[i,a]=(0,l.useState)(0),[n,o]=(0,l.useState)(!1),c=rI[i],d=0===i,h=i===rI.length-1,u=async()=>{s&&(o(!0),s(),setTimeout(()=>{t(),o(!1)},500))},x=()=>{t()};if(!e)return null;let m=c.icon;return r.jsx(nw,{children:e&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(np.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 z-50",onClick:x}),r.jsx(np.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50 w-full max-w-md",children:(0,r.jsxs)("div",{className:"bg-void-light border border-neon-cyan/30 rounded-xl shadow-2xl shadow-neon-cyan/10 overflow-hidden",children:[r.jsx("div",{className:"bg-gradient-to-r from-neon-cyan/20 to-transparent p-4 border-b border-gray-800",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-neon-cyan/20 flex items-center justify-center",children:r.jsx(m,{className:"w-5 h-5 text-neon-cyan"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"text-xs text-gray-500 font-mono",children:["Step ",i+1," of ",rI.length]}),r.jsx("h3",{className:"text-lg font-bold text-white",children:c.title})]})]}),r.jsx("button",{onClick:x,className:"p-1 text-gray-500 hover:text-gray-300 transition-colors",children:r.jsx(rf,{className:"w-5 h-5"})})]})}),(0,r.jsxs)("div",{className:"p-6",children:[r.jsx("p",{className:"text-gray-300 leading-relaxed",children:c.description}),"run-demo"===c.action&&s&&r.jsx(np.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},onClick:u,disabled:n,className:"w-full mt-4 py-3 rounded-lg bg-gradient-to-r from-accent-green/20 to-accent-teal/20 border border-accent-green/30 text-accent-green hover:from-accent-green/30 hover:to-accent-teal/30 transition-all flex items-center justify-center gap-2 font-medium",children:n?(0,r.jsxs)(r.Fragment,{children:[r.jsx(np.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:r.jsx(rE,{className:"w-5 h-5"})}),"Running Demo..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(rF,{className:"w-5 h-5"}),"Run Demo Now"]})}),r.jsx("div",{className:"flex justify-center gap-2 mt-6",children:rI.map((e,t)=>r.jsx("button",{onClick:()=>a(t),className:`w-2 h-2 rounded-full transition-all ${t===i?"bg-neon-cyan w-6":t<i?"bg-neon-green":"bg-gray-700"}`},t))})]}),(0,r.jsxs)("div",{className:"p-4 bg-void border-t border-gray-800 flex items-center justify-between",children:[r.jsx("button",{onClick:x,className:"text-sm text-gray-500 hover:text-gray-300 transition-colors",children:"Skip tour"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[!d&&(0,r.jsxs)("button",{onClick:()=>{d||a(e=>e-1)},className:"px-3 py-1.5 rounded bg-gray-800 text-gray-300 hover:bg-gray-700 transition-colors flex items-center gap-1 text-sm",children:[r.jsx(r$,{className:"w-4 h-4"}),"Back"]}),(0,r.jsxs)("button",{onClick:()=>{h?t():a(e=>e+1)},className:"px-4 py-1.5 rounded bg-neon-cyan/20 border border-neon-cyan/50 text-neon-cyan hover:bg-neon-cyan/30 transition-colors flex items-center gap-1 text-sm font-medium",children:[h?"Get Started":"Next",!h&&r.jsx(nO.Z,{className:"w-4 h-4"})]})]})]})]})})]})})}function rO({onClick:e}){return(0,r.jsxs)("button",{onClick:e,className:"fixed bottom-4 right-4 z-40 px-4 py-2 rounded-full bg-neon-cyan/20 border border-neon-cyan/50 text-neon-cyan hover:bg-neon-cyan/30 transition-all shadow-lg shadow-neon-cyan/20 flex items-center gap-2 text-sm font-mono",children:[r.jsx(nN.Z,{className:"w-4 h-4"}),"Take a Tour"]})}function rV({scores:e,selectedTokenId:t}){let[s,i]=(0,l.useState)(!0),a=e.find(e=>e.tokenId===t&&!e.excluded);if(!a)return null;let n=[{id:"rewards",icon:rb.Z,label:"Rewards",color:"green",colorClass:"text-accent-green bg-accent-green/10 border-accent-green/20",raw:a.subscores.rewards.raw,weighted:a.subscores.rewards.weighted,weight:a.subscores.rewards.weight,factors:a.subscores.rewards.factors,description:"Based on category multipliers, signup bonus progress, and cashback rates"},{id:"credit",icon:nV.Z,label:"Credit Health",color:"teal",colorClass:"text-accent-teal bg-accent-teal/10 border-accent-teal/20",raw:a.subscores.credit.raw,weighted:a.subscores.credit.weighted,weight:a.subscores.credit.weight,factors:a.subscores.credit.factors,description:"Protects credit score by avoiding high utilization thresholds"},{id:"cashflow",icon:nB,label:"Cash Flow",color:"orange",colorClass:"text-accent-orange bg-accent-orange/10 border-accent-orange/20",raw:a.subscores.cashflow.raw,weighted:a.subscores.cashflow.weighted,weight:a.subscores.cashflow.weight,factors:a.subscores.cashflow.factors,description:"Optimizes payment timing based on available balance and paycheck cycle"},{id:"risk",icon:ra.Z,label:"Risk",color:"pink",colorClass:"text-accent-pink bg-accent-pink/10 border-accent-pink/20",raw:a.subscores.risk.raw,weighted:a.subscores.risk.weighted,weight:a.subscores.risk.weight,factors:a.subscores.risk.factors,description:"Evaluates transaction risk and decline probability"}];return(0,r.jsxs)("div",{className:"bg-surface-50 rounded-xl border border-white/10 overflow-hidden",children:[(0,r.jsxs)("button",{onClick:()=>i(!s),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-white/5 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 rounded-lg bg-accent-blue/10 flex items-center justify-center",children:r.jsx(nE,{className:"w-4 h-4 text-accent-blue"})}),(0,r.jsxs)("div",{className:"text-left",children:[r.jsx("h3",{className:"text-sm font-semibold text-white",children:"How Scoring Works"}),(0,r.jsxs)("p",{className:"text-xs text-text-secondary",children:["Understanding the selection for ",a.tokenName]})]})]}),s?r.jsx(rp,{className:"w-5 h-5 text-text-tertiary"}):r.jsx(nL,{className:"w-5 h-5 text-text-tertiary"})]}),r.jsx(nw,{children:s&&r.jsx(np.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:(0,r.jsxs)("div",{className:"px-4 pb-4 space-y-4",children:[(0,r.jsxs)("div",{className:"p-3 bg-black/20 rounded-lg border border-white/5",children:[r.jsx("p",{className:"text-xs text-text-secondary mb-2",children:"Final Score Calculation"}),(0,r.jsxs)("code",{className:"text-xs font-mono text-white",children:["Final = (Rewards \xd7 ",(100*n[0].weight).toFixed(0),"%) + (Credit \xd7 ",(100*n[1].weight).toFixed(0),"%) + (Cashflow \xd7 ",(100*n[2].weight).toFixed(0),"%) + (Risk \xd7 ",(100*n[3].weight).toFixed(0),"%)",a.totalBonuses>0&&` + ${a.totalBonuses.toFixed(0)} bonus`,a.totalPenalties>0&&` - ${a.totalPenalties.toFixed(0)} penalty`]}),(0,r.jsxs)("div",{className:"mt-2 text-sm font-mono font-bold text-accent-green",children:["= ",a.finalScore.toFixed(1)," / 100"]})]}),r.jsx("div",{className:"space-y-3",children:n.map(e=>r.jsx(rB,{...e},e.id))}),(a.bonuses.length>0||a.penalties.length>0)&&(0,r.jsxs)("div",{className:"pt-3 border-t border-white/10",children:[r.jsx("p",{className:"text-xs text-text-secondary mb-2",children:"Rule Adjustments"}),(0,r.jsxs)("div",{className:"space-y-1",children:[a.bonuses.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[r.jsx("span",{className:"text-text-secondary",children:e.label}),(0,r.jsxs)("span",{className:"text-accent-green font-mono",children:["+",e.amount.toFixed(0)]})]},t)),a.penalties.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[r.jsx("span",{className:"text-text-secondary",children:e.label}),(0,r.jsxs)("span",{className:"text-error-red font-mono",children:["-",e.amount.toFixed(0)]})]},t))]})]})]})})})]})}function rB({icon:e,label:t,colorClass:s,raw:i,weighted:a,weight:n,factors:o,description:c}){let[d,h]=(0,l.useState)(!1);return(0,r.jsxs)("div",{className:`p-3 rounded-lg border ${s}`,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(e,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:t}),(0,r.jsxs)("span",{className:"text-[10px] text-text-tertiary bg-white/5 px-1.5 py-0.5 rounded",children:[(100*n).toFixed(0),"% weight"]})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("div",{className:"text-sm font-mono font-bold",children:a.toFixed(1)}),(0,r.jsxs)("div",{className:"text-[10px] text-text-tertiary",children:["raw: ",i.toFixed(0)]})]})]}),r.jsx("p",{className:"text-[11px] text-text-secondary mb-2",children:c}),r.jsx("div",{className:"h-1.5 bg-black/30 rounded-full overflow-hidden mb-2",children:r.jsx(np.div,{initial:{width:0},animate:{width:`${Math.min(i,100)}%`},transition:{duration:.5},className:"h-full rounded-full",style:{background:"currentColor",opacity:.6}})}),o.length>0&&(0,r.jsxs)("button",{onClick:()=>h(!d),className:"text-[10px] text-text-tertiary hover:text-text-secondary transition-colors",children:[d?"Hide":"Show"," ",o.length," factor",1!==o.length?"s":""]}),r.jsx(nw,{children:d&&r.jsx(np.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"mt-2 space-y-1 overflow-hidden",children:o.map((e,t)=>r.jsx("div",{className:"text-[10px] text-text-tertiary pl-2 border-l border-white/10",children:e},t))})})]})}let rz=(0,nk.Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),rU=[{name:"Balanced",weights:{rewards:.25,credit:.25,cashflow:.25,risk:.25},icon:""},{name:"Maximize Rewards",weights:{rewards:.5,credit:.15,cashflow:.15,risk:.2},icon:"\uD83C\uDF81"},{name:"Protect Credit",weights:{rewards:.15,credit:.5,cashflow:.15,risk:.2},icon:"\uD83D\uDEE1"},{name:"Cash Conservative",weights:{rewards:.15,credit:.2,cashflow:.45,risk:.2},icon:"\uD83D\uDCB5"},{name:"Safety First",weights:{rewards:.1,credit:.25,cashflow:.2,risk:.45},icon:"\uD83D\uDD12"}];function r_({weights:e,onChange:t,disabled:s}){let[i,a]=(0,l.useState)(e),[n,o]=(0,l.useState)(null),c=(e,s)=>{let n={...i,[e]:s},r=n.rewards+n.credit+n.cashflow+n.risk;r>0&&(n.rewards/=r,n.credit/=r,n.cashflow/=r,n.risk/=r),a(n),o(null),t(n)},d=e=>{a(e.weights),o(e.name),t(e.weights)},h=[{key:"rewards",label:"Rewards",icon:rb.Z,color:"accent-green",gradient:"from-accent-green/20 to-accent-green/5"},{key:"credit",label:"Credit Health",icon:nV.Z,color:"accent-teal",gradient:"from-accent-teal/20 to-accent-teal/5"},{key:"cashflow",label:"Cash Flow",icon:nB,color:"accent-orange",gradient:"from-accent-orange/20 to-accent-orange/5"},{key:"risk",label:"Risk Aversion",icon:ra.Z,color:"accent-pink",gradient:"from-accent-pink/20 to-accent-pink/5"}];return(0,r.jsxs)("div",{className:"bg-surface-50 rounded-xl border border-white/10 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-4 py-3 border-b border-white/5 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(rE,{className:"w-4 h-4 text-accent-purple"}),r.jsx("h3",{className:"text-sm font-semibold text-white",children:"Priority Weights"})]}),(0,r.jsxs)("button",{onClick:()=>d(rU[0]),className:"text-[10px] text-text-tertiary hover:text-white flex items-center gap-1 transition-colors",children:[r.jsx(rz,{className:"w-3 h-3"})," Reset"]})]}),(0,r.jsxs)("div",{className:"px-4 py-3 border-b border-white/5 bg-black/20",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary mb-2 uppercase tracking-wider",children:"Quick Presets"}),r.jsx("div",{className:"flex flex-wrap gap-1.5",children:rU.map(e=>(0,r.jsxs)("button",{onClick:()=>d(e),disabled:s,className:`px-2 py-1 rounded-lg text-[10px] font-medium transition-all ${n===e.name?"bg-accent-purple/20 text-accent-purple border border-accent-purple/30":"bg-white/5 text-text-secondary hover:bg-white/10 hover:text-white border border-transparent"}`,children:[r.jsx("span",{className:"mr-1",children:e.icon}),e.name]},e.name))})]}),r.jsx("div",{className:"p-4 space-y-4",children:h.map(({key:e,label:t,icon:a,color:n,gradient:l})=>(0,r.jsxs)("div",{className:`p-3 rounded-lg bg-gradient-to-r ${l} border border-white/5`,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(a,{className:`w-4 h-4 text-${n}`}),r.jsx("span",{className:"text-xs font-medium text-white",children:t})]}),(0,r.jsxs)("span",{className:`text-sm font-mono font-bold text-${n}`,children:[(100*i[e]).toFixed(0),"%"]})]}),r.jsx("input",{type:"range",min:"0",max:"100",value:100*i[e],onChange:t=>c(e,Number(t.target.value)/100),disabled:s,className:`w-full h-2 rounded-full appearance-none cursor-pointer bg-black/30
                [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4
                [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-white
                [&::-webkit-slider-thumb]:shadow-lg [&::-webkit-slider-thumb]:cursor-pointer
                [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-${n}
                disabled:opacity-50 disabled:cursor-not-allowed`})]},e))}),(0,r.jsxs)("div",{className:"px-4 py-2 border-t border-white/5 bg-black/20 flex items-center justify-center gap-2",children:[r.jsx(np.div,{className:"w-2 h-2 rounded-full bg-accent-green",animate:{opacity:[1,.5,1]},transition:{duration:1.5,repeat:1/0}}),r.jsx("span",{className:"text-[10px] text-text-tertiary",children:"Adjustments update scores in real-time"})]})]})}function rZ({scores:e,selectedTokenId:t}){let s,i,a,n;let l=e.filter(e=>!e.excluded).sort((e,t)=>t.finalScore-e.finalScore);if(l.length<2)return null;let o=l[0],c=l[1],d=o.finalScore-c.finalScore;return d>=15?(s="high",i="High Confidence",a="accent-green",n=nQ):d>=5?(s="medium",i="Moderate Confidence",a="accent-orange",n=rb.Z):(s="low",i="Close Call",a="accent-pink",n=n1.Z),(0,r.jsxs)(np.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-surface-50 rounded-xl border border-white/10 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-4 py-3 border-b border-white/5 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(nN.Z,{className:"w-4 h-4 text-accent-blue"}),r.jsx("h3",{className:"text-sm font-semibold text-white",children:"Decision Confidence"})]}),(0,r.jsxs)("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded-full bg-${a}/10 border border-${a}/20`,children:[r.jsx(n,{className:`w-3 h-3 text-${a}`}),r.jsx("span",{className:`text-[10px] font-semibold text-${a}`,children:i})]})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-xs text-text-secondary mb-1",children:"Winning Margin"}),(0,r.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,r.jsxs)("span",{className:`text-3xl font-mono font-bold text-${a}`,children:["+",d.toFixed(1)]}),r.jsx("span",{className:"text-sm text-text-tertiary",children:"pts"})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("p",{className:"text-xs text-text-secondary mb-1",children:"vs Runner-up"}),r.jsx("p",{className:"text-sm font-medium text-white",children:c.tokenName}),(0,r.jsxs)("p",{className:"text-xs text-text-tertiary font-mono",children:[c.finalScore.toFixed(1)," pts"]})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex justify-between text-[10px] text-text-tertiary mb-1",children:[r.jsx("span",{children:"Low"}),r.jsx("span",{children:"High"})]}),r.jsx("div",{className:"h-3 bg-black/30 rounded-full overflow-hidden",children:r.jsx(np.div,{initial:{width:0},animate:{width:`${Math.min(100,d/25*100)}%`},transition:{duration:.8,ease:"easeOut"},className:`h-full rounded-full bg-gradient-to-r ${"high"===s?"from-accent-green/60 to-accent-green":"medium"===s?"from-accent-orange/60 to-accent-orange":"from-accent-pink/60 to-accent-pink"}`})})]}),r.jsx("div",{className:`p-3 rounded-lg bg-${a}/5 border border-${a}/10`,children:(0,r.jsxs)("p",{className:`text-xs text-${a}`,children:["high"===s&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("strong",{children:o.tokenName})," is the clear optimal choice. Small input changes won't affect this selection."]}),"medium"===s&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("strong",{children:o.tokenName})," leads, but ",r.jsx("strong",{children:c.tokenName})," is competitive. Weight adjustments could change the outcome."]}),"low"===s&&(0,r.jsxs)(r.Fragment,{children:["Very close race between ",r.jsx("strong",{children:o.tokenName})," and ",r.jsx("strong",{children:c.tokenName}),". Minor changes to weights or context could flip the selection."]})]})}),(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-white/5",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase tracking-wider mb-2",children:"Score Ladder"}),r.jsx("div",{className:"space-y-2",children:l.slice(0,3).map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:`w-5 h-5 rounded flex items-center justify-center text-[10px] font-bold ${0===t?"bg-accent-green/20 text-accent-green":1===t?"bg-white/10 text-text-secondary":"bg-white/5 text-text-tertiary"}`,children:t+1}),r.jsx("div",{className:"flex-1",children:r.jsx("div",{className:"h-2 bg-black/30 rounded-full overflow-hidden",children:r.jsx(np.div,{initial:{width:0},animate:{width:`${e.finalScore}%`},transition:{duration:.5,delay:.1*t},className:`h-full rounded-full ${0===t?"bg-accent-green":1===t?"bg-white/40":"bg-white/20"}`})})}),r.jsx("span",{className:"text-xs font-mono text-text-secondary w-16 text-right",children:e.finalScore.toFixed(1)}),r.jsx("span",{className:"text-xs text-text-tertiary w-20 truncate",children:e.tokenName.split(" ")[0]})]},e.tokenId))})]})]})]})}let rH=(0,nk.Z)("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]),rW=(0,nk.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),rq=(0,nk.Z)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);function rG({evaluations:e,scores:t}){let s=e.filter(e=>e.matched),i=e.filter(e=>!e.matched),a=s.map(e=>{let s=0,i=0,a=0,n=[];return t.forEach(t=>{t.bonuses.forEach(i=>{i.ruleId!==e.ruleId||(s+=i.amount,n.includes(t.tokenName)||n.push(t.tokenName))}),t.penalties.forEach(s=>{s.ruleId!==e.ruleId||(i+=s.amount,n.includes(t.tokenName)||n.push(t.tokenName))}),t.excluded&&t.exclusionReason?.includes(e.ruleLabel)&&a++}),{...e,totalBoost:s,totalPenalty:i,exclusions:a,affectedTokens:n,netImpact:s-i}});return(a.sort((e,t)=>Math.abs(t.netImpact)-Math.abs(e.netImpact)),0===s.length&&0===i.length)?null:(0,r.jsxs)(np.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-surface-50 rounded-xl border border-white/10 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-4 py-3 border-b border-white/5 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(rH,{className:"w-4 h-4 text-accent-purple"}),r.jsx("h3",{className:"text-sm font-semibold text-white",children:"Rule Impact Analysis"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-accent-green/10 text-accent-green border border-accent-green/20",children:[s.length," matched"]}),(0,r.jsxs)("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-white/5 text-text-tertiary border border-white/10",children:[i.length," inactive"]})]})]}),(0,r.jsxs)("div",{className:"p-4",children:[0===a.length?r.jsx("p",{className:"text-xs text-text-tertiary text-center py-4",children:"No rules affected scoring"}):r.jsx("div",{className:"space-y-3",children:a.map((e,t)=>(0,r.jsxs)(np.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.05*t},className:`p-3 rounded-lg border ${e.netImpact>0?"bg-accent-green/5 border-accent-green/20":e.netImpact<0?"bg-accent-pink/5 border-accent-pink/20":e.exclusions>0?"bg-accent-orange/5 border-accent-orange/20":"bg-white/5 border-white/10"}`,children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["HARD"===e.ruleType?r.jsx(nN.Z,{className:"w-4 h-4 text-accent-orange"}):r.jsx(rH,{className:"w-4 h-4 text-accent-blue"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-white",children:e.ruleLabel}),(0,r.jsxs)("p",{className:"text-[10px] text-text-tertiary",children:[e.ruleType," rule"]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.totalBoost>0&&(0,r.jsxs)("span",{className:"flex items-center gap-0.5 text-xs font-mono text-accent-green",children:[r.jsx(rW,{className:"w-3 h-3"}),e.totalBoost.toFixed(0)]}),e.totalPenalty>0&&(0,r.jsxs)("span",{className:"flex items-center gap-0.5 text-xs font-mono text-accent-pink",children:[r.jsx(rw,{className:"w-3 h-3"}),e.totalPenalty.toFixed(0)]}),e.exclusions>0&&(0,r.jsxs)("span",{className:"flex items-center gap-0.5 text-xs font-mono text-accent-orange",children:[r.jsx(rq,{className:"w-3 h-3"}),e.exclusions]})]})]}),e.affectedTokens.length>0&&(0,r.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-text-tertiary",children:[r.jsx(nO.Z,{className:"w-3 h-3"}),"Affected: ",e.affectedTokens.slice(0,3).join(", "),e.affectedTokens.length>3&&` +${e.affectedTokens.length-3} more`]}),"HARD"===e.ruleType&&e.matched&&r.jsx("div",{className:"mt-2 px-2 py-1 bg-accent-orange/10 rounded text-[10px] text-accent-orange",children:"Hard rule enforced selection"})]},e.ruleId))}),a.length>0&&(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-white/5 grid grid-cols-3 gap-3",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("p",{className:"text-lg font-mono font-bold text-accent-green",children:["+",a.reduce((e,t)=>e+t.totalBoost,0).toFixed(0)]}),r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Total Boosts"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("p",{className:"text-lg font-mono font-bold text-accent-pink",children:["-",a.reduce((e,t)=>e+t.totalPenalty,0).toFixed(0)]}),r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Total Penalties"})]}),(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-lg font-mono font-bold text-accent-orange",children:a.reduce((e,t)=>e+t.exclusions,0)}),r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Exclusions"})]})]})]})]})}let rX=(0,nk.Z)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),rK=(0,nk.Z)("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);var rY=s(1821);let rJ=(0,nk.Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);function rQ({score:e,context:t,token:s}){let i=s?.rewardsByCategory[t.category||"default"]||s?.rewardsByCategory.default||1,a=Math.round(t.amount*i),n=.01*a,l=s?.cashbackRate||0,o=t.amount*(l/100),c=s?.utilization||0,d=s?.type==="credit"&&s.limit>0?((s.balance||0)+t.amount)/s.limit:0,h="neutral",u="No impact";s?.type==="credit"&&(d>.5?(h="negative",u="-5 to -15 pts estimated"):d>.3?(h="negative",u="-2 to -5 pts estimated"):d<.1&&(h="positive",u="Optimal utilization maintained"));let x=s?.apr||0,m=t.amount*(x/100/12),p=s?.signupBonus,g=p?Math.min(100,(p.current+t.amount)/p.threshold*100):null,f=p?Math.max(0,p.threshold-p.current-t.amount):null,y=[{icon:rX,label:"Rewards Earned",value:`${a.toLocaleString()} pts`,subtext:` $${n.toFixed(2)} value`,color:"accent-green",show:a>0},{icon:rK,label:"Cash Back",value:`$${o.toFixed(2)}`,subtext:`${l}% rate`,color:"accent-teal",show:l>0},{icon:rb.Z,label:"Bonus Progress",value:g?`${g.toFixed(0)}%`:"",subtext:null!==f&&f>0?`$${f.toFixed(0)} to ${p?.reward.toLocaleString()} pts`:g&&g>=100?"Bonus unlocked!":"No active bonus",color:"accent-purple",show:!!p}].filter(e=>e.show),v=[{icon:nV.Z,label:"Credit Utilization",value:`${(100*d).toFixed(1)}%`,subtext:`+${(100*(d-c)).toFixed(1)}% from current`,color:d>.3?"accent-orange":"accent-teal",show:s?.type==="credit"},{icon:rj,label:"Credit Score Impact",value:u,subtext:"negative"===h?"Consider lower utilization":"",color:"negative"===h?"accent-pink":"positive"===h?"accent-green":"text-secondary",show:s?.type==="credit"},{icon:rY.Z,label:"Interest if Carried (30d)",value:`$${m.toFixed(2)}`,subtext:`${x}% APR`,color:x>20?"accent-orange":"text-secondary",show:s?.type==="credit"&&x>0}].filter(e=>e.show),b=n+o-m;return(0,r.jsxs)(np.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-surface-50 rounded-xl border border-white/10 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-4 py-3 border-b border-white/5 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(rY.Z,{className:"w-4 h-4 text-accent-green"}),r.jsx("h3",{className:"text-sm font-semibold text-white",children:"Cost/Benefit Analysis"})]}),r.jsx("span",{className:"text-xs text-text-secondary",children:e.tokenName})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:`p-4 rounded-xl mb-4 ${b>=0?"bg-accent-green/10 border border-accent-green/20":"bg-accent-pink/10 border border-accent-pink/20"}`,children:[r.jsx("p",{className:"text-xs text-text-secondary mb-1",children:"Estimated Net Value"}),(0,r.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,r.jsxs)("span",{className:`text-3xl font-mono font-bold ${b>=0?"text-accent-green":"text-accent-pink"}`,children:[b>=0?"+":"",b.toFixed(2)]}),r.jsx("span",{className:"text-sm text-text-tertiary",children:"for this transaction"})]})]}),y.length>0&&(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase tracking-wider mb-2",children:"Benefits"}),r.jsx("div",{className:"space-y-2",children:y.map((e,t)=>(0,r.jsxs)(np.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.05*t},className:`flex items-center justify-between p-2 rounded-lg bg-${e.color}/5 border border-${e.color}/10`,children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(e.icon,{className:`w-4 h-4 text-${e.color}`}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-xs font-medium text-white",children:e.label}),e.subtext&&r.jsx("p",{className:"text-[10px] text-text-tertiary",children:e.subtext})]})]}),r.jsx("span",{className:`text-sm font-mono font-bold text-${e.color}`,children:e.value})]},e.label))})]}),v.length>0&&(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase tracking-wider mb-2",children:"Costs & Considerations"}),r.jsx("div",{className:"space-y-2",children:v.map((e,t)=>(0,r.jsxs)(np.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:(y.length+t)*.05},className:"flex items-center justify-between p-2 rounded-lg bg-white/5 border border-white/10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(e.icon,{className:`w-4 h-4 text-${e.color}`}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-xs font-medium text-white",children:e.label}),e.subtext&&r.jsx("p",{className:"text-[10px] text-text-tertiary",children:e.subtext})]})]}),r.jsx("span",{className:`text-sm font-mono text-${e.color}`,children:e.value})]},e.label))})]}),r.jsx("div",{className:"mt-4 pt-4 border-t border-white/5",children:(0,r.jsxs)("div",{className:"flex items-start gap-2 p-3 rounded-lg bg-accent-blue/5 border border-accent-blue/10",children:[r.jsx(rJ,{className:"w-4 h-4 text-accent-blue mt-0.5"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-xs font-medium text-white",children:"Payment Timing"}),r.jsx("p",{className:"text-[10px] text-text-secondary",children:s?.type==="credit"?`Statement closes in ~${Math.floor(15*Math.random())+10} days. Pay before to avoid interest.`:"Immediate debit - funds available now."})]})]})})]})]})}function r0({shadow:e}){let t=e.wouldHaveScore-e.actualScore;return r.jsx(np.div,{initial:{opacity:0,y:-20,scale:.95},animate:{opacity:1,y:0,scale:1},className:"bg-gradient-to-r from-accent-orange/10 via-accent-orange/5 to-transparent border border-accent-orange/30 rounded-xl overflow-hidden",children:(0,r.jsxs)("div",{className:"px-4 py-3 flex items-start gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent-orange/20 flex items-center justify-center flex-shrink-0",children:r.jsx(n1.Z,{className:"w-5 h-5 text-accent-orange"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("span",{className:"text-xs font-semibold text-accent-orange uppercase tracking-wider",children:"Rule Override Active"}),r.jsx(nN.Z,{className:"w-3 h-3 text-accent-orange"})]}),(0,r.jsxs)("p",{className:"text-sm text-white mb-3",children:["The optimizer would have selected ",r.jsx("strong",{className:"text-accent-green",children:e.wouldHaveSelectedName})," but a hard rule enforced ",r.jsx("strong",{className:"text-accent-blue",children:e.actualSelectedName})," instead."]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 p-3 bg-black/20 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase tracking-wider mb-1",children:"Optimizer Choice"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(rb.Z,{className:"w-4 h-4 text-accent-green"}),r.jsx("span",{className:"text-sm font-medium text-white",children:e.wouldHaveSelectedName})]}),(0,r.jsxs)("p",{className:"text-lg font-mono font-bold text-accent-green mt-1",children:[e.wouldHaveScore.toFixed(1)," pts"]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[r.jsx(rv,{className:"w-5 h-5 text-accent-orange"}),r.jsx("span",{className:"text-[10px] text-accent-orange font-mono mt-1",children:t>0?`-${t.toFixed(1)}`:`+${Math.abs(t).toFixed(1)}`})]}),(0,r.jsxs)("div",{className:"flex-1 text-right",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase tracking-wider mb-1",children:"Rule Selection"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[r.jsx("span",{className:"text-sm font-medium text-white",children:e.actualSelectedName}),r.jsx(nN.Z,{className:"w-4 h-4 text-accent-orange"})]}),(0,r.jsxs)("p",{className:"text-lg font-mono font-bold text-accent-blue mt-1",children:[e.actualScore.toFixed(1)," pts"]})]})]}),r.jsx("p",{className:"text-[11px] text-text-secondary mt-2 italic",children:e.reason})]})]})})}let r1=(0,nk.Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),r2=(0,nk.Z)("Shuffle",[["path",{d:"M2 18h1.4c1.3 0 2.5-.6 3.3-1.7l6.1-8.6c.7-1.1 2-1.7 3.3-1.7H22",key:"1wmou1"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 6h1.9c1.5 0 2.9.9 3.6 2.2",key:"10bdb2"}],["path",{d:"M22 18h-5.9c-1.3 0-2.6-.7-3.3-1.8l-.5-.8",key:"vgxac0"}],["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}]]);function r5({sensitivity:e,currentWinnerName:t}){let s=e.filter(e=>e.winnerChanged);if(0===s.length)return r.jsx(np.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-accent-green/5 border border-accent-green/20 rounded-xl p-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent-green/10 flex items-center justify-center",children:r.jsx(rb.Z,{className:"w-5 h-5 text-accent-green"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-semibold text-accent-green",children:"Stable Selection"}),r.jsx("p",{className:"text-xs text-text-secondary",children:"Weight changes of \xb110% would not change the winning token"})]})]})});let i={rewards:"Rewards",credit:"Credit Health",cashflow:"Cash Flow",risk:"Risk Aversion"},a={rewards:"accent-green",credit:"accent-teal",cashflow:"accent-orange",risk:"accent-pink"};return(0,r.jsxs)(np.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-surface-50 rounded-xl border border-white/10 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-4 py-3 border-b border-white/5 flex items-center gap-2 bg-accent-orange/5",children:[r.jsx(r1,{className:"w-4 h-4 text-accent-orange"}),r.jsx("span",{className:"text-sm font-semibold text-white",children:"Sensitivity Alerts"}),(0,r.jsxs)("span",{className:"ml-auto text-[10px] px-2 py-0.5 rounded-full bg-accent-orange/10 text-accent-orange border border-accent-orange/20",children:[s.length," potential flip",1!==s.length?"s":""]})]}),(0,r.jsxs)("div",{className:"p-4 space-y-3",children:[r.jsx("p",{className:"text-xs text-text-secondary mb-3",children:"These weight adjustments would change the selected token:"}),s.map((e,s)=>(0,r.jsxs)(np.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.05*s},className:`p-3 rounded-lg bg-${a[e.criterion]}/5 border border-${a[e.criterion]}/20`,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["increase"===e.direction?r.jsx(rb.Z,{className:`w-4 h-4 text-${a[e.criterion]}`}):r.jsx(rj,{className:`w-4 h-4 text-${a[e.criterion]}`}),(0,r.jsxs)("span",{className:"text-sm font-medium text-white",children:[i[e.criterion]," ","increase"===e.direction?"+":"-","10%"]})]}),r.jsx(r2,{className:"w-4 h-4 text-accent-orange"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[r.jsx("span",{className:"text-text-secondary",children:t}),r.jsx("span",{className:"text-accent-orange",children:""}),r.jsx("span",{className:"text-white font-medium",children:e.newWinner}),(0,r.jsxs)("span",{className:"text-text-tertiary ml-auto font-mono",children:["(",e.newScore.toFixed(1)," pts)"]})]})]},`${e.criterion}-${e.direction}`)),r.jsx("p",{className:"text-[10px] text-text-tertiary pt-2 border-t border-white/5",children:"Based on \xb110% weight perturbation analysis"})]})]})}let r3=(0,nk.Z)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),r4=(0,nk.Z)("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),r8=(0,nk.Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);function r6({context:e,weights:t,seed:s,scenario:i}){let[a,n]=(0,l.useState)(!1),[o,c]=(0,l.useState)(!1),d=()=>{let a=new URLSearchParams;return a.set("seed",s.toString()),a.set("scenario",i),a.set("amount",e.amount.toString()),a.set("merchant",e.merchant),a.set("category",e.category||""),a.set("country",e.country),a.set("rw",t.rewards.toFixed(2)),a.set("cr",t.credit.toFixed(2)),a.set("cf",t.cashflow.toFixed(2)),a.set("rs",t.risk.toFixed(2)),`?${a.toString()}`},h=async()=>{let e=d();try{await navigator.clipboard.writeText(e),n(!0),setTimeout(()=>n(!1),2e3)}catch(e){console.error("Failed to copy:",e)}},u=d();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>c(!0),className:"btn-primary px-2.5 py-1 rounded flex items-center gap-1 text-xs font-mono",title:"Share configuration",children:[r.jsx(r3,{className:"w-3.5 h-3.5"}),"Share"]}),r.jsx(nw,{children:o&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(np.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50",onClick:()=>c(!1)}),(0,r.jsxs)(np.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-lg bg-surface-50 rounded-2xl border border-white/10 shadow-2xl z-50 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-5 py-4 border-b border-white/5 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent-blue/10 flex items-center justify-center",children:r.jsx(r4,{className:"w-5 h-5 text-accent-blue"})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"Share Configuration"}),r.jsx("p",{className:"text-xs text-text-secondary",children:"Copy this URL to share your exact setup"})]})]}),r.jsx("button",{onClick:()=>c(!1),className:"text-text-tertiary hover:text-white transition-colors",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"p-5",children:[(0,r.jsxs)("div",{className:"bg-black/30 rounded-lg p-3 mb-4",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase tracking-wider mb-2",children:"Shareable URL"}),r.jsx("p",{className:"text-xs font-mono text-text-secondary break-all",children:u})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,r.jsxs)("div",{className:"p-3 bg-white/5 rounded-lg",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary mb-1",children:"Transaction"}),(0,r.jsxs)("p",{className:"text-sm text-white",children:["$",e.amount," at ",e.merchant]})]}),(0,r.jsxs)("div",{className:"p-3 bg-white/5 rounded-lg",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary mb-1",children:"Seed"}),r.jsx("p",{className:"text-sm font-mono text-white",children:s})]}),(0,r.jsxs)("div",{className:"p-3 bg-white/5 rounded-lg col-span-2",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary mb-1",children:"Weights"}),(0,r.jsxs)("div",{className:"flex gap-3 text-xs",children:[(0,r.jsxs)("span",{className:"text-accent-green",children:["RWD: ",(100*t.rewards).toFixed(0),"%"]}),(0,r.jsxs)("span",{className:"text-accent-teal",children:["CRD: ",(100*t.credit).toFixed(0),"%"]}),(0,r.jsxs)("span",{className:"text-accent-orange",children:["CSH: ",(100*t.cashflow).toFixed(0),"%"]}),(0,r.jsxs)("span",{className:"text-accent-pink",children:["RSK: ",(100*t.risk).toFixed(0),"%"]})]})]})]}),r.jsx("button",{onClick:h,className:`w-full py-3 rounded-lg font-medium text-sm flex items-center justify-center gap-2 transition-all ${a?"bg-accent-green/20 text-accent-green border border-accent-green/30":"bg-accent-blue/20 text-accent-blue border border-accent-blue/30 hover:bg-accent-blue/30"}`,children:a?(0,r.jsxs)(r.Fragment,{children:[r.jsx(rg,{className:"w-4 h-4"}),"Copied to Clipboard!"]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(r8,{className:"w-4 h-4"}),"Copy URL"]})})]})]})]})})]})}let r9=(0,nk.Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function r7({auditRecord:e,context:t}){let[s,i]=(0,l.useState)(!1),[a,n]=(0,l.useState)(!1),o=async()=>{if(!e)return;n(!0);let s=e.scoreBreakdown.find(t=>t.tokenId===e.selectedRoute),a=new Blob([`
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SwipeSmart Decision Report</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
      background: #f5f5f7;
      color: #1d1d1f;
      padding: 40px;
      line-height: 1.6;
    }
    .container { max-width: 800px; margin: 0 auto; }
    .header {
      text-align: center;
      margin-bottom: 40px;
      padding-bottom: 20px;
      border-bottom: 1px solid #d2d2d7;
    }
    .header h1 { font-size: 28px; font-weight: 600; margin-bottom: 8px; }
    .header p { color: #86868b; font-size: 14px; }
    .section {
      background: white;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .section h2 {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 16px;
      color: #1d1d1f;
    }
    .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
    .metric { padding: 16px; background: #f5f5f7; border-radius: 8px; }
    .metric-label { font-size: 12px; color: #86868b; text-transform: uppercase; letter-spacing: 0.5px; }
    .metric-value { font-size: 24px; font-weight: 600; margin-top: 4px; }
    .metric-value.green { color: #30d158; }
    .metric-value.blue { color: #0a84ff; }
    .metric-value.orange { color: #ff9f0a; }
    .score-bar {
      height: 8px;
      background: #e5e5ea;
      border-radius: 4px;
      margin-top: 8px;
      overflow: hidden;
    }
    .score-fill { height: 100%; border-radius: 4px; }
    .token-row {
      display: flex;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid #f5f5f7;
    }
    .token-row:last-child { border-bottom: none; }
    .token-rank {
      width: 28px;
      height: 28px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
      margin-right: 12px;
    }
    .token-rank.first { background: #30d158; color: white; }
    .token-rank.other { background: #f5f5f7; color: #86868b; }
    .token-info { flex: 1; }
    .token-name { font-weight: 500; }
    .token-score { font-family: 'SF Mono', monospace; font-weight: 600; }
    .footer {
      text-align: center;
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px solid #d2d2d7;
      color: #86868b;
      font-size: 12px;
    }
    @media print {
      body { background: white; padding: 20px; }
      .section { box-shadow: none; border: 1px solid #e5e5ea; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>SwipeSmart Decision Report</h1>
      <p>Generated ${new Date().toLocaleString()}</p>
    </div>

    <div class="section">
      <h2>Transaction Details</h2>
      <div class="grid">
        <div class="metric">
          <div class="metric-label">Amount</div>
          <div class="metric-value">$${t.amount.toFixed(2)}</div>
        </div>
        <div class="metric">
          <div class="metric-label">Merchant</div>
          <div class="metric-value">${t.merchant}</div>
        </div>
        <div class="metric">
          <div class="metric-label">Category</div>
          <div class="metric-value">${t.category||"General"}</div>
        </div>
        <div class="metric">
          <div class="metric-label">Country</div>
          <div class="metric-value">${t.country}</div>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>Decision Summary</h2>
      <div class="grid">
        <div class="metric">
          <div class="metric-label">Selected Token</div>
          <div class="metric-value blue">${e.selectedRouteName}</div>
        </div>
        <div class="metric">
          <div class="metric-label">Final Score</div>
          <div class="metric-value green">${s?.finalScore.toFixed(1)||"N/A"}</div>
        </div>
        <div class="metric">
          <div class="metric-label">Selection Method</div>
          <div class="metric-value">${e.selectionMethod.type}</div>
        </div>
        <div class="metric">
          <div class="metric-label">Authorization</div>
          <div class="metric-value ${e.authResult.approved?"green":"orange"}">
            ${e.authResult.approved?"APPROVED":"DECLINED"}
          </div>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>Score Breakdown</h2>
      ${s?`
      <div class="grid">
        <div class="metric">
          <div class="metric-label">Rewards</div>
          <div class="metric-value">${s.subscores.rewards.weighted.toFixed(1)}</div>
          <div class="score-bar"><div class="score-fill" style="width: ${s.subscores.rewards.normalized}%; background: #30d158;"></div></div>
        </div>
        <div class="metric">
          <div class="metric-label">Credit Health</div>
          <div class="metric-value">${s.subscores.credit.weighted.toFixed(1)}</div>
          <div class="score-bar"><div class="score-fill" style="width: ${s.subscores.credit.normalized}%; background: #64d2ff;"></div></div>
        </div>
        <div class="metric">
          <div class="metric-label">Cash Flow</div>
          <div class="metric-value">${s.subscores.cashflow.weighted.toFixed(1)}</div>
          <div class="score-bar"><div class="score-fill" style="width: ${s.subscores.cashflow.normalized}%; background: #ff9f0a;"></div></div>
        </div>
        <div class="metric">
          <div class="metric-label">Risk</div>
          <div class="metric-value">${s.subscores.risk.weighted.toFixed(1)}</div>
          <div class="score-bar"><div class="score-fill" style="width: ${s.subscores.risk.normalized}%; background: #ff375f;"></div></div>
        </div>
      </div>
      `:""}
    </div>

    <div class="section">
      <h2>All Candidates</h2>
      ${e.scoreBreakdown.filter(e=>!e.excluded).sort((e,t)=>t.finalScore-e.finalScore).map((e,t)=>`
        <div class="token-row">
          <div class="token-rank ${0===t?"first":"other"}">${t+1}</div>
          <div class="token-info">
            <div class="token-name">${e.tokenName}</div>
          </div>
          <div class="token-score">${e.finalScore.toFixed(1)}</div>
        </div>
      `).join("")}
    </div>

    <div class="section">
      <h2>Audit Trail</h2>
      <div class="grid">
        <div class="metric">
          <div class="metric-label">Correlation ID</div>
          <div class="metric-value" style="font-size: 14px; font-family: monospace;">${e.correlationId}</div>
        </div>
        <div class="metric">
          <div class="metric-label">Replay Seed</div>
          <div class="metric-value" style="font-size: 14px; font-family: monospace;">${e.replaySeed}</div>
        </div>
        <div class="metric">
          <div class="metric-label">Policy Version</div>
          <div class="metric-value">v${e.policyVersion}</div>
        </div>
        <div class="metric">
          <div class="metric-label">Processing Time</div>
          <div class="metric-value">${e.processingTimeMs}ms</div>
        </div>
      </div>
    </div>

    <div class="footer">
      <p>SwipeSmart Engine  Intelligent Payment Routing</p>
      <p>This report is for demonstration purposes only.</p>
    </div>
  </div>
</body>
</html>
    `],{type:"text/html"}),r=URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download=`swipesmart-report-${e.correlationId.slice(0,8)}.html`,l.click(),URL.revokeObjectURL(r),n(!1),i(!1)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>i(!0),disabled:!e,className:"btn-primary px-2.5 py-1 rounded flex items-center gap-1 text-xs font-mono disabled:opacity-50",title:"Export as report",children:[r.jsx(rt,{className:"w-3.5 h-3.5"}),"Report"]}),r.jsx(nw,{children:s&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(np.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50",onClick:()=>i(!1)}),(0,r.jsxs)(np.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md bg-surface-50 rounded-2xl border border-white/10 shadow-2xl z-50 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-5 py-4 border-b border-white/5 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent-purple/10 flex items-center justify-center",children:r.jsx(rt,{className:"w-5 h-5 text-accent-purple"})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"Export Report"}),r.jsx("p",{className:"text-xs text-text-secondary",children:"Download a printable summary"})]})]}),r.jsx("button",{onClick:()=>i(!1),className:"text-text-tertiary hover:text-white transition-colors",children:r.jsx(rf,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"p-5",children:[(0,r.jsxs)("div",{className:"p-4 bg-black/20 rounded-lg mb-4",children:[r.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"The report includes:"}),(0,r.jsxs)("ul",{className:"space-y-2 text-xs text-text-tertiary",children:[(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-accent-green"}),"Transaction details and context"]}),(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-accent-blue"}),"Decision summary with selected token"]}),(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-accent-orange"}),"Complete score breakdown"]}),(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-accent-purple"}),"Audit trail with correlation ID"]})]})]}),r.jsx("button",{onClick:o,disabled:a,className:"w-full py-3 rounded-lg font-medium text-sm flex items-center justify-center gap-2 bg-accent-purple/20 text-accent-purple border border-accent-purple/30 hover:bg-accent-purple/30 transition-all disabled:opacity-50",children:a?(0,r.jsxs)(r.Fragment,{children:[r.jsx(r9,{className:"w-4 h-4 animate-spin"}),"Generating..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(nD,{className:"w-4 h-4"}),"Download HTML Report"]})}),r.jsx("p",{className:"text-[10px] text-text-tertiary text-center mt-3",children:"Opens in browser  Print to PDF for best results"})]})]})]})})]})}let le=(0,nk.Z)("GitCompare",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]]);function lt({currentScenario:e,onRunComparison:t}){let[s,i]=(0,l.useState)(!1),[a,n]=(0,l.useState)(!1),[o,c]=(0,l.useState)([]),[d,h]=(0,l.useState)([]),u=n_.filter(e=>"custom"!==e.id),x=e=>{h(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},m=async()=>{if(0===d.length)return;n(!0),c([]);let e=[];for(let s of d){let i=n_.find(e=>e.id===s);if(!i)continue;let a=await t(s);a&&e.push({scenarioId:s,scenarioName:i.name,winner:a.winner.tokenName,winnerScore:a.winner.finalScore,runnerUp:a.runnerUp?.tokenName||"N/A",runnerUpScore:a.runnerUp?.finalScore||0,margin:a.winner.finalScore-(a.runnerUp?.finalScore||0)})}c(e),n(!1)},p=o.reduce((e,t)=>(e[t.winner]||(e[t.winner]=[]),e[t.winner].push(t),e),{});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>i(!0),className:"btn-primary px-2.5 py-1 rounded flex items-center gap-1 text-xs font-mono",title:"Compare scenarios",children:[r.jsx(le,{className:"w-3.5 h-3.5"}),"Compare"]}),r.jsx(nw,{children:s&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(np.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50",onClick:()=>i(!1)}),(0,r.jsxs)(np.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-2xl max-h-[80vh] bg-surface-50 rounded-2xl border border-white/10 shadow-2xl z-50 overflow-hidden flex flex-col",children:[(0,r.jsxs)("div",{className:"px-5 py-4 border-b border-white/5 flex items-center justify-between flex-shrink-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent-teal/10 flex items-center justify-center",children:r.jsx(le,{className:"w-5 h-5 text-accent-teal"})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"Scenario Comparison"}),r.jsx("p",{className:"text-xs text-text-secondary",children:"See how different contexts affect token selection"})]})]}),r.jsx("button",{onClick:()=>i(!1),className:"text-text-tertiary hover:text-white transition-colors",children:r.jsx(rf,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-5",children:[(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("p",{className:"text-xs text-text-tertiary uppercase tracking-wider mb-3",children:"Select Scenarios to Compare"}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:u.map(t=>(0,r.jsxs)("button",{onClick:()=>x(t.id),disabled:a,className:`p-3 rounded-lg text-left transition-all ${d.includes(t.id)?"bg-accent-teal/10 border border-accent-teal/30":"bg-white/5 border border-white/10 hover:bg-white/10"} ${t.id===e?"ring-2 ring-accent-blue/30":""}`,children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[t.icon&&r.jsx("span",{className:"text-lg",children:t.icon}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-white",children:t.name}),r.jsx("p",{className:"text-[10px] text-text-tertiary",children:t.description})]})]}),t.id===e&&r.jsx("span",{className:"text-[9px] text-accent-blue mt-1 block",children:"Current"})]},t.id))})]}),r.jsx("button",{onClick:m,disabled:a||0===d.length,className:"w-full py-3 rounded-lg font-medium text-sm flex items-center justify-center gap-2 bg-accent-teal/20 text-accent-teal border border-accent-teal/30 hover:bg-accent-teal/30 transition-all disabled:opacity-50 mb-6",children:a?(0,r.jsxs)(r.Fragment,{children:[r.jsx(np.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:r.jsx(nS,{className:"w-4 h-4"})}),"Running ",d.length," scenarios..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(nS,{className:"w-4 h-4"}),"Run Comparison (",d.length," selected)"]})}),o.length>0&&(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-xs text-text-tertiary uppercase tracking-wider",children:"Results"}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:Object.entries(p).map(([e,t])=>(0,r.jsxs)("div",{className:"p-3 bg-accent-green/5 border border-accent-green/20 rounded-lg text-center",children:[r.jsx(ri,{className:"w-5 h-5 text-accent-green mx-auto mb-1"}),r.jsx("p",{className:"text-sm font-medium text-white",children:e}),(0,r.jsxs)("p",{className:"text-xs text-accent-green",children:["Won ",t.length,"x"]})]},e))}),r.jsx("div",{className:"space-y-2",children:o.map((e,t)=>(0,r.jsxs)(np.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.05*t},className:"p-3 bg-white/5 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-sm font-medium text-white",children:e.scenarioName}),r.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${e.margin>10?"bg-accent-green/10 text-accent-green":e.margin>5?"bg-accent-orange/10 text-accent-orange":"bg-accent-pink/10 text-accent-pink"}`,children:e.margin>10?"Clear win":e.margin>5?"Moderate":"Close"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 text-xs",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[r.jsx(rb.Z,{className:"w-3 h-3 text-accent-green"}),r.jsx("span",{className:"text-white",children:e.winner}),r.jsx("span",{className:"text-accent-green font-mono",children:e.winnerScore.toFixed(1)})]}),r.jsx(rv,{className:"w-3 h-3 text-text-tertiary"}),(0,r.jsxs)("div",{className:"text-text-secondary",children:[e.runnerUp," (",e.runnerUpScore.toFixed(1),")"]})]})]},e.scenarioId))})]})]})]})]})})]})}function ls({network:e,size:t="sm"}){let s={sm:"w-8 h-5",md:"w-12 h-7",lg:"w-16 h-10"}[t];switch(e){case"visa":return r.jsx("div",{className:`${s} rounded bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center`,children:r.jsx("span",{className:"text-white font-bold italic text-[10px] tracking-tight",children:"VISA"})});case"mastercard":return(0,r.jsxs)("div",{className:`${s} rounded bg-gradient-to-br from-gray-900 to-gray-800 flex items-center justify-center relative overflow-hidden`,children:[r.jsx("div",{className:"absolute w-4 h-4 rounded-full bg-red-500 opacity-90 -left-0.5"}),r.jsx("div",{className:"absolute w-4 h-4 rounded-full bg-yellow-500 opacity-90 left-1.5"})]});case"amex":return r.jsx("div",{className:`${s} rounded bg-gradient-to-br from-cyan-600 to-cyan-800 flex items-center justify-center`,children:r.jsx("span",{className:"text-white font-bold text-[8px] tracking-tight",children:"AMEX"})});case"discover":return r.jsx("div",{className:`${s} rounded bg-gradient-to-br from-orange-500 to-orange-700 flex items-center justify-center`,children:r.jsx("span",{className:"text-white font-bold text-[7px] tracking-tight",children:"DISCOVER"})});default:return r.jsx("div",{className:`${s} rounded bg-gray-700 flex items-center justify-center`,children:r.jsx("span",{className:"text-gray-400 text-[8px]",children:"CARD"})})}}function li({tokens:e,scores:t,selectedTokenId:s}){let i=[...e].sort((e,s)=>{let i=t.find(t=>t.tokenId===e.id)?.finalScore||0;return(t.find(e=>e.tokenId===s.id)?.finalScore||0)-i});return(0,r.jsxs)(np.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-surface-50 rounded-xl border border-white/10 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-4 py-3 border-b border-white/5 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(nV.Z,{className:"w-4 h-4 text-accent-blue"}),r.jsx("h3",{className:"text-sm font-semibold text-white",children:"Your Wallet"})]}),(0,r.jsxs)("span",{className:"text-[10px] text-text-tertiary",children:[e.length," cards"]})]}),r.jsx("div",{className:"p-4 grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3",children:i.map((e,i)=>{let a=t.find(t=>t.tokenId===e.id),n=e.id===s,l=a?.excluded,o=function(e){let t=e.name.toLowerCase();return t.includes("amex")||t.includes("american express")||t.includes("platinum")||t.includes("gold")?"amex":t.includes("mastercard")||t.includes("world")?"mastercard":t.includes("discover")?"discover":"visa"}(e),c=t.filter(e=>!e.excluded).findIndex(t=>t.tokenId===e.id)+1;return(0,r.jsxs)(np.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.05*i},className:`relative group ${l?"opacity-50":""}`,children:[(0,r.jsxs)("div",{className:`
                  relative aspect-[1.6/1] rounded-xl overflow-hidden transition-all duration-300
                  ${n?"ring-2 ring-accent-green shadow-lg shadow-accent-green/20 scale-105":"hover:scale-102 hover:shadow-lg"}
                  ${l?"grayscale":""}
                `,children:[r.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${"visa"===o?"from-blue-900 via-blue-800 to-blue-950":"mastercard"===o?"from-gray-900 via-gray-800 to-gray-950":"amex"===o?"from-slate-700 via-slate-600 to-slate-800":"from-orange-900 via-orange-800 to-orange-950"}`}),(0,r.jsxs)("div",{className:"absolute inset-0 opacity-10",children:[r.jsx("div",{className:"absolute top-3 left-3 w-10 h-7 rounded bg-gradient-to-br from-yellow-400 to-yellow-600"}),r.jsx("div",{className:"absolute top-3 right-3",children:r.jsx(ls,{network:o,size:"sm"})})]}),(0,r.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-3 bg-gradient-to-t from-black/80 via-black/40 to-transparent",children:[r.jsx("p",{className:"text-white text-xs font-medium truncate",children:e.name}),r.jsx("p",{className:"text-white/50 text-[10px] font-mono mt-0.5",children:e.dpan})]}),!l&&c>0&&r.jsx("div",{className:`absolute top-2 left-2 w-6 h-6 rounded-lg flex items-center justify-center text-[10px] font-bold ${1===c?"bg-accent-green text-black":2===c?"bg-white/20 text-white":"bg-black/40 text-white/60"}`,children:1===c?r.jsx(ri,{className:"w-3 h-3"}):c}),n&&r.jsx(np.div,{initial:{scale:0},animate:{scale:1},className:"absolute top-2 right-2 w-6 h-6 rounded-full bg-accent-green flex items-center justify-center",children:r.jsx(rg,{className:"w-4 h-4 text-black"})}),l&&r.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:r.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-error-red/50 flex items-center justify-center bg-black/50",children:r.jsx(rf,{className:"w-5 h-5 text-error-red"})})})]}),a&&!l&&(0,r.jsxs)("div",{className:`mt-2 text-center ${n?"text-accent-green":"text-text-secondary"}`,children:[r.jsx("span",{className:"text-lg font-mono font-bold",children:a.finalScore.toFixed(1)}),r.jsx("span",{className:"text-[10px] text-text-tertiary ml-1",children:"pts"})]}),l&&a?.exclusionReason&&r.jsx("p",{className:"mt-1 text-[9px] text-error-red text-center truncate px-1",children:a.exclusionReason})]},e.id)})}),(0,r.jsxs)("div",{className:"px-4 py-3 border-t border-white/5 bg-black/20 flex items-center justify-center gap-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 rounded bg-accent-green flex items-center justify-center",children:r.jsx(rg,{className:"w-3 h-3 text-black"})}),r.jsx("span",{className:"text-[10px] text-text-tertiary",children:"Selected"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 rounded bg-accent-green/20 flex items-center justify-center",children:r.jsx(ri,{className:"w-3 h-3 text-accent-green"})}),r.jsx("span",{className:"text-[10px] text-text-tertiary",children:"Top Ranked"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 rounded bg-error-red/20 flex items-center justify-center",children:r.jsx(rf,{className:"w-3 h-3 text-error-red"})}),r.jsx("span",{className:"text-[10px] text-text-tertiary",children:"Excluded"})]})]})]})}function la(){return{totalRewardsEarned:0,totalCreditProtected:0,totalOptimized:0,transactionCount:0,approvedCount:0}}function ln({scores:e,selectedTokenId:t,context:s,transactionCount:i}){let[a,n]=(0,l.useState)(la),[o,c]=(0,l.useState)(!0),[d,h]=(0,l.useState)(null),u=e.find(e=>e.tokenId===t),x=u?u.subscores.rewards.normalized/100*s.amount*.02:0,m=u?.subscores.credit.normalized||0,p=e.filter(e=>!e.excluded).sort((e,t)=>e.finalScore-t.finalScore)[0],g=u&&p?u.finalScore-p.finalScore:0;return(0,r.jsxs)(np.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-accent-purple/10 via-surface-50 to-accent-blue/10 rounded-xl border border-white/10 overflow-hidden",children:[(0,r.jsxs)("button",{onClick:()=>c(!o),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-white/5 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(rE,{className:"w-4 h-4 text-accent-purple"}),r.jsx("h3",{className:"text-sm font-semibold text-white",children:"Session Rewards"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("span",{className:"text-xs text-text-secondary",children:[a.transactionCount," transactions"]}),o?r.jsx(rp,{className:"w-4 h-4 text-text-tertiary"}):r.jsx(nL,{className:"w-4 h-4 text-text-tertiary"})]})]}),r.jsx(nw,{children:o&&r.jsx(np.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:(0,r.jsxs)("div",{className:"px-4 pb-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[(0,r.jsxs)("div",{className:"p-3 bg-accent-green/10 rounded-xl border border-accent-green/20 text-center relative overflow-hidden",children:[r.jsx(rX,{className:"w-5 h-5 text-accent-green mx-auto mb-1"}),(0,r.jsxs)(np.p,{initial:{scale:1.2},animate:{scale:1},className:"text-xl font-mono font-bold text-accent-green",children:["$",a.totalRewardsEarned.toFixed(2)]},a.totalRewardsEarned),r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Rewards Value"}),d?.field==="rewards"&&(0,r.jsxs)(np.div,{initial:{opacity:1,y:0},animate:{opacity:0,y:-20},className:"absolute top-1 right-1 text-[10px] text-accent-green font-mono",children:["+$",d.delta.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"p-3 bg-accent-teal/10 rounded-xl border border-accent-teal/20 text-center",children:[r.jsx(ra.Z,{className:"w-5 h-5 text-accent-teal mx-auto mb-1"}),r.jsx("p",{className:"text-xl font-mono font-bold text-accent-teal",children:a.totalCreditProtected}),r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Credit Protected"})]}),(0,r.jsxs)("div",{className:"p-3 bg-accent-purple/10 rounded-xl border border-accent-purple/20 text-center",children:[r.jsx(rb.Z,{className:"w-5 h-5 text-accent-purple mx-auto mb-1"}),(0,r.jsxs)("p",{className:"text-xl font-mono font-bold text-accent-purple",children:["+",a.totalOptimized.toFixed(0)]}),r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Pts Optimized"})]})]}),u&&(0,r.jsxs)("div",{className:"p-3 bg-black/20 rounded-lg mb-3",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase tracking-wider mb-2",children:"This Transaction"}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[r.jsx(rX,{className:"w-3 h-3 text-accent-green"}),(0,r.jsxs)("span",{className:"text-xs text-white font-mono",children:["+$",x.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[r.jsx(ra.Z,{className:"w-3 h-3 text-accent-teal"}),(0,r.jsxs)("span",{className:"text-xs text-white font-mono",children:[m.toFixed(0),"%"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[r.jsx(rb.Z,{className:"w-3 h-3 text-accent-purple"}),(0,r.jsxs)("span",{className:"text-xs text-white font-mono",children:["+",g.toFixed(1)]})]})]}),r.jsx("span",{className:"text-xs text-accent-green font-medium",children:u.tokenName})]})]}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsxs)("div",{className:"flex justify-between text-[10px] text-text-tertiary mb-1",children:[r.jsx("span",{children:"Session Progress"}),(0,r.jsxs)("span",{children:[a.approvedCount," approved"]})]}),r.jsx("div",{className:"h-2 bg-black/30 rounded-full overflow-hidden",children:r.jsx(np.div,{initial:{width:0},animate:{width:`${Math.min(100,a.approvedCount/10*100)}%`},className:"h-full bg-gradient-to-r from-accent-green via-accent-teal to-accent-purple rounded-full"})})]}),r.jsx("button",{onClick:()=>{n({totalRewardsEarned:0,totalCreditProtected:0,totalOptimized:0,transactionCount:0,approvedCount:0})},className:"w-full py-2 text-[10px] text-text-tertiary hover:text-white transition-colors",children:"Reset Session Stats"})]})})})]})}function lr({type:e}){let t={initial:{x:"-100%"},animate:{x:"100%"},transition:{repeat:1/0,duration:1.5,ease:"linear"}};return"banner"===e?(0,r.jsxs)("div",{className:"bg-surface-50 rounded-xl border border-white/10 p-4 overflow-hidden relative",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/5"}),(0,r.jsxs)("div",{className:"flex-1 space-y-2",children:[r.jsx("div",{className:"h-4 bg-white/5 rounded w-1/3"}),r.jsx("div",{className:"h-3 bg-white/5 rounded w-2/3"})]})]}),r.jsx(np.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent",...t})]}):"card"===e?(0,r.jsxs)("div",{className:"bg-surface-50 rounded-xl border border-white/10 overflow-hidden relative",children:[r.jsx("div",{className:"px-4 py-3 border-b border-white/5",children:r.jsx("div",{className:"h-4 bg-white/5 rounded w-1/4"})}),(0,r.jsxs)("div",{className:"p-4 space-y-3",children:[r.jsx("div",{className:"h-8 bg-white/5 rounded"}),r.jsx("div",{className:"h-4 bg-white/5 rounded w-3/4"}),r.jsx("div",{className:"h-4 bg-white/5 rounded w-1/2"})]}),r.jsx(np.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent",...t})]}):"chart"===e?(0,r.jsxs)("div",{className:"bg-surface-50 rounded-xl border border-white/10 overflow-hidden relative",children:[r.jsx("div",{className:"px-4 py-3 border-b border-white/5",children:r.jsx("div",{className:"h-4 bg-white/5 rounded w-1/3"})}),r.jsx("div",{className:"p-4 space-y-4",children:[1,2,3].map(e=>(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("div",{className:"h-3 bg-white/5 rounded w-24"}),r.jsx("div",{className:"h-3 bg-white/5 rounded w-12"})]}),r.jsx("div",{className:"h-6 bg-white/5 rounded",style:{width:`${90-20*e}%`}})]},e))}),r.jsx(np.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent",...t})]}):(0,r.jsxs)("div",{className:"bg-surface-50 rounded-xl border border-white/10 overflow-hidden relative",children:[r.jsx("div",{className:"p-4 space-y-3",children:[1,2,3,4].map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 rounded-lg bg-white/5"}),(0,r.jsxs)("div",{className:"flex-1 space-y-1",children:[r.jsx("div",{className:"h-3 bg-white/5 rounded w-1/2"}),r.jsx("div",{className:"h-2 bg-white/5 rounded w-1/3"})]}),r.jsx("div",{className:"h-4 bg-white/5 rounded w-12"})]},e))}),r.jsx(np.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent",...t})]})}function ll(){return(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx(lr,{type:"banner"}),r.jsx(lr,{type:"card"}),r.jsx(lr,{type:"chart"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(lr,{type:"list"}),r.jsx(lr,{type:"list"})]})]})}let lo=(0,nk.Z)("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]),lc=(0,nk.Z)("Command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]),ld=[{key:"Space / Enter",description:"Run pipeline",category:"execution"},{key:"R",description:"Replay with same seed",category:"execution"},{key:"N",description:"Generate new seed",category:"execution"},{key:"1",description:"Normal speed",category:"speed"},{key:"2",description:"Fast speed",category:"speed"},{key:"3",description:"Turbo speed",category:"speed"},{key:"T",description:"Export trace JSON",category:"export"},{key:"A",description:"Export audit JSON",category:"export"},{key:"Esc",description:"Close modals/panels",category:"navigation"},{key:"?",description:"Show keyboard shortcuts",category:"navigation"}],lh={execution:"Execution",navigation:"Navigation",export:"Export",speed:"Speed Control"},lu={execution:"accent-green",navigation:"accent-blue",export:"accent-purple",speed:"accent-orange"};function lx({isOpen:e,onClose:t}){let s=ld.reduce((e,t)=>(e[t.category]||(e[t.category]=[]),e[t.category].push(t),e),{});return r.jsx(nw,{children:e&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(np.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50",onClick:t}),(0,r.jsxs)(np.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-lg bg-surface-50 rounded-2xl border border-white/10 shadow-2xl z-50 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-5 py-4 border-b border-white/5 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent-blue/10 flex items-center justify-center",children:r.jsx(lo,{className:"w-5 h-5 text-accent-blue"})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"Keyboard Shortcuts"}),r.jsx("p",{className:"text-xs text-text-secondary",children:"Quick actions to speed up your workflow"})]})]}),r.jsx("button",{onClick:t,className:"text-text-tertiary hover:text-white transition-colors",children:r.jsx(rf,{className:"w-5 h-5"})})]}),r.jsx("div",{className:"p-5 space-y-5 max-h-[60vh] overflow-y-auto",children:Object.entries(s).map(([e,t])=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx("div",{className:`w-2 h-2 rounded-full bg-${lu[e]}`}),r.jsx("span",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider",children:lh[e]})]}),r.jsx("div",{className:"space-y-2",children:t.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors",children:[r.jsx("span",{className:"text-sm text-text-secondary",children:e.description}),r.jsx("div",{className:"flex items-center gap-1",children:e.key.split(" / ").map((e,t)=>(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[t>0&&r.jsx("span",{className:"text-text-tertiary text-xs mx-1",children:"/"}),r.jsx("kbd",{className:"px-2 py-1 bg-surface-100 border border-white/10 rounded text-xs font-mono text-white",children:e})]},t))})]},e.key))})]},e))}),r.jsx("div",{className:"px-5 py-3 border-t border-white/5 bg-black/20",children:(0,r.jsxs)("p",{className:"text-[10px] text-text-tertiary text-center",children:["Press ",r.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface-100 border border-white/10 rounded text-[10px] font-mono",children:"?"})," anytime to toggle this panel"]})})]})]})})}function lm({onClick:e}){return r.jsx("button",{onClick:e,className:"p-1.5 text-text-tertiary hover:text-white transition-colors",title:"Keyboard shortcuts (?)",children:r.jsx(lc,{className:"w-4 h-4"})})}let lp=(0,nk.Z)("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]),lg=(0,nk.Z)("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]),lf=(0,nk.Z)("Equal",[["line",{x1:"5",x2:"19",y1:"9",y2:"9",key:"1nwqeh"}],["line",{x1:"5",x2:"19",y1:"15",y2:"15",key:"g8yjpy"}]]);class ly{constructor(e){this.initialSeed=e,this.state=e}next(){let e=this.state+=1831565813;return e=Math.imul(e^e>>>15,1|e),(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296}random(){return this.next()}randomInt(e,t){return Math.floor(this.next()*(t-e+1))+e}randomFloat(e,t){return this.next()*(t-e)+e}randomBool(e=.5){return this.next()<e}pick(e){return e[Math.floor(this.next()*e.length)]}shuffle(e){let t=[...e];for(let e=t.length-1;e>0;e--){let s=Math.floor(this.next()*(e+1));[t[e],t[s]]=[t[s],t[e]]}return t}getLatency(e,t){return Math.round(e+Math.pow(this.next(),.8)*(t-e))}generateCorrelationId(){let e="";for(let t=0;t<32;t++)(8===t||12===t||16===t||20===t)&&(e+="-"),e+="0123456789abcdef"[Math.floor(16*this.next())];return e}getRiskScore(e,t=15){return Math.max(0,Math.min(100,e+(this.next()-.5)*2*t))}getDeclineProbability(e){return Math.max(0,Math.min(1,e/100*.8+(.1*this.next()-.05)))}simulateAuthResult(e){return this.next()>e}reset(){this.state=this.initialSeed}getSeed(){return this.initialSeed}}function lv(){return Math.floor(2147483647*Math.random())}function lb(e){return function(e){let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+e.charCodeAt(s),t&=t;let s=Math.abs(t).toString(16).padStart(8,"0");return`sha256:${s}${s}${s.slice(0,8)}`}(JSON.stringify(e.map(e=>({id:e.id,type:e.type,priority:e.priority,condition:e.condition,action:e.action}))))}let lj={currentVersion:"2.0.0",pinnedVersion:void 0,versions:(()=>{let e=nU.slice(0,5),t=nU.slice(0,7),s=[...nU];return[{version:"1.0.0",effectiveDate:Date.now()-7776e6,signatureHash:lb(e),rules:e,description:"Initial policy release - basic routing rules",isCached:!1},{version:"1.1.0",effectiveDate:Date.now()-3888e6,signatureHash:lb(t),rules:t,description:"Added travel and gas station rules",isCached:!1},{version:"2.0.0",effectiveDate:Date.now()-6048e5,signatureHash:lb(s),rules:s,description:"Major update - complete rule set with boost/penalize actions",isCached:!0}]})(),lastFetchedAt:Date.now()};function lw(){let e=lj.pinnedVersion||lj.currentVersion,t=lj.versions.find(t=>t.version===e);if(!t)throw Error(`Policy version ${e} not found`);return t}function lN(){return void 0!==lj.pinnedVersion}function lk(e){if(Array.isArray(e))return`[${e.join(", ")}]`;if("string"==typeof e)return`"${e}"`;if("object"==typeof e&&null!==e){if("gt"in e)return`> ${e.gt}`;if("lt"in e)return`< ${e.lt}`;if("gte"in e)return`>= ${e.gte}`;if("lte"in e)return`<= ${e.lte}`}return String(e)}function lS(e){return{rule:e,predicate:function e(t){return(s,i,a)=>{let n=function(e,t,s,i,a){switch(t){case"eq":return e===s;case"neq":return e!==s;case"in":if(Array.isArray(s))return s.includes(e);return!1;case"not_in":if(Array.isArray(s))return!s.includes(e);return!0;case"gt":return"number"==typeof e&&"number"==typeof s&&e>s;case"lt":return"number"==typeof e&&"number"==typeof s&&e<s;case"gte":return"number"==typeof e&&"number"==typeof s&&e>=s;case"lte":return"number"==typeof e&&"number"==typeof s&&e<=s;case"contains":if("string"==typeof e&&"string"==typeof s)return e.toLowerCase().includes(s.toLowerCase());if(Array.isArray(e))return e.includes(s);return!1;default:return!1}}(function(e,t,s,i){if(e in t)return t[e];switch(e){case"projected_utilization":if("credit"===s.type&&s.limit>0)return(s.balance+t.amount)/s.limit;return 0;case"has_active_signup_bonus":return s.signupBonus&&s.signupBonus.current<s.signupBonus.threshold;case"signup_bonus_remaining":if(s.signupBonus)return s.signupBonus.threshold-s.signupBonus.current;return 0;case"network_acceptance_risk":if("discover"===s.network)return"high";if("amex"===s.network)return"medium";return"low";case"debit_balance_low":if("debit"===s.type)return s.balance<2*t.amount;return!1;case"category_reward_rate":let a=t.category||"default";return s.rewardsByCategory[a]||s.rewardsByCategory.default||0;case"days_to_paycheck":return i.daysToPaycheck;case"cash_balance":return i.cashBalance;default:if(e in s)return s[e];if(e.includes(".")){let t=e.split("."),i=s;for(let e of t){if(!i||"object"!=typeof i)return;i=i[e]}return i}return}}(t.field,s,i,a),t.operator,t.value,0,0);if(t.and&&t.and.length>0){let r=t.and.map(t=>e(t)(s,i,a));return n&&r.every(e=>e)}if(t.or&&t.or.length>0){let r=t.or.map(t=>e(t)(s,i,a));return n||r.some(e=>e)}return n}}(e.condition),dslSnippet:e.compiledDSL||function(e){let t=function e(t){var s;let i=t.field,a={eq:"=",neq:"!=",in:"IN",not_in:"NOT IN",gt:">",lt:"<",gte:">=",lte:"<=",contains:"CONTAINS"}[s=t.operator]||s,n=lk(t.value),r=`${i} ${a} ${n}`;if(t.and&&t.and.length>0){let s=t.and.map(t=>e(t));r=`(${r} AND ${s.join(" AND ")})`}if(t.or&&t.or.length>0){let s=t.or.map(t=>e(t));r=`(${r} OR ${s.join(" OR ")})`}return r}(e.condition),s=function(e){switch(e.type){case"FORCE":return`FORCE ${e.targetTokenId||"token"}`;case"EXCLUDE":if(e.targetTokenProperty)return`EXCLUDE tokens WHERE ${e.targetTokenProperty} ${lk(e.targetPropertyValue)}`;return"EXCLUDE token";case"BOOST":return`BOOST score +${e.boostAmount||0}`;case"PENALIZE":return`PENALIZE score -${e.penaltyAmount||0}`;case"BLOCK":return"BLOCK transaction";default:return e.type}}(e.action);return`IF ${t} THEN ${s}`}(e)}}function lC(e){return e.filter(e=>e.enabled).sort((e,t)=>e.priority-t.priority).map(lS)}function lR(e,t){let s=e.action;if(!s.targetTokenProperty)return!0;let i=t[s.targetTokenProperty],a=s.targetPropertyValue;if("object"==typeof a&&null!==a){if("gt"in a)return i>a.gt;if("lt"in a)return i<a.lt}return i===a}let lT={vetoThreshold:.75,amountThresholds:{low:100,medium:500,high:1500}};function lP(e,t,s,i){let a=new Map;for(let n of e)a.set(n.id,function(e,t,s,i,a=lT){let n=[],r=0;if(t.amount>a.amountThresholds.high?(r+=20,n.push(`High amount ($${t.amount.toFixed(0)})`)):t.amount>a.amountThresholds.medium?(r+=10,n.push(`Medium amount ($${t.amount.toFixed(0)})`)):t.amount>a.amountThresholds.low&&(r+=3),"US"!==t.country&&(r+=12,n.push(`International (${t.country})`)),t.isInPerson||(r+=8,n.push("Card not present")),t.riskFlags.includes("high_amount")&&(r+=10,n.push("Amount anomaly")),t.riskFlags.includes("new_merchant")&&(r+=12,n.push("New merchant")),t.riskFlags.includes("velocity_spike")&&(r+=18,n.push("Velocity spike")),t.riskFlags.includes("geo_anomaly")&&(r+=15,n.push("Geographic anomaly")),t.riskFlags.includes("time_anomaly")&&(r+=6,n.push("Unusual time")),t.riskFlags.includes("device_change")&&(r+=12,n.push("New device")),"credit"===e.type){let s=(e.balance+t.amount)/e.limit;s>.9?(r+=15,n.push("Near credit limit")):s>.7&&(r+=8,n.push("High utilization"))}"debit"===e.type&&e.balance<1.5*t.amount&&(r+=12,n.push("Low debit balance")),"discover"===e.network&&(r+=4,n.push("Lower network acceptance")),"amex"===e.network&&"US"!==t.country&&(r+=6,n.push("Amex international")),r*="low"===s.riskTolerance?1.15:"high"===s.riskTolerance?.85:1;let l=Math.max(0,Math.min(1,(r+=(i.random()-.5)*10)/100)),o=(i.random()-.5)*.05,c=l>=a.vetoThreshold,d=c?`Risk ${(100*l).toFixed(1)}% exceeds threshold ${(100*a.vetoThreshold).toFixed(0)}%`:void 0;return{tokenId:e.id,riskScore:Math.round(1e3*l)/1e3,declineProbability:Math.round(1e3*Math.max(0,Math.min(1,l+o)))/1e3,riskFactors:n,vetoRecommendation:c,vetoReason:d}}(n,t,s,i));return a}function lM(e,t,s){return Math.max(t,Math.min(s,e))}function lD(e){return Math.round(100*e)/100}function lA(e,t,s){let i={raw:0,normalized:0,weight:0,weighted:0,factors:[]};return{tokenId:e.id,tokenName:e.name,subscores:{rewards:i,credit:i,cashflow:i,risk:i},bonuses:[],penalties:[],totalBonuses:0,totalPenalties:0,baseScore:0,finalScore:0,ranking:999,excluded:!0,exclusionReason:t,exclusionStage:s}}function lE(e,t,s,i,a,n){let r=[],l=function(e){let t=e.rewards+e.credit+e.cashflow+e.risk;return 0===t?{rewards:.25,credit:.25,cashflow:.25,risk:.25}:{rewards:e.rewards/t,credit:e.credit/t,cashflow:e.cashflow/t,risk:e.risk/t}}(s.preferenceWeights);for(let o of e){if(!o.isEligible&&o.id!==n){r.push(lA(o,"Token not eligible","Profile Fetch"));continue}let e=i.excludedTokens.get(o.id);if(e&&o.id!==n){r.push(lA(o,e,"Rule Evaluation"));continue}let c=a.get(o.id);if(c?.vetoRecommendation&&!i.hardRuleOverride&&o.id!==n){r.push(lA(o,c.vetoReason||"Risk veto","Candidate Filtering"));continue}let d=function(e,t){let s=[],i=t.category||"default",a=e.rewardsByCategory[i]||e.rewardsByCategory.default||0;s.push(`Category "${i}" rate: ${a}x`);let n=15*a;if(e.signupBonus){let i=e.signupBonus.threshold-e.signupBonus.current;i>0&&t.amount<=1.5*i&&(n+=20,s.push(`Signup bonus: $${i} remaining to earn ${e.signupBonus.reward} pts`))}e.cashbackRate>0&&(n+=5*e.cashbackRate,s.push(`Base cashback: ${e.cashbackRate}%`));let r=lM(n,0,100);return{raw:lD(n),normalized:lD(r),weight:0,weighted:0,factors:s}}(o,t),h=function(e,t){let s;let i=[];if("credit"!==e.type)return i.push("Non-credit card: neutral score"),{raw:50,normalized:50,weight:0,weighted:0,factors:i};let a=(e.balance+t.amount)/e.limit;i.push(`Current utilization: ${(100*e.utilization).toFixed(1)}%`),i.push(`Projected utilization: ${(100*a).toFixed(1)}%`),a<=.1?(s=100,i.push("Excellent: under 10% utilization")):a<=.3?(s=90-(a-.1)*100,i.push("Good: under 30% utilization")):a<=.5?(s=70-(a-.3)*100,i.push("Fair: under 50% utilization")):a<=.7?(s=50-(a-.5)*150,i.push("Warning: approaching high utilization")):a<=.9?(s=20-(a-.7)*50,i.push("Critical: high utilization impact")):(s=5,i.push("Near limit: severe credit impact"));let n=lM(s,0,100);return{raw:lD(s),normalized:lD(n),weight:0,weighted:0,factors:i}}(o,t),u=function(e,t,s){let i;let a=[];if("debit"===e.type){let s=e.balance-t.amount;if(a.push(`Balance: $${e.balance.toFixed(2)}`),a.push(`After txn: $${s.toFixed(2)}`),s<0)i=0,a.push("Insufficient funds");else{let e=s/t.amount;e>=5?(i=95,a.push("Excellent buffer (5x+)")):e>=3?(i=80,a.push("Good buffer (3-5x)")):e>=2?(i=65,a.push("Adequate buffer (2-3x)")):e>=1?(i=45,a.push("Tight buffer (1-2x)")):(i=25,a.push("Low buffer (<1x)"))}}else"credit"===e.type?(a.push(`Days to paycheck: ${s.daysToPaycheck}`),a.push(`APR: ${e.apr}%`),s.daysToPaycheck<=3?(i=95,a.push("Paycheck imminent: credit ideal")):s.daysToPaycheck<=7?(i=85,a.push("Paycheck soon: credit preferred")):s.daysToPaycheck<=14?(i=70,a.push("Mid-cycle: credit acceptable")):(i=55,a.push("Early cycle: consider APR cost")),e.apr>25&&(i-=10,a.push("High APR penalty"))):(i=50,a.push("Prepaid: neutral cashflow"));let n=lM(i,0,100);return{raw:lD(i),normalized:lD(n),weight:0,weighted:0,factors:a}}(o,t,s),x=function(e){let t=[];if(!e)return{raw:50,normalized:50,weight:0,weighted:0,factors:["No risk assessment available"]};let s=(1-e.riskScore)*100;t.push(`Risk score: ${(100*e.riskScore).toFixed(1)}%`),t.push(`Decline probability: ${(100*e.declineProbability).toFixed(1)}%`),e.riskFactors.length>0&&t.push(...e.riskFactors.slice(0,3).map(e=>` ${e}`)),e.vetoRecommendation&&t.push(" VETO RECOMMENDED");let i=lM(s,0,100);return{raw:lD(s),normalized:lD(i),weight:0,weighted:0,factors:t}}(c);d.weight=l.rewards,d.weighted=lD(d.normalized*l.rewards),h.weight=l.credit,h.weighted=lD(h.normalized*l.credit),u.weight=l.cashflow,u.weighted=lD(u.normalized*l.cashflow),x.weight=l.risk,x.weighted=lD(x.normalized*l.risk);let m=lD(d.weighted+h.weighted+u.weighted+x.weighted),p=[],g=[],f=i.boosts.get(o.id);f&&p.push({label:"Rule boost",amount:f,ruleId:i.boostRuleIds?.get(o.id)});let y=i.penalties.get(o.id);y&&g.push({label:"Rule penalty",amount:y,ruleId:i.penaltyRuleIds?.get(o.id)});let v=p.reduce((e,t)=>e+t.amount,0),b=g.reduce((e,t)=>e+t.amount,0),j=lM(m+v-b,0,100);r.push({tokenId:o.id,tokenName:o.name,subscores:{rewards:d,credit:h,cashflow:u,risk:x},bonuses:p,penalties:g,totalBonuses:v,totalPenalties:b,baseScore:m,finalScore:lD(j),ranking:0,excluded:!1})}let o=r.filter(e=>!e.excluded);return o.sort((e,t)=>t.finalScore-e.finalScore),o.forEach((e,t)=>{e.ranking=t+1}),{scores:r,topCandidate:o[0]||null,candidateCount:o.length,excludedCount:r.filter(e=>e.excluded).length,weightsUsed:l}}function lF(e){return"drt"===e.type&&"childDPANs"in e}class l${constructor(e,t="normal"){this.speedMode="normal",this.pipelineStartTime=0,this.currentOffset=0,this.stageLogs=[],this.spans=[],this.stageResults=[],this.errors=[],this.correlationId="",this.context=null,this.user=null,this.rules=[],this.rulesResult=null,this.riskAssessments=new Map,this.scoringResult=null,this.selectedTokenId=null,this.drtResolution=null,this.authResult=null,this.policyCacheHit=!1,this.seed=e??lv(),this.prng=new ly(this.seed),this.speedMode=t}setSpeedMode(e){this.speedMode=e}getSeed(){return this.seed}getCorrelationId(){return this.correlationId}log(e,t,s,i){let a=this.currentOffset+this.prng.randomInt(1,3);this.stageLogs.push({timestamp:this.pipelineStartTime+a,offsetMs:a,correlationId:this.correlationId,stage:t,level:e,message:s,tokenId:i})}getLatency(e){let t=n3[e];return this.prng.getLatency(t[0],t[1])}async runStage(e,t,s,i){let a=this.getLatency(t),n=this.currentOffset,r=n+a;this.currentOffset=r,this.stageLogs=[];let l=performance.now();await this.delay(a);try{let o=await s(),c=performance.now(),d=o.status||"completed",h=this.stageLogs.filter(e=>e.offsetMs>=n&&e.offsetMs<=r),u={stageName:t,stageIndex:e,status:d,startTime:this.pipelineStartTime+n,endTime:this.pipelineStartTime+r,startOffset:n,endOffset:r,durationMs:a,actualDurationMs:c-l,inputs:o.inputs,outputs:o.outputs,logs:h,errors:[]};return this.stageResults.push(u),this.spans.push({spanId:`span_${this.prng.randomInt(1e4,99999)}`,operationName:t,startTime:u.startTime,endTime:u.endTime,startOffset:n,endOffset:r,durationMs:a,status:d,tags:{correlationId:this.correlationId},logs:h}),i&&i(u,e),u}catch(d){let s=performance.now(),o=d instanceof Error?d.message:"Unknown error",c={stageName:t,stageIndex:e,status:"error",startTime:this.pipelineStartTime+n,endTime:this.pipelineStartTime+r,startOffset:n,endOffset:r,durationMs:a,actualDurationMs:s-l,inputs:{},outputs:{},logs:this.stageLogs,errors:[{code:"STAGE_ERROR",message:o}]};return this.stageResults.push(c),i&&i(c,e),c}}delay(e){let t="turbo"===this.speedMode?1/0:"fast"===this.speedMode?32:8,s=t===1/0?0:Math.max(1,e/t);return new Promise(e=>setTimeout(e,s))}async runPipeline(e,t,s){let i;this.prng=new ly(this.seed),this.pipelineStartTime=Date.now(),this.currentOffset=0,this.correlationId=this.prng.generateCorrelationId(),this.stageResults=[],this.spans=[],this.errors=[],this.user=t;let a=[...t.tokens,...t.drtTokens],n=lw();await this.runStage(0,"Ingest Event",async()=>(this.log("info","Ingest Event",`Received: ${e.merchant} $${e.amount}`),{inputs:{rawEvent:e},outputs:{acknowledged:!0,correlationId:this.correlationId}}),s),await this.runStage(1,"Context Extraction",async()=>(this.context={...e,correlationId:this.correlationId,timestamp:Date.now()},this.log("info","Context Extraction",`Extracted: $${this.context.amount}, MCC=${this.context.mcc}, ${this.context.country}`),{inputs:{rawContext:e},outputs:{enrichedContext:this.context}}),s),await this.runStage(2,"Profile Fetch",async()=>(this.log("info","Profile Fetch",`Loaded ${t.tokens.length} tokens, ${t.drtTokens.length} DRTs`),{inputs:{userId:t.id},outputs:{tokenCount:a.length}}),s),await this.runStage(3,"Policy Load (Registry)",async()=>(this.rules=n.rules,this.policyCacheHit=n.isCached,this.log("info","Policy Load (Registry)",`v${n.version} ${this.policyCacheHit?"[CACHE HIT]":"[FETCHED]"}${lN()?" [PINNED]":""}`),{inputs:{},outputs:{version:n.version,cacheHit:this.policyCacheHit,signature:n.signatureHash}}),s),await this.runStage(4,"Rule Compile",async()=>{let e=lC(this.rules);return this.log("info","Rule Compile",`Compiled ${e.length} rules`),{inputs:{ruleCount:this.rules.length},outputs:{compiledCount:e.length}}},s),await this.runStage(5,"Rule Evaluation",async()=>(this.rulesResult=function(e,t,s,i){let a=lC(e),n={hardRuleOverride:!1,excludedTokens:new Map,excludedTokensList:[],violationsOverridden:[],boosts:new Map,boostRuleIds:new Map,penalties:new Map,penaltyRuleIds:new Map,matchedRules:[],failedRules:[]},r=new Map;for(let e of a){var l;if((l=e.rule).expiry&&Date.now()>l.expiry){n.failedRules.push({ruleId:e.rule.id,ruleLabel:e.rule.label,ruleType:e.rule.type,matched:!1,reason:"Rule has expired",dslSnippet:e.dslSnippet});continue}let a=!1,o=e.rule;for(let l of s)if(l.isEligible&&e.predicate(t,l,i))switch(a=!0,o.action.type){case"FORCE":"HARD"===o.type&&(n.hardRuleOverride=!0,n.forcedToken=o.action.targetTokenId,n.forcedTokenName=s.find(e=>e.id===o.action.targetTokenId)?.name,n.forcingRule={ruleId:o.id,ruleLabel:o.label});break;case"EXCLUDE":(function(e,t){let s=e.action;if(!s.targetTokenProperty)return!0;let i=t[s.targetTokenProperty],a=s.targetPropertyValue;if("object"==typeof a&&null!==a){if("gt"in a)return i>a.gt;if("lt"in a)return i<a.lt;if("gte"in a)return i>=a.gte;if("lte"in a)return i<=a.lte}return i===a})(o,l)&&r.set(l.id,{reason:o.action.reason,ruleId:o.id,tokenName:l.name});break;case"BOOST":if(lR(o,l)){let e=n.boosts.get(l.id)||0;n.boosts.set(l.id,e+(o.action.boostAmount||0)),n.boostRuleIds.set(l.id,o.id)}break;case"PENALIZE":if(lR(o,l)){let e=n.penalties.get(l.id)||0;n.penalties.set(l.id,e+(o.action.penaltyAmount||0)),n.penaltyRuleIds.set(l.id,o.id)}break;case"BLOCK":r.set(l.id,{reason:"Transaction blocked by rule",ruleId:o.id,tokenName:l.name})}!a&&e.predicate(t,{id:"dummy",name:"Dummy",dpan:"**** 0000",type:"credit",network:"visa",limit:0,balance:0,utilization:0,apr:0,ftf:0,blockedMCCs:[],rewardsByCategory:{},isEligible:!0,cashbackRate:0},i)&&(a=!0),a?n.matchedRules.push({ruleId:o.id,ruleLabel:o.label,ruleType:o.type,matched:!0,reason:o.action.reason,action:o.action.type,forcedToken:"FORCE"===o.action.type?o.action.targetTokenId:void 0,dslSnippet:e.dslSnippet}):n.failedRules.push({ruleId:o.id,ruleLabel:o.label,ruleType:o.type,matched:!1,reason:"Condition not satisfied",dslSnippet:e.dslSnippet})}for(let[e,t]of Array.from(r.entries()))n.hardRuleOverride&&e===n.forcedToken?n.violationsOverridden.push({tokenId:e,tokenName:t.tokenName,violationType:"EXCLUSION_OVERRIDE",constraint:t.reason,overriddenBy:n.forcingRule?.ruleLabel||"Hard Rule",ruleId:t.ruleId,severity:"warning"}):(n.excludedTokens.set(e,t.reason),n.excludedTokensList.push({tokenId:e,tokenName:t.tokenName,reason:t.reason,ruleId:t.ruleId,stage:"Rule Evaluation"}));return n}(this.rules,this.context,a,t),this.log("info","Rule Evaluation",`Matched: ${this.rulesResult.matchedRules.length}`),this.rulesResult.hardRuleOverride&&this.log("warn","Rule Evaluation",`HARD OVERRIDE: ${this.rulesResult.forcingRule?.ruleLabel}`),{inputs:{},outputs:{hardOverride:this.rulesResult.hardRuleOverride,forcedToken:this.rulesResult.forcedToken}}),s),await this.runStage(6,"Candidate Filtering",async()=>{this.riskAssessments=lP(a,this.context,t,this.prng);let e=this.rulesResult.excludedTokensList.length;return this.log("info","Candidate Filtering",`${a.length-e} candidates (${e} excluded)`),{inputs:{},outputs:{excludedCount:e}}},s),await this.runStage(7,"Optimization Scoring",async()=>(this.scoringResult=lE(a,this.context,t,this.rulesResult,this.riskAssessments,this.rulesResult?.forcedToken),this.log("info","Optimization Scoring",`Top: ${this.scoringResult.topCandidate?.tokenName} (${this.scoringResult.topCandidate?.finalScore.toFixed(1)}/100)`),{inputs:{},outputs:{topScore:this.scoringResult.topCandidate?.finalScore}}),s);let r=this.scoringResult.topCandidate;await this.runStage(8,"Route Selection",async()=>{var e,t;this.selectedTokenId=(e=this.scoringResult,(t=this.rulesResult).hardRuleOverride&&t.forcedToken?t.forcedToken:e.topCandidate?.tokenId||null);let s=a.find(e=>e.id===this.selectedTokenId);return this.rulesResult.hardRuleOverride&&r&&r.tokenId!==this.selectedTokenId&&(i={wouldHaveSelected:r.tokenId,wouldHaveSelectedName:r.tokenName,wouldHaveScore:r.finalScore,actualSelected:this.selectedTokenId,actualSelectedName:s?.name||"",actualScore:this.scoringResult.scores.find(e=>e.tokenId===this.selectedTokenId)?.finalScore||0,reason:`Hard rule override by ${this.rulesResult.forcingRule?.ruleLabel}`},this.log("warn","Route Selection",`Shadow winner: ${r.tokenName} (${r.finalScore.toFixed(1)})`)),this.log("info","Route Selection",`Selected: ${s?.name}`),{inputs:{},outputs:{selectedToken:this.selectedTokenId,isDRT:!!s&&lF(s)}}},s);let l=a.find(e=>e.id===this.selectedTokenId),o=!!l&&lF(l);await this.runStage(9,"DRT Resolution",async()=>o&&l?(this.drtResolution=function(e,t,s,i,a){let n,r;let l=e.childDPANs.filter(e=>e.isEligible);if(0===l.length)throw Error(`DRT ${e.id} has no eligible child DPANs`);let o=[];switch(e.routingStrategy){case"optimal_score":{let e=lP(l,t,s,a),c=lE(l,t,s,i,e);o=c.scores,c.topCandidate?(n=l.find(e=>e.id===c.topCandidate.tokenId),r=`Optimal score: ${c.topCandidate.finalScore.toFixed(2)}`):(n=l[0],r="Fallback: no scored candidates");break}case"round_robin":{let e=a.randomInt(0,l.length-1);n=l[e],r=`Round robin: index ${e}`;let c=lP(l,t,s,a);o=lE(l,t,s,i,c).scores;break}case"lowest_utilization":{n=[...l].sort((e,t)=>e.utilization-t.utilization)[0],r=`Lowest utilization: ${(100*n.utilization).toFixed(1)}%`;let e=lP(l,t,s,a);o=lE(l,t,s,i,e).scores;break}default:n=l[0],r="Default: first eligible child"}return{resolution:{drtId:e.id,selectedChild:n,childScores:o,resolutionReason:r,timestamp:Date.now()},childScores:o,selectedChild:n}}(l,this.context,t,this.rulesResult,this.prng),this.log("info","DRT Resolution",`Resolved  ${this.drtResolution.selectedChild.name}`),{inputs:{},outputs:{selectedChild:this.drtResolution.selectedChild.id}}):(this.log("info","DRT Resolution","Skipped (not DRT)"),{inputs:{},outputs:{skipped:!0},status:"skipped"}),s),await this.runStage(10,"DPAN Swap / Injection",async()=>{let e=o&&this.drtResolution?this.drtResolution.selectedChild:l;return this.log("info","DPAN Swap / Injection",`Injecting: ${e?.dpan}`),{inputs:{},outputs:{finalDPAN:e?.dpan}}},s),await this.runStage(11,"Authorization Gateway",async()=>{let e=o&&this.drtResolution?this.drtResolution.selectedChild:l,t=e?this.riskAssessments.get(e.id):null,s=t?.declineProbability||.05,i=this.prng.simulateAuthResult(s);return this.authResult={approved:i,authCode:i?`AUTH${this.prng.randomInt(1e5,999999)}`:void 0,declineReason:i?void 0:"Issuer declined",responseCode:i?"00":"05",processingTimeMs:this.getLatency("Authorization Gateway"),declineProbability:s},this.log(i?"info":"warn","Authorization Gateway",i?`Approved: ${this.authResult.authCode}`:"Declined"),{inputs:{declineProbability:s},outputs:this.authResult}},s);let c=o&&this.drtResolution?this.drtResolution.selectedChild:l,d=this.stageResults.reduce((e,t)=>e+t.durationMs,0),h=c?this.riskAssessments.get(c.id):null,u=this.rulesResult.hardRuleOverride?{type:"FORCED",ruleId:this.rulesResult.forcingRule.ruleId,ruleLabel:this.rulesResult.forcingRule.ruleLabel}:{type:"AUTO",reason:"Optimization scoring"},x={correlationId:this.correlationId,replaySeed:this.seed,userId:t.id,policyVersion:n.version,policySignatureShort:n.signatureHash.slice(7,15),policyCacheHit:this.policyCacheHit,pinnedPolicy:lN(),selectedRoute:this.selectedTokenId||"none",selectedRouteName:l?.name||"none",selectedDpan:c?.dpan||"N/A",selectionMethod:u,isDRT:o,drtId:o?this.selectedTokenId:void 0,resolvedChildToken:o&&this.drtResolution?this.drtResolution.selectedChild.id:void 0,resolvedChildName:o&&this.drtResolution?this.drtResolution.selectedChild.name:void 0,hardRuleOverride:this.rulesResult.hardRuleOverride,shadowOptimization:i,matchedRules:this.rulesResult.matchedRules,failedRules:this.rulesResult.failedRules,weightsUsed:this.scoringResult.weightsUsed,scoreBreakdown:this.scoringResult.scores,candidateScores:this.scoringResult.scores.filter(e=>!e.excluded),excludedTokens:this.rulesResult.excludedTokensList,violationsOverridden:this.rulesResult.violationsOverridden,riskScore:h?.riskScore||0,declineProbability:h?.declineProbability||0,authResult:this.authResult,processingTimeMs:d,stageTimings:this.stageResults.map(e=>({stage:e.stageName,startOffset:e.startOffset,endOffset:e.endOffset,durationMs:e.durationMs})),spans:this.spans,errors:this.errors,timestamp:Date.now()};return await this.runStage(12,"Audit Record Emit",async()=>(this.log("info","Audit Record Emit",`Emitted: ${d}ms total`),{inputs:{},outputs:{totalTimeMs:d}}),s),{trace:{traceId:this.correlationId,correlationId:this.correlationId,seed:this.seed,startTime:this.pipelineStartTime,endTime:Date.now(),totalDurationMs:this.currentOffset,spans:this.spans,stageResults:this.stageResults},auditRecord:x,stageResults:this.stageResults,selectedRoute:this.selectedTokenId||"none",selectedDpan:c?.dpan||"N/A",isDRT:o,drtResolution:this.drtResolution||void 0,scoringResult:this.scoringResult,rulesResult:this.rulesResult}}}let lI=[{name:"Balanced",weights:{rewards:.3,credit:.25,cashflow:.25,risk:.2}},{name:"Max Rewards",weights:{rewards:.6,credit:.15,cashflow:.15,risk:.1}},{name:"Credit First",weights:{rewards:.15,credit:.5,cashflow:.2,risk:.15}},{name:"Cash Flow Focus",weights:{rewards:.2,credit:.15,cashflow:.5,risk:.15}},{name:"Risk Averse",weights:{rewards:.15,credit:.25,cashflow:.2,risk:.4}},{name:"Aggressive",weights:{rewards:.5,credit:.1,cashflow:.3,risk:.1}}];function lL({baseWeights:e,context:t,user:s,seed:i}){let[a,n]=(0,l.useState)(!1),[o,c]=(0,l.useState)("current"),[d,h]=(0,l.useState)("Max Rewards"),[u,x]=(0,l.useState)(!1),[m,p]=(0,l.useState)({a:null,b:null}),g=t=>"current"===t?e:lI.find(e=>e.name===t)?.weights||e,f=(0,l.useCallback)(async()=>{x(!0),p({a:null,b:null});let e=async(e,a)=>{let n={...s,preferenceWeights:a},r=new l$(i,"turbo");try{let s=await r.runPipeline(t,n,()=>{}),i=s.scoringResult.scores.filter(e=>!e.excluded).sort((e,t)=>t.finalScore-e.finalScore);return{configName:e,weights:a,winner:i[0],runnerUp:i[1]||null,allScores:s.scoringResult.scores}}catch{return null}},[a,n]=await Promise.all([e(o,g(o)),e(d,g(d))]);p({a:a,b:n}),x(!1)},[o,d,t,s,i,e]),y=m.a&&m.b&&m.a.winner.tokenId===m.b.winner.tokenId,v=m.a&&m.b?m.a.winner.finalScore-m.b.winner.finalScore:0;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>n(!0),className:"btn-secondary px-2.5 py-1 rounded flex items-center gap-1 text-xs font-mono",title:"A/B weight comparison",children:[r.jsx(lp,{className:"w-3.5 h-3.5"}),"A/B Test"]}),r.jsx(nw,{children:a&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(np.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50",onClick:()=>n(!1)}),(0,r.jsxs)(np.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-4xl max-h-[85vh] bg-surface-50 rounded-2xl border border-white/10 shadow-2xl z-50 overflow-hidden flex flex-col",children:[(0,r.jsxs)("div",{className:"px-5 py-4 border-b border-white/5 flex items-center justify-between flex-shrink-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent-purple/10 flex items-center justify-center",children:r.jsx(lp,{className:"w-5 h-5 text-accent-purple"})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"A/B Weight Comparison"}),r.jsx("p",{className:"text-xs text-text-secondary",children:"Compare how different weight configurations affect routing"})]})]}),r.jsx("button",{onClick:()=>n(!1),className:"text-text-tertiary hover:text-white transition-colors",children:r.jsx(rf,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-5",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"text-xs text-text-tertiary uppercase tracking-wider mb-2 block",children:"Configuration A"}),(0,r.jsxs)("select",{value:o,onChange:e=>c(e.target.value),disabled:u,className:"w-full px-3 py-2 bg-surface-100 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:border-accent-purple/50",children:[r.jsx("option",{value:"current",children:"Current Settings"}),lI.map(e=>r.jsx("option",{value:e.name,children:e.name},e.name))]}),r.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2 text-[10px]",children:Object.entries(g(o)).map(([e,t])=>(0,r.jsxs)("div",{className:"flex justify-between px-2 py-1 bg-white/5 rounded",children:[r.jsx("span",{className:"text-text-tertiary capitalize",children:e}),(0,r.jsxs)("span",{className:"text-white font-mono",children:[(100*t).toFixed(0),"%"]})]},e))})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"text-xs text-text-tertiary uppercase tracking-wider mb-2 block",children:"Configuration B"}),(0,r.jsxs)("select",{value:d,onChange:e=>h(e.target.value),disabled:u,className:"w-full px-3 py-2 bg-surface-100 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:border-accent-purple/50",children:[r.jsx("option",{value:"current",children:"Current Settings"}),lI.map(e=>r.jsx("option",{value:e.name,children:e.name},e.name))]}),r.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2 text-[10px]",children:Object.entries(g(d)).map(([e,t])=>(0,r.jsxs)("div",{className:"flex justify-between px-2 py-1 bg-white/5 rounded",children:[r.jsx("span",{className:"text-text-tertiary capitalize",children:e}),(0,r.jsxs)("span",{className:"text-white font-mono",children:[(100*t).toFixed(0),"%"]})]},e))})]})]}),r.jsx("button",{onClick:f,disabled:u||o===d,className:"w-full py-3 rounded-lg font-medium text-sm flex items-center justify-center gap-2 bg-accent-purple/20 text-accent-purple border border-accent-purple/30 hover:bg-accent-purple/30 transition-all disabled:opacity-50 mb-6",children:u?(0,r.jsxs)(r.Fragment,{children:[r.jsx(np.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:r.jsx(nS,{className:"w-4 h-4"})}),"Running comparison..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(lg,{className:"w-4 h-4"}),"Compare Configurations"]})}),m.a&&m.b&&(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("div",{className:`p-4 rounded-xl border ${y?"bg-accent-blue/10 border-accent-blue/20":"bg-accent-orange/10 border-accent-orange/20"}`,children:r.jsx("div",{className:"flex items-center gap-3",children:y?(0,r.jsxs)(r.Fragment,{children:[r.jsx(lf,{className:"w-5 h-5 text-accent-blue"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-white",children:["Same Winner: ",m.a.winner.tokenName]}),(0,r.jsxs)("p",{className:"text-xs text-text-secondary",children:["Both configurations select the same card (score diff: ",Math.abs(v).toFixed(1)," pts)"]})]})]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(lg,{className:"w-5 h-5 text-accent-orange"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-white",children:"Different Winners"}),(0,r.jsxs)("p",{className:"text-xs text-text-secondary",children:["Config A: ",m.a.winner.tokenName," vs Config B: ",m.b.winner.tokenName]})]})]})})}),r.jsx("div",{className:"grid grid-cols-2 gap-4",children:[m.a,m.b].map((e,t)=>(0,r.jsxs)("div",{className:"bg-white/5 rounded-xl p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${0===t?"bg-accent-green/20 text-accent-green":"bg-accent-blue/20 text-accent-blue"}`,children:0===t?"A":"B"}),r.jsx("span",{className:"text-sm font-medium text-white",children:e.configName})]}),(0,r.jsxs)("div",{className:"p-3 bg-accent-green/10 border border-accent-green/20 rounded-lg mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(ri,{className:"w-4 h-4 text-accent-green"}),r.jsx("span",{className:"text-sm font-medium text-white",children:e.winner.tokenName})]}),(0,r.jsxs)("p",{className:"text-lg font-mono font-bold text-accent-green",children:[e.winner.finalScore.toFixed(1)," pts"]})]}),r.jsx("div",{className:"space-y-1.5",children:e.allScores.filter(e=>!e.excluded).slice(0,4).map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:`w-4 h-4 rounded flex items-center justify-center text-[10px] font-bold ${0===t?"bg-accent-green text-black":"bg-white/10 text-white"}`,children:t+1}),r.jsx("span",{className:"text-text-secondary truncate max-w-[120px]",children:e.tokenName})]}),r.jsx("span",{className:"font-mono text-white",children:e.finalScore.toFixed(1)})]},e.tokenId))})]},t))}),(0,r.jsxs)("div",{className:"bg-white/5 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-text-tertiary uppercase tracking-wider mb-3",children:"Weight Differences"}),r.jsx("div",{className:"grid grid-cols-4 gap-3",children:Object.keys(g(o)).map(e=>{let t=g(d)[e]-g(o)[e];return(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary capitalize mb-1",children:e}),(0,r.jsxs)("div",{className:`flex items-center justify-center gap-1 ${t>0?"text-accent-green":t<0?"text-error-red":"text-text-secondary"}`,children:[t>0?r.jsx(rb.Z,{className:"w-3 h-3"}):t<0?r.jsx(rj,{className:"w-3 h-3"}):null,(0,r.jsxs)("span",{className:"text-sm font-mono",children:[t>0?"+":"",(100*t).toFixed(0),"%"]})]})]},e)})})]})]})]})]})]})})]})}let lO=(0,nk.Z)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),lV=(0,nk.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function lB({history:e,onReplay:t,onClear:s}){let[i,a]=(0,l.useState)(!1),[n,o]=(0,l.useState)(null),c=e=>{let t=new Date(e),s=new Date().getTime()-t.getTime(),i=Math.floor(s/6e4),a=Math.floor(s/36e5);return i<1?"Just now":i<60?`${i}m ago`:a<24?`${a}h ago`:t.toLocaleDateString()},d={scenario_dining_domestic:"Dining",scenario_travel_international:"Travel",scenario_online_subscription:"Subscription",scenario_grocery_weekend:"Grocery",scenario_high_value_electronics:"Electronics",scenario_gas_station:"Gas",custom:"Custom"};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>a(!0),className:"relative p-1.5 text-text-tertiary hover:text-white transition-colors",title:"Run history",children:[r.jsx(lO,{className:"w-4 h-4"}),e.length>0&&r.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-3.5 h-3.5 bg-accent-blue rounded-full text-[9px] font-bold flex items-center justify-center text-white",children:e.length})]}),r.jsx(nw,{children:i&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(np.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50",onClick:()=>a(!1)}),(0,r.jsxs)(np.div,{initial:{opacity:0,x:300},animate:{opacity:1,x:0},exit:{opacity:0,x:300},transition:{type:"spring",damping:25},className:"fixed top-0 right-0 h-full w-full max-w-md bg-surface-50 border-l border-white/10 shadow-2xl z-50 flex flex-col",children:[(0,r.jsxs)("div",{className:"px-5 py-4 border-b border-white/5 flex items-center justify-between flex-shrink-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent-blue/10 flex items-center justify-center",children:r.jsx(lO,{className:"w-5 h-5 text-accent-blue"})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"Run History"}),(0,r.jsxs)("p",{className:"text-xs text-text-secondary",children:[e.length," runs stored"]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.length>0&&r.jsx("button",{onClick:s,className:"p-2 text-text-tertiary hover:text-error-red transition-colors",title:"Clear history",children:r.jsx(lV,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>a(!1),className:"text-text-tertiary hover:text-white transition-colors",children:r.jsx(rf,{className:"w-5 h-5"})})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:0===e.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center",children:[r.jsx(n2.Z,{className:"w-12 h-12 text-text-tertiary mb-4"}),r.jsx("p",{className:"text-text-secondary",children:"No runs yet"}),r.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:"Your pipeline runs will appear here"})]}):r.jsx("div",{className:"p-4 space-y-2",children:e.map((e,s)=>(0,r.jsxs)(np.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.03*s},className:`p-3 rounded-xl border transition-all cursor-pointer ${n?.id===e.id?"bg-accent-blue/10 border-accent-blue/30":"bg-white/5 border-white/10 hover:bg-white/10"}`,onClick:()=>o(e.id===n?.id?null:e),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.approved?r.jsx(nQ,{className:"w-4 h-4 text-accent-green"}):r.jsx(n0,{className:"w-4 h-4 text-error-red"}),r.jsx("span",{className:"text-sm font-medium text-white",children:e.selectedRouteName})]}),r.jsx("span",{className:"text-[10px] text-text-tertiary",children:c(e.timestamp)})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"px-1.5 py-0.5 bg-white/10 rounded text-text-secondary",children:d[e.scenario]||e.scenario}),(0,r.jsxs)("span",{className:"text-text-tertiary font-mono",children:["$",e.context.amount]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-accent-green font-mono",children:e.topScore.toFixed(1)}),e.ruleOverride&&r.jsx("span",{className:"px-1 py-0.5 bg-accent-orange/20 text-accent-orange text-[9px] rounded",children:"FORCED"})]})]}),r.jsx(nw,{children:n?.id===e.id&&(0,r.jsxs)(np.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"mt-3 pt-3 border-t border-white/10",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-[10px] mb-3",children:[(0,r.jsxs)("div",{className:"px-2 py-1.5 bg-black/20 rounded",children:[r.jsx("span",{className:"text-text-tertiary",children:"Correlation ID"}),(0,r.jsxs)("p",{className:"text-white font-mono truncate",children:[e.correlationId.slice(0,16),"..."]})]}),(0,r.jsxs)("div",{className:"px-2 py-1.5 bg-black/20 rounded",children:[r.jsx("span",{className:"text-text-tertiary",children:"Latency"}),(0,r.jsxs)("p",{className:"text-white font-mono",children:[e.totalLatency,"ms"]})]}),(0,r.jsxs)("div",{className:"px-2 py-1.5 bg-black/20 rounded",children:[r.jsx("span",{className:"text-text-tertiary",children:"MCC"}),r.jsx("p",{className:"text-white font-mono",children:e.context.mcc})]}),(0,r.jsxs)("div",{className:"px-2 py-1.5 bg-black/20 rounded",children:[r.jsx("span",{className:"text-text-tertiary",children:"Currency"}),r.jsx("p",{className:"text-white font-mono",children:e.context.currency})]})]}),(0,r.jsxs)("button",{onClick:s=>{s.stopPropagation(),t(e),a(!1)},className:"w-full py-2 rounded-lg bg-accent-blue/20 border border-accent-blue/30 text-accent-blue text-sm font-medium flex items-center justify-center gap-2 hover:bg-accent-blue/30 transition-colors",children:[r.jsx(rz,{className:"w-3.5 h-3.5"}),"Replay This Run"]})]})})]},e.id))})}),e.length>0&&r.jsx("div",{className:"px-4 py-3 border-t border-white/5 bg-black/20",children:(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-center",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-lg font-mono font-bold text-accent-green",children:e.filter(e=>e.approved).length}),r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Approved"})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-lg font-mono font-bold text-error-red",children:e.filter(e=>!e.approved).length}),r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Declined"})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-lg font-mono font-bold text-accent-blue",children:(e.reduce((e,t)=>e+t.topScore,0)/e.length).toFixed(1)}),r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Avg Score"})]})]})})]})]})})]})}let lz=(0,nk.Z)("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),lU=(0,nk.Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),l_=[{value:"context.mcc",label:"MCC Code"},{value:"context.amount",label:"Amount"},{value:"context.currency",label:"Currency"},{value:"context.merchantCountry",label:"Merchant Country"},{value:"context.isRecurring",label:"Is Recurring"},{value:"context.channel",label:"Channel"},{value:"token.network",label:"Card Network"},{value:"token.type",label:"Card Type"},{value:"token.issuer",label:"Issuer"}],lZ=[{value:"eq",label:"="},{value:"neq",label:"!="},{value:"gt",label:">"},{value:"lt",label:"<"},{value:"gte",label:">="},{value:"lte",label:"<="},{value:"contains",label:"contains"},{value:"in",label:"in list"}];function lH(){return[]}function lW({isOpen:e,onClose:t,onApplyRules:s}){let[i,a]=(0,l.useState)(lH),[n,o]=(0,l.useState)(null),[c,d]=(0,l.useState)(!1),h=()=>({id:`custom-${Date.now()}`,label:"New Rule",type:"SOFT",conditions:[],action:"PREFER",enabled:!0}),u=(e,t)=>{a(s=>s.map(s=>s.id===e?{...s,...t}:s)),n?.id===e&&o(e=>e?{...e,...t}:null),d(!0)},x=e=>{a(t=>t.filter(t=>t.id!==e)),n?.id===e&&o(null),d(!0)},m=e=>{let t={id:`cond-${Date.now()}`,field:"context.mcc",operator:"eq",value:""};u(e,{conditions:[...i.find(t=>t.id===e)?.conditions||[],t]})},p=(e,t,s)=>{let a=i.find(t=>t.id===e);a&&u(e,{conditions:a.conditions.map(e=>e.id===t?{...e,...s}:e)})},g=(e,t)=>{let s=i.find(t=>t.id===e);s&&u(e,{conditions:s.conditions.filter(e=>e.id!==t)})};return r.jsx(nw,{children:e&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(np.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50",onClick:t}),(0,r.jsxs)(np.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-4xl max-h-[85vh] bg-surface-50 rounded-2xl border border-white/10 shadow-2xl z-50 overflow-hidden flex flex-col",children:[(0,r.jsxs)("div",{className:"px-5 py-4 border-b border-white/5 flex items-center justify-between flex-shrink-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent-orange/10 flex items-center justify-center",children:r.jsx(ra.Z,{className:"w-5 h-5 text-accent-orange"})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"Custom Rule Builder"}),r.jsx("p",{className:"text-xs text-text-secondary",children:"Create and manage your own routing rules"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[c&&r.jsx("span",{className:"px-2 py-1 bg-accent-orange/20 text-accent-orange text-xs rounded",children:"Unsaved changes"}),r.jsx("button",{onClick:t,className:"text-text-tertiary hover:text-white transition-colors",children:r.jsx(rf,{className:"w-5 h-5"})})]})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-hidden flex",children:[(0,r.jsxs)("div",{className:"w-64 border-r border-white/5 flex flex-col",children:[r.jsx("div",{className:"p-3 border-b border-white/5",children:(0,r.jsxs)("button",{onClick:()=>{let e=h();a(t=>[...t,e]),o(e),d(!0)},className:"w-full py-2 rounded-lg bg-accent-orange/20 border border-accent-orange/30 text-accent-orange text-sm font-medium flex items-center justify-center gap-2 hover:bg-accent-orange/30 transition-colors",children:[r.jsx(rW,{className:"w-4 h-4"}),"Add Rule"]})}),r.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:0===i.length?r.jsx("p",{className:"text-xs text-text-tertiary text-center py-4",children:"No custom rules yet"}):i.map(e=>(0,r.jsxs)("button",{onClick:()=>o(e),className:`w-full p-3 rounded-lg text-left transition-all ${n?.id===e.id?"bg-accent-orange/10 border border-accent-orange/30":"bg-white/5 border border-white/10 hover:bg-white/10"}`,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[r.jsx("span",{className:"text-sm font-medium text-white truncate",children:e.label}),r.jsx("span",{className:`w-2 h-2 rounded-full ${e.enabled?"bg-accent-green":"bg-text-tertiary"}`})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-[10px]",children:[r.jsx("span",{className:`px-1.5 py-0.5 rounded ${"HARD"===e.type?"bg-error-red/20 text-error-red":"bg-accent-blue/20 text-accent-blue"}`,children:e.type}),(0,r.jsxs)("span",{className:"text-text-tertiary",children:[e.conditions.length," conditions"]})]})]},e.id))})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-5",children:n?(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"text-xs text-text-tertiary uppercase tracking-wider mb-2 block",children:"Rule Name"}),r.jsx("input",{type:"text",value:n.label,onChange:e=>u(n.id,{label:e.target.value}),className:"w-full px-3 py-2 bg-surface-100 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:border-accent-orange/50"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"text-xs text-text-tertiary uppercase tracking-wider mb-2 block",children:"Rule Type"}),(0,r.jsxs)("select",{value:n.type,onChange:e=>u(n.id,{type:e.target.value}),className:"w-full px-3 py-2 bg-surface-100 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:border-accent-orange/50",children:[r.jsx("option",{value:"SOFT",children:"SOFT (Preference)"}),r.jsx("option",{value:"HARD",children:"HARD (Mandatory)"})]})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"text-xs text-text-tertiary uppercase tracking-wider mb-2 block",children:"Action When Matched"}),r.jsx("div",{className:"grid grid-cols-4 gap-2",children:["FORCE","EXCLUDE","PREFER","AVOID"].map(e=>r.jsx("button",{onClick:()=>u(n.id,{action:e}),className:`py-2 rounded-lg text-xs font-medium transition-all ${n.action===e?"bg-accent-orange/20 border border-accent-orange/50 text-accent-orange":"bg-white/5 border border-white/10 text-text-secondary hover:bg-white/10"}`,children:e},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("label",{className:"text-xs text-text-tertiary uppercase tracking-wider",children:"Conditions"}),(0,r.jsxs)("button",{onClick:()=>m(n.id),className:"text-xs text-accent-orange hover:text-accent-orange/80 flex items-center gap-1",children:[r.jsx(rW,{className:"w-3 h-3"}),"Add Condition"]})]}),0===n.conditions.length?(0,r.jsxs)("div",{className:"p-4 bg-white/5 rounded-lg text-center",children:[r.jsx(n1.Z,{className:"w-5 h-5 text-accent-orange mx-auto mb-2"}),r.jsx("p",{className:"text-xs text-text-secondary",children:"No conditions defined"}),r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"This rule will always match"})]}):r.jsx("div",{className:"space-y-2",children:n.conditions.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-white/5 rounded-lg",children:[r.jsx(lz,{className:"w-4 h-4 text-text-tertiary cursor-move"}),t>0&&r.jsx("span",{className:"text-xs text-accent-blue font-mono",children:"AND"}),r.jsx("select",{value:e.field,onChange:t=>p(n.id,e.id,{field:t.target.value}),className:"flex-1 px-2 py-1.5 bg-surface-100 border border-white/10 rounded text-xs text-white focus:outline-none",children:l_.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))}),r.jsx("select",{value:e.operator,onChange:t=>p(n.id,e.id,{operator:t.target.value}),className:"w-20 px-2 py-1.5 bg-surface-100 border border-white/10 rounded text-xs text-white font-mono focus:outline-none",children:lZ.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))}),r.jsx("input",{type:"text",value:e.value,onChange:t=>p(n.id,e.id,{value:t.target.value}),placeholder:"value",className:"w-32 px-2 py-1.5 bg-surface-100 border border-white/10 rounded text-xs text-white focus:outline-none"}),r.jsx("button",{onClick:()=>g(n.id,e.id),className:"p-1 text-text-tertiary hover:text-error-red transition-colors",children:r.jsx(lV,{className:"w-3.5 h-3.5"})})]},e.id))})]}),("FORCE"===n.action||"PREFER"===n.action)&&(0,r.jsxs)("div",{children:[r.jsx("label",{className:"text-xs text-text-tertiary uppercase tracking-wider mb-2 block",children:"Target Token Pattern"}),r.jsx("input",{type:"text",value:n.targetTokenPattern||"",onChange:e=>u(n.id,{targetTokenPattern:e.target.value}),placeholder:"e.g., *Sapphire*, AMEX*, etc.",className:"w-full px-3 py-2 bg-surface-100 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:border-accent-orange/50"}),r.jsx("p",{className:"text-[10px] text-text-tertiary mt-1",children:"Use * as wildcard. Leave empty to apply to top-scoring token."})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg",children:[r.jsx("span",{className:"text-sm text-white",children:"Rule Enabled"}),r.jsx("button",{onClick:()=>u(n.id,{enabled:!n.enabled}),className:`w-12 h-6 rounded-full p-1 transition-colors ${n.enabled?"bg-accent-green":"bg-surface-100"}`,children:r.jsx(np.div,{animate:{x:n.enabled?24:0},className:"w-4 h-4 rounded-full bg-white"})})]}),(0,r.jsxs)("button",{onClick:()=>x(n.id),className:"w-full py-2 rounded-lg bg-error-red/10 border border-error-red/20 text-error-red text-sm flex items-center justify-center gap-2 hover:bg-error-red/20 transition-colors",children:[r.jsx(lV,{className:"w-4 h-4"}),"Delete Rule"]})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[r.jsx(nN.Z,{className:"w-12 h-12 text-text-tertiary mb-4"}),r.jsx("p",{className:"text-text-secondary",children:"Select a rule to edit"}),r.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:"Or create a new one to get started"})]})})]}),(0,r.jsxs)("div",{className:"px-5 py-4 border-t border-white/5 flex items-center justify-between flex-shrink-0",children:[(0,r.jsxs)("button",{onClick:()=>{a(lH()),o(null),d(!1)},disabled:!c,className:"px-4 py-2 text-sm text-text-secondary hover:text-white transition-colors disabled:opacity-50 flex items-center gap-2",children:[r.jsx(rz,{className:"w-4 h-4"}),"Reset Changes"]}),(0,r.jsxs)("button",{onClick:()=>{s(i),d(!1)},className:"px-4 py-2 rounded-lg bg-accent-green/20 border border-accent-green/30 text-accent-green text-sm font-medium flex items-center gap-2 hover:bg-accent-green/30 transition-colors",children:[r.jsx(lU,{className:"w-4 h-4"}),"Save & Apply"]})]})]})]})})}function lq({onClick:e}){return(0,r.jsxs)("button",{onClick:e,className:"btn-secondary px-2.5 py-1 rounded flex items-center gap-1 text-xs font-mono",title:"Custom rule builder",children:[r.jsx(ra.Z,{className:"w-3.5 h-3.5"}),"Rules"]})}let lG=(0,nk.Z)("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),lX=(0,nk.Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),lK=[{name:"Chase Sapphire Reserve",network:"visa",reason:"Excellent travel rewards with 3x points on dining and travel",expectedBoost:15,categories:["travel","dining"],annualFee:550,signupBonus:"60,000 points"},{name:"Amex Gold Card",network:"amex",reason:"4x points on restaurants and supermarkets",expectedBoost:18,categories:["dining","grocery"],annualFee:250,signupBonus:"75,000 points"},{name:"Citi Double Cash",network:"mastercard",reason:"2% cash back on everything, no annual fee",expectedBoost:8,categories:["general"],annualFee:0},{name:"Capital One Venture X",network:"visa",reason:"10x on hotels, 5x on flights, excellent travel benefits",expectedBoost:20,categories:["travel"],annualFee:395,signupBonus:"75,000 miles"},{name:"Discover it Cash Back",network:"discover",reason:"5% rotating categories, first year cash back match",expectedBoost:12,categories:["rotating"],annualFee:0,signupBonus:"Cash back match"},{name:"Blue Cash Preferred",network:"amex",reason:"6% at supermarkets, 6% on streaming",expectedBoost:14,categories:["grocery","streaming"],annualFee:95,signupBonus:"$350 back"}],lY={5812:["dining"],5814:["dining"],5411:["grocery"],5541:["gas"],5542:["gas"],"3000-3999":["travel"],4111:["travel"],4121:["travel"],5311:["general"],5732:["electronics"]};function lJ({scores:e,context:t,userTokens:s}){let i=(0,l.useMemo)(()=>{let e=function(e){if(lY[e])return lY[e];let t=parseInt(e);return t>=3e3&&t<=3999?["travel"]:t>=5800&&t<=5899?["dining"]:["general"]}(String(t.mcc)),i=s.map(e=>e.name.toLowerCase());return lK.filter(e=>!i.some(t=>t.includes(e.name.toLowerCase().split(" ")[0].toLowerCase()))).map(t=>{let s=0;return t.categories.some(t=>e.includes(t)||"general"===t||"rotating"===t)&&(s+=30),0===t.annualFee?s+=15:t.annualFee<100?s+=10:t.annualFee<300&&(s+=5),t.signupBonus&&(s+=10),s+=t.expectedBoost,{...t,relevanceScore:s}}).sort((e,t)=>t.relevanceScore-e.relevanceScore).slice(0,3)},[t.mcc,s]),a=e.filter(e=>!e.excluded).sort((e,t)=>t.finalScore-e.finalScore)[0];return 0===i.length?null:(0,r.jsxs)(np.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-accent-purple/10 via-surface-50 to-accent-pink/10 rounded-xl border border-white/10 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-4 py-3 border-b border-white/5 flex items-center gap-2",children:[r.jsx(lG,{className:"w-4 h-4 text-accent-purple"}),r.jsx("h3",{className:"text-sm font-semibold text-white",children:"Card Recommendations"}),r.jsx("span",{className:"text-[10px] text-text-tertiary ml-auto",children:"Based on your spending"})]}),(0,r.jsxs)("div",{className:"p-4 space-y-3",children:[i.map((e,t)=>(0,r.jsxs)(np.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1*t},className:"p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors group",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:`w-8 h-5 rounded flex items-center justify-center text-[8px] font-bold ${"visa"===e.network?"bg-blue-900 text-white":"mastercard"===e.network?"bg-gradient-to-r from-red-600 to-orange-500 text-white":"amex"===e.network?"bg-slate-600 text-white":"bg-orange-600 text-white"}`,children:e.network.toUpperCase().slice(0,4)}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-white",children:e.name}),r.jsx("p",{className:"text-[10px] text-text-tertiary",children:0===e.annualFee?"No annual fee":`$${e.annualFee}/year`})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 text-accent-green",children:[r.jsx(rb.Z,{className:"w-3 h-3"}),(0,r.jsxs)("span",{className:"text-xs font-mono",children:["+",e.expectedBoost]})]}),r.jsx("p",{className:"text-[9px] text-text-tertiary",children:"pts potential"})]})]}),r.jsx("p",{className:"text-xs text-text-secondary mb-2",children:e.reason}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"flex items-center gap-1.5",children:e.categories.map(e=>r.jsx("span",{className:"px-1.5 py-0.5 bg-accent-purple/10 text-accent-purple text-[9px] rounded capitalize",children:e},e))}),e.signupBonus&&(0,r.jsxs)("div",{className:"flex items-center gap-1 text-accent-orange text-[10px]",children:[r.jsx(lX,{className:"w-3 h-3"}),e.signupBonus]})]})]},e.name)),a&&(0,r.jsxs)("div",{className:"mt-4 p-3 bg-accent-green/5 border border-accent-green/20 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(nV.Z,{className:"w-4 h-4 text-accent-green"}),r.jsx("span",{className:"text-xs font-medium text-white",children:"With top recommendation:"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-text-secondary text-xs",children:["Current best: ",a.tokenName]}),(0,r.jsxs)("span",{className:"text-accent-green font-mono text-sm",children:[a.finalScore.toFixed(1),"  ",(a.finalScore+i[0].expectedBoost).toFixed(1)]})]})]})]})]})}let lQ=(0,nk.Z)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),l0=[{code:"5812",name:"Restaurants",icon:"\uD83C\uDF7D",description:"Full-service restaurants and dining establishments",bestCards:[{pattern:"Sapphire",multiplier:"3x",reason:"Chase dining bonus"},{pattern:"Gold",multiplier:"4x",reason:"Amex dining category"},{pattern:"Savor",multiplier:"4%",reason:"Capital One dining rewards"}]},{code:"5814",name:"Fast Food",icon:"\uD83C\uDF54",description:"Quick service restaurants and fast food chains",bestCards:[{pattern:"Gold",multiplier:"4x",reason:"Amex restaurants category"},{pattern:"Freedom",multiplier:"5x",reason:"Rotating category (when active)"}]},{code:"5411",name:"Grocery Stores",icon:"\uD83D\uDED2",description:"Supermarkets and grocery stores",bestCards:[{pattern:"Blue Cash",multiplier:"6%",reason:"Amex grocery bonus"},{pattern:"Gold",multiplier:"4x",reason:"Amex supermarkets"},{pattern:"Freedom",multiplier:"5x",reason:"Rotating category (when active)"}]},{code:"5541",name:"Gas Stations",icon:"",description:"Service stations with gas pumps",bestCards:[{pattern:"Freedom",multiplier:"5x",reason:"Rotating category (when active)"},{pattern:"Costco",multiplier:"4%",reason:"Citi Costco gas bonus"},{pattern:"Discover",multiplier:"5%",reason:"Rotating category"}]},{range:[3e3,3999],code:"3xxx",name:"Airlines",icon:"",description:"Airline purchases and travel bookings",bestCards:[{pattern:"Venture",multiplier:"10x",reason:"Capital One hotels/car"},{pattern:"Sapphire",multiplier:"5x",reason:"Chase travel portal"},{pattern:"Platinum",multiplier:"5x",reason:"Amex airline credit"}]},{code:"4111",name:"Transportation",icon:"\uD83D\uDE87",description:"Local transit, trains, and commuter services",bestCards:[{pattern:"Sapphire",multiplier:"3x",reason:"Chase travel category"},{pattern:"Venture",multiplier:"2x",reason:"All travel purchases"}]},{code:"5311",name:"Department Stores",icon:"\uD83C\uDFEC",description:"Large retail department stores",bestCards:[{pattern:"Double Cash",multiplier:"2%",reason:"Flat rate everything"},{pattern:"Freedom Unlimited",multiplier:"1.5%",reason:"Base earning rate"}]},{code:"5732",name:"Electronics",icon:"\uD83D\uDCBB",description:"Consumer electronics and computer stores",bestCards:[{pattern:"Freedom",multiplier:"5x",reason:"Q4 rotating category"},{pattern:"Double Cash",multiplier:"2%",reason:"Flat rate cashback"}]},{code:"7832",name:"Entertainment",icon:"\uD83C\uDFAC",description:"Movie theaters and entertainment venues",bestCards:[{pattern:"Savor",multiplier:"4%",reason:"Entertainment category"},{pattern:"Gold",multiplier:"4x",reason:"Dining/entertainment"}]},{code:"5912",name:"Pharmacies",icon:"\uD83D\uDC8A",description:"Drug stores and pharmacies",bestCards:[{pattern:"Blue Cash",multiplier:"3%",reason:"Amex drugstore bonus"},{pattern:"Discover",multiplier:"5%",reason:"Rotating category"}]}];function l1({tokens:e,currentMCC:t}){let[s,i]=(0,l.useState)(!1),[a,n]=(0,l.useState)(null),o=(0,l.useMemo)(()=>{let e=parseInt(t);return l0.find(s=>s.range?e>=s.range[0]&&e<=s.range[1]:s.code===t)},[t]),c=(0,l.useMemo)(()=>o?e.filter(e=>{let t=e.name.toLowerCase();return o.bestCards.some(e=>t.includes(e.pattern.toLowerCase()))}).map(e=>{let t=o.bestCards.find(t=>e.name.toLowerCase().includes(t.pattern.toLowerCase()));return{token:e,multiplier:t?.multiplier||"1x",reason:t?.reason||"Base earning"}}):[],[o,e]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>i(!0),className:"btn-secondary px-2.5 py-1 rounded flex items-center gap-1 text-xs font-mono",title:"MCC category insights",children:[r.jsx(lQ,{className:"w-3.5 h-3.5"}),"MCC"]}),r.jsx(nw,{children:s&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(np.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50",onClick:()=>i(!1)}),(0,r.jsxs)(np.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-2xl max-h-[85vh] bg-surface-50 rounded-2xl border border-white/10 shadow-2xl z-50 overflow-hidden flex flex-col",children:[(0,r.jsxs)("div",{className:"px-5 py-4 border-b border-white/5 flex items-center justify-between flex-shrink-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent-teal/10 flex items-center justify-center",children:r.jsx(lQ,{className:"w-5 h-5 text-accent-teal"})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"MCC Category Insights"}),r.jsx("p",{className:"text-xs text-text-secondary",children:"Best cards for each merchant category"})]})]}),r.jsx("button",{onClick:()=>i(!1),className:"text-text-tertiary hover:text-white transition-colors",children:r.jsx(rf,{className:"w-5 h-5"})})]}),o&&(0,r.jsxs)("div",{className:"px-5 py-4 bg-accent-teal/5 border-b border-white/5",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[r.jsx("span",{className:"text-2xl",children:o.icon}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("h4",{className:"text-sm font-semibold text-white",children:o.name}),(0,r.jsxs)("span",{className:"px-1.5 py-0.5 bg-accent-teal/20 text-accent-teal text-[10px] rounded font-mono",children:["MCC ",t]})]}),r.jsx("p",{className:"text-xs text-text-secondary",children:o.description})]})]}),c.length>0&&(0,r.jsxs)("div",{className:"mt-3",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase tracking-wider mb-2",children:"Your matching cards:"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(({token:e,multiplier:t,reason:s})=>(0,r.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1.5 bg-white/10 rounded-lg",children:[r.jsx(ri,{className:"w-3 h-3 text-accent-green"}),r.jsx("span",{className:"text-xs text-white",children:e.name}),r.jsx("span",{className:"text-xs font-mono text-accent-green",children:t})]},e.id))})]}),0===c.length&&r.jsx("div",{className:"mt-3 p-2 bg-accent-orange/10 border border-accent-orange/20 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(nE,{className:"w-4 h-4 text-accent-orange"}),r.jsx("p",{className:"text-xs text-accent-orange",children:"You don't have any bonus cards for this category"})]})})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-5",children:[r.jsx("p",{className:"text-xs text-text-tertiary uppercase tracking-wider mb-3",children:"All Categories"}),r.jsx("div",{className:"space-y-2",children:l0.map(e=>{let s=a===e.code,i=e.code===t||e.range&&parseInt(t)>=e.range[0]&&parseInt(t)<=e.range[1];return(0,r.jsxs)(np.div,{className:`rounded-xl border transition-all ${i?"bg-accent-teal/10 border-accent-teal/30":"bg-white/5 border-white/10 hover:bg-white/10"}`,children:[(0,r.jsxs)("button",{onClick:()=>n(s?null:e.code),className:"w-full p-3 flex items-center justify-between text-left",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-xl",children:e.icon}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm font-medium text-white",children:e.name}),r.jsx("span",{className:"text-[10px] text-text-tertiary font-mono",children:e.range?`${e.range[0]}-${e.range[1]}`:e.code})]}),r.jsx("p",{className:"text-xs text-text-secondary",children:e.description})]})]}),s?r.jsx(rp,{className:"w-4 h-4 text-text-tertiary"}):r.jsx(nL,{className:"w-4 h-4 text-text-tertiary"})]}),r.jsx(nw,{children:s&&r.jsx(np.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:(0,r.jsxs)("div",{className:"px-3 pb-3 pt-1 border-t border-white/5",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase tracking-wider mb-2",children:"Recommended Cards"}),r.jsx("div",{className:"space-y-1.5",children:e.bestCards.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 bg-black/20 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(rb.Z,{className:"w-3 h-3 text-accent-green"}),r.jsx("span",{className:"text-xs text-white",children:e.pattern})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("span",{className:"text-xs font-mono text-accent-green",children:e.multiplier}),r.jsx("p",{className:"text-[9px] text-text-tertiary",children:e.reason})]})]},t))})]})})})]},e.code)})})]})]})]})})]})}function l2({tokens:e,selectedTokenId:t,context:s}){let[i,a]=(0,l.useState)(6),[n,o]=(0,l.useState)(s.amount),c=e.find(e=>e.id===t),d=(0,l.useMemo)(()=>{if(!c)return[];let e=c.limit||1e4,t=c.balance||0,s=[],a=t;for(let t=1;t<=i;t++){let i=.7*(a+=n),r=Math.min(100,(a-=i)/e*100),l=0;l=r<10?20:r<30?10:r<50?0:r<75?-15:-30;let o=s.length>0?s[s.length-1].cumulativeImpact+(l-(s[s.length-1].scoreImpact||0))*.3:l;s.push({month:t,utilization:r,scoreImpact:l,cumulativeImpact:Math.round(o)})}return s},[c,n,i]),h=d[d.length-1],u=h?h.utilization>30?"high":h.utilization>10?"moderate":"low":"unknown";if(!c)return null;let x=(c.balance||0)/(c.limit||1e4)*100;return(0,r.jsxs)(np.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-accent-blue/10 via-surface-50 to-accent-teal/10 rounded-xl border border-white/10 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-4 py-3 border-b border-white/5 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(ra.Z,{className:"w-4 h-4 text-accent-blue"}),r.jsx("h3",{className:"text-sm font-semibold text-white",children:"Credit Impact Simulator"})]}),r.jsx("span",{className:"text-[10px] text-text-tertiary",children:c.name})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[(0,r.jsxs)("div",{className:"p-3 bg-white/5 rounded-lg text-center",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase mb-1",children:"Current Util."}),(0,r.jsxs)("p",{className:`text-lg font-mono font-bold ${x>50?"text-error-red":x>30?"text-accent-orange":"text-accent-green"}`,children:[x.toFixed(0),"%"]})]}),(0,r.jsxs)("div",{className:"p-3 bg-white/5 rounded-lg text-center",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase mb-1",children:"Credit Limit"}),(0,r.jsxs)("p",{className:"text-lg font-mono font-bold text-white",children:["$",((c.limit||1e4)/1e3).toFixed(0),"k"]})]}),(0,r.jsxs)("div",{className:"p-3 bg-white/5 rounded-lg text-center",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase mb-1",children:"Balance"}),(0,r.jsxs)("p",{className:"text-lg font-mono font-bold text-white",children:["$",(c.balance||0).toLocaleString()]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"text-[10px] text-text-tertiary uppercase block mb-1",children:"Monthly Spend"}),r.jsx("input",{type:"range",min:100,max:5e3,step:100,value:n,onChange:e=>o(Number(e.target.value)),className:"w-full accent-accent-blue"}),(0,r.jsxs)("p",{className:"text-xs text-white font-mono text-center mt-1",children:["$",n]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"text-[10px] text-text-tertiary uppercase block mb-1",children:"Months Ahead"}),r.jsx("input",{type:"range",min:3,max:12,step:1,value:i,onChange:e=>a(Number(e.target.value)),className:"w-full accent-accent-blue"}),(0,r.jsxs)("p",{className:"text-xs text-white font-mono text-center mt-1",children:[i," months"]})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase mb-2",children:"Utilization Projection"}),r.jsx("div",{className:"h-24 flex items-end gap-1",children:d.map((e,t)=>(0,r.jsxs)("div",{className:"flex-1 flex flex-col items-center gap-1",children:[r.jsx(np.div,{initial:{height:0},animate:{height:`${Math.max(4,e.utilization)}%`},transition:{delay:.05*t},className:`w-full rounded-t ${e.utilization>50?"bg-error-red":e.utilization>30?"bg-accent-orange":"bg-accent-green"}`}),(0,r.jsxs)("span",{className:"text-[8px] text-text-tertiary",children:["M",e.month]})]},t))}),(0,r.jsxs)("div",{className:"relative h-0 -mt-24 pointer-events-none",children:[r.jsx("div",{className:"absolute w-full border-t border-dashed border-accent-orange/30",style:{bottom:"30%"}}),r.jsx("div",{className:"absolute w-full border-t border-dashed border-error-red/30",style:{bottom:"50%"}})]})]}),h&&(0,r.jsxs)("div",{className:`p-3 rounded-lg border ${h.cumulativeImpact>0?"bg-accent-green/10 border-accent-green/20":h.cumulativeImpact<-10?"bg-error-red/10 border-error-red/20":"bg-accent-orange/10 border-accent-orange/20"}`,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[h.cumulativeImpact>0?r.jsx(rb.Z,{className:"w-4 h-4 text-accent-green"}):h.cumulativeImpact<-10?r.jsx(rj,{className:"w-4 h-4 text-error-red"}):r.jsx(rw,{className:"w-4 h-4 text-accent-orange"}),r.jsx("span",{className:"text-sm font-medium text-white",children:"Projected Score Impact"})]}),(0,r.jsxs)("span",{className:`text-lg font-mono font-bold ${h.cumulativeImpact>0?"text-accent-green":h.cumulativeImpact<-10?"text-error-red":"text-accent-orange"}`,children:[h.cumulativeImpact>0?"+":"",h.cumulativeImpact]})]}),r.jsx("p",{className:"text-xs text-text-secondary",children:"low"===u?"Excellent! Low utilization supports credit score growth.":"moderate"===u?"Good utilization. Consider spreading across cards for optimization.":"High utilization may impact your score. Consider increasing payments."})]}),(0,r.jsxs)("div",{className:"mt-3 flex items-start gap-2 p-2 bg-white/5 rounded-lg",children:[r.jsx(nE,{className:"w-3 h-3 text-text-tertiary mt-0.5 flex-shrink-0"}),r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Keep utilization below 30% for optimal credit score. This simulation assumes 70% monthly payoff."})]})]})]})}let l5=(0,nk.Z)("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),l3=[{category:"Dining",icon:"\uD83C\uDF7D",amounts:[45,0,32,78,0,125,55],total:335,trend:12},{category:"Grocery",icon:"\uD83D\uDED2",amounts:[0,156,0,0,89,0,234],total:479,trend:-5},{category:"Gas",icon:"",amounts:[52,0,0,48,0,0,55],total:155,trend:8},{category:"Shopping",icon:"\uD83D\uDECD",amounts:[0,0,299,0,0,156,0],total:455,trend:25},{category:"Travel",icon:"",amounts:[0,0,0,0,0,850,0],total:850,trend:100},{category:"Entertainment",icon:"\uD83C\uDFAC",amounts:[15,0,0,22,35,0,18],total:90,trend:-15},{category:"Subscriptions",icon:"\uD83D\uDCF1",amounts:[0,45,0,0,0,0,0],total:45,trend:0},{category:"Other",icon:"\uD83D\uDCE6",amounts:[0,25,0,88,0,0,45],total:158,trend:10}],l4=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function l8(){let[e,t]=(0,l.useState)(null),[s,i]=(0,l.useState)("week"),a=(0,l.useMemo)(()=>Math.max(...l3.flatMap(e=>e.amounts)),[]),n=(0,l.useMemo)(()=>l3.reduce((e,t)=>e+t.total,0),[]),o=e=>{if(0===e)return"bg-white/5";let t=e/a;return t>.7?"bg-accent-purple":t>.4?"bg-accent-blue":t>.2?"bg-accent-teal":"bg-accent-green/50"},c=e?l3.find(t=>t.category===e):null;return(0,r.jsxs)(np.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-accent-purple/10 via-surface-50 to-accent-blue/10 rounded-xl border border-white/10 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-4 py-3 border-b border-white/5 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(l5,{className:"w-4 h-4 text-accent-purple"}),r.jsx("h3",{className:"text-sm font-semibold text-white",children:"Spending Heatmap"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>i("week"),className:`px-2 py-0.5 text-[10px] rounded ${"week"===s?"bg-accent-purple/20 text-accent-purple":"text-text-tertiary"}`,children:"Week"}),r.jsx("button",{onClick:()=>i("month"),className:`px-2 py-0.5 text-[10px] rounded ${"month"===s?"bg-accent-purple/20 text-accent-purple":"text-text-tertiary"}`,children:"Month"})]})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4 p-3 bg-white/5 rounded-lg",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase",children:"Total This Week"}),(0,r.jsxs)("p",{className:"text-xl font-mono font-bold text-white",children:["$",n.toLocaleString()]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Highest Day"}),r.jsx("p",{className:"text-sm font-mono text-accent-purple",children:"Saturday"})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Top Category"}),r.jsx("p",{className:"text-sm font-mono text-accent-purple",children:"Travel"})]})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-8 gap-1 mb-1",children:[r.jsx("div",{className:"text-[10px] text-text-tertiary"}),l4.map(e=>r.jsx("div",{className:"text-[10px] text-text-tertiary text-center",children:e},e))]}),l3.map((s,i)=>(0,r.jsxs)(np.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.03*i},className:`grid grid-cols-8 gap-1 mb-1 cursor-pointer rounded transition-all ${e===s.category?"bg-white/10":"hover:bg-white/5"}`,onClick:()=>t(e===s.category?null:s.category),children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-text-secondary truncate pr-1",children:[r.jsx("span",{children:s.icon}),r.jsx("span",{className:"truncate",children:s.category})]}),s.amounts.map((e,t)=>r.jsx(np.div,{whileHover:{scale:1.1},className:`aspect-square rounded-sm ${o(e)} relative group`,title:`$${e}`,children:e>0&&r.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,r.jsxs)("span",{className:"text-[8px] font-mono text-white font-bold",children:["$",e]})})},t))]},s.category))]}),(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-4",children:[r.jsx("span",{className:"text-[10px] text-text-tertiary",children:"Less"}),(0,r.jsxs)("div",{className:"flex gap-1",children:[r.jsx("div",{className:"w-3 h-3 rounded-sm bg-white/5"}),r.jsx("div",{className:"w-3 h-3 rounded-sm bg-accent-green/50"}),r.jsx("div",{className:"w-3 h-3 rounded-sm bg-accent-teal"}),r.jsx("div",{className:"w-3 h-3 rounded-sm bg-accent-blue"}),r.jsx("div",{className:"w-3 h-3 rounded-sm bg-accent-purple"})]}),r.jsx("span",{className:"text-[10px] text-text-tertiary",children:"More"})]}),c&&(0,r.jsxs)(np.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"p-3 bg-white/5 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-lg",children:c.icon}),r.jsx("span",{className:"text-sm font-medium text-white",children:c.category})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[r.jsx(rb.Z,{className:`w-3 h-3 ${c.trend>=0?"text-accent-green":"text-error-red"}`}),(0,r.jsxs)("span",{className:`text-xs font-mono ${c.trend>=0?"text-accent-green":"text-error-red"}`,children:[c.trend>=0?"+":"",c.trend,"%"]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Weekly Total"}),(0,r.jsxs)("p",{className:"text-sm font-mono text-white",children:["$",c.total]})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Daily Avg"}),(0,r.jsxs)("p",{className:"text-sm font-mono text-white",children:["$",Math.round(c.total/7)]})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-[10px] text-text-tertiary",children:"Active Days"}),r.jsx("p",{className:"text-sm font-mono text-white",children:c.amounts.filter(e=>e>0).length})]})]})]})]})]})}function l6({stageResults:e,isRunning:t}){let s=(0,l.useMemo)(()=>{if(0===e.length)return[];let t=e.reduce((e,t)=>e+t.durationMs,0);return e.map(e=>{let s=e.durationMs/t*100,i="normal";return e.durationMs<20?i="fast":e.durationMs>100&&(i="slow"),{name:e.stageName,duration:e.durationMs,actualDuration:e.actualDurationMs||0,percentage:s,status:i}})},[e]),i=e.reduce((e,t)=>e+t.durationMs,0),a=e.reduce((e,t)=>e+(t.actualDurationMs||0),0),n=[...s].sort((e,t)=>t.duration-e.duration)[0],o=s.length>0?i/s.length:0,c=e=>{switch(e){case"fast":return"text-accent-green bg-accent-green";case"slow":return"text-accent-orange bg-accent-orange";default:return"text-accent-blue bg-accent-blue"}};return 0!==e.length||t?(0,r.jsxs)(np.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-accent-orange/10 via-surface-50 to-accent-pink/10 rounded-xl border border-white/10 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-4 py-3 border-b border-white/5 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(re,{className:"w-4 h-4 text-accent-orange"}),r.jsx("h3",{className:"text-sm font-semibold text-white",children:"Performance Profiler"})]}),t&&(0,r.jsxs)(np.div,{animate:{opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0},className:"flex items-center gap-1 text-accent-orange",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-accent-orange"}),r.jsx("span",{className:"text-[10px]",children:"Profiling..."})]})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-3 mb-4",children:[(0,r.jsxs)("div",{className:"p-2 bg-white/5 rounded-lg text-center",children:[r.jsx(n2.Z,{className:"w-4 h-4 text-accent-blue mx-auto mb-1"}),r.jsx("p",{className:"text-lg font-mono font-bold text-white",children:i}),r.jsx("p",{className:"text-[9px] text-text-tertiary",children:"Total (sim) ms"})]}),(0,r.jsxs)("div",{className:"p-2 bg-white/5 rounded-lg text-center",children:[r.jsx(nN.Z,{className:"w-4 h-4 text-accent-green mx-auto mb-1"}),r.jsx("p",{className:"text-lg font-mono font-bold text-white",children:a}),r.jsx("p",{className:"text-[9px] text-text-tertiary",children:"Total (actual) ms"})]}),(0,r.jsxs)("div",{className:"p-2 bg-white/5 rounded-lg text-center",children:[r.jsx(re,{className:"w-4 h-4 text-accent-purple mx-auto mb-1"}),r.jsx("p",{className:"text-lg font-mono font-bold text-white",children:o.toFixed(0)}),r.jsx("p",{className:"text-[9px] text-text-tertiary",children:"Avg Stage ms"})]}),(0,r.jsxs)("div",{className:"p-2 bg-white/5 rounded-lg text-center",children:[r.jsx(n1.Z,{className:"w-4 h-4 text-accent-orange mx-auto mb-1"}),r.jsx("p",{className:"text-sm font-mono font-bold text-white truncate",children:n?.name||"-"}),r.jsx("p",{className:"text-[9px] text-text-tertiary",children:"Slowest Stage"})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase mb-2",children:"Execution Timeline"}),r.jsx("div",{className:"h-8 bg-black/30 rounded-lg overflow-hidden flex",children:s.map((e,t)=>(0,r.jsxs)(np.div,{initial:{width:0},animate:{width:`${e.percentage}%`},transition:{delay:.05*t,duration:.3},className:`h-full ${c(e.status).split(" ")[1]}/60 border-r border-black/20 flex items-center justify-center group relative cursor-pointer hover:brightness-110`,title:`${e.name}: ${e.duration}ms`,children:[e.percentage>10&&r.jsx("span",{className:"text-[9px] text-white font-mono truncate px-1",children:e.name.split(" ")[0]}),r.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 hidden group-hover:block z-10",children:(0,r.jsxs)("div",{className:"bg-surface-100 border border-white/20 rounded px-2 py-1 text-[10px] whitespace-nowrap",children:[r.jsx("p",{className:"text-white font-medium",children:e.name}),(0,r.jsxs)("p",{className:"text-text-tertiary",children:[e.duration,"ms (",e.percentage.toFixed(1),"%)"]})]})})]},e.name))})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase",children:"Stage Breakdown"}),s.map((e,t)=>(0,r.jsxs)(np.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.03*t},className:"flex items-center gap-3 p-2 bg-white/5 rounded-lg",children:[r.jsx("div",{className:`w-2 h-2 rounded-full ${c(e.status).split(" ")[1]}`}),r.jsx("span",{className:"text-xs text-text-secondary flex-1 truncate",children:e.name}),r.jsx("div",{className:"w-24 h-2 bg-black/30 rounded-full overflow-hidden",children:r.jsx(np.div,{initial:{width:0},animate:{width:`${e.percentage}%`},className:`h-full ${c(e.status).split(" ")[1]}/80 rounded-full`})}),(0,r.jsxs)("span",{className:`text-xs font-mono w-12 text-right ${c(e.status).split(" ")[0]}`,children:[e.duration,"ms"]}),"fast"===e.status&&r.jsx(nQ,{className:"w-3 h-3 text-accent-green"}),"slow"===e.status&&r.jsx(n1.Z,{className:"w-3 h-3 text-accent-orange"})]},e.name))]}),n&&"slow"===n.status&&(0,r.jsxs)("div",{className:"mt-4 p-3 bg-accent-orange/10 border border-accent-orange/20 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(n1.Z,{className:"w-4 h-4 text-accent-orange"}),r.jsx("span",{className:"text-xs font-medium text-accent-orange",children:"Performance Insight"})]}),(0,r.jsxs)("p",{className:"text-[11px] text-text-secondary",children:[n.name," took ",n.duration,"ms (",n.percentage.toFixed(1),"% of total). Consider optimizing this stage for better overall performance."]})]})]})]}):null}let l9=(0,nk.Z)("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);function l7({evaluations:e,context:t,tokens:s}){let[i,a]=(0,l.useState)(!1),[n,o]=(0,l.useState)(0),[c,d]=(0,l.useState)(new Set),h=e.map(e=>({ruleId:e.ruleId,ruleLabel:e.ruleLabel,ruleType:e.ruleType,matched:e.matched,reason:e.reason,action:e.action})),u=e=>{d(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},x=e.filter(e=>"HARD"===e.ruleType),m=e.filter(e=>"SOFT"===e.ruleType);return 0===e.length?null:(0,r.jsxs)(np.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-accent-pink/10 via-surface-50 to-accent-purple/10 rounded-xl border border-white/10 overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-4 py-3 border-b border-white/5 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(l9,{className:"w-4 h-4 text-accent-pink"}),r.jsx("h3",{className:"text-sm font-semibold text-white",children:"Rule Debugger"})]}),r.jsx("div",{className:"flex items-center gap-2",children:i?(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{onClick:()=>{n<h.length-1?o(e=>e+1):a(!1)},className:"p-1 text-text-tertiary hover:text-white transition-colors",children:r.jsx(nC,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>{o(0),a(!1)},className:"p-1 text-text-tertiary hover:text-white transition-colors",children:r.jsx(rz,{className:"w-4 h-4"})})]}):(0,r.jsxs)("button",{onClick:()=>{a(!0),o(0)},disabled:0===h.length,className:"px-2 py-1 text-[10px] bg-accent-pink/20 text-accent-pink rounded flex items-center gap-1 hover:bg-accent-pink/30 transition-colors disabled:opacity-50",children:[r.jsx(nS,{className:"w-3 h-3"}),"Step Through"]})})]}),(0,r.jsxs)("div",{className:"p-4",children:[i&&h.length>0&&(0,r.jsxs)("div",{className:"mb-4 p-3 bg-black/30 rounded-lg border border-accent-pink/20",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("span",{className:"text-[10px] text-text-tertiary",children:["Step ",n+1," of ",h.length]}),r.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${"HARD"===h[n].ruleType?"bg-error-red/20 text-error-red":"bg-accent-blue/20 text-accent-blue"}`,children:h[n].ruleType})]}),(0,r.jsxs)(np.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[h[n].matched?r.jsx(nQ,{className:"w-4 h-4 text-accent-green"}):r.jsx(n0,{className:"w-4 h-4 text-error-red"}),r.jsx("span",{className:"text-sm font-medium text-white",children:h[n].ruleLabel})]}),(0,r.jsxs)("div",{className:"p-2 bg-white/5 rounded text-xs",children:[r.jsx("p",{className:"text-text-tertiary text-[10px] mb-1",children:"Result"}),r.jsx("p",{className:"text-white",children:h[n].reason})]}),h[n].action&&(0,r.jsxs)("div",{className:"p-2 bg-accent-purple/10 rounded text-xs",children:[r.jsx("p",{className:"text-text-tertiary text-[10px] mb-1",children:"Action"}),r.jsx("p",{className:"text-accent-purple font-mono",children:h[n].action})]})]},n),r.jsx("div",{className:"mt-3 h-1 bg-white/10 rounded-full overflow-hidden",children:r.jsx(np.div,{initial:{width:0},animate:{width:`${(n+1)/h.length*100}%`},className:"h-full bg-accent-pink rounded-full"})})]}),(0,r.jsxs)("div",{className:"mb-4 p-3 bg-white/5 rounded-lg",children:[r.jsx("p",{className:"text-[10px] text-text-tertiary uppercase mb-2",children:"Current Context"}),(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-[10px]",children:[(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-text-tertiary",children:"MCC"}),r.jsx("p",{className:"text-white font-mono",children:t.mcc})]}),(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-text-tertiary",children:"Amount"}),(0,r.jsxs)("p",{className:"text-white font-mono",children:["$",t.amount]})]}),(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-text-tertiary",children:"Currency"}),r.jsx("p",{className:"text-white font-mono",children:t.currency})]}),(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-text-tertiary",children:"Tokens"}),r.jsx("p",{className:"text-white font-mono",children:s.length})]})]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[x.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-[10px] text-text-tertiary uppercase tracking-wider mb-2 flex items-center gap-2",children:[r.jsx(n1.Z,{className:"w-3 h-3 text-error-red"}),"Hard Rules (",x.length,")"]}),r.jsx("div",{className:"space-y-1",children:x.map(e=>r.jsx(oe,{rule:e,isExpanded:c.has(e.ruleId),onToggle:()=>u(e.ruleId)},e.ruleId))})]}),m.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-[10px] text-text-tertiary uppercase tracking-wider mb-2 flex items-center gap-2",children:[r.jsx(nQ,{className:"w-3 h-3 text-accent-blue"}),"Soft Rules (",m.length,")"]}),r.jsx("div",{className:"space-y-1",children:m.map(e=>r.jsx(oe,{rule:e,isExpanded:c.has(e.ruleId),onToggle:()=>u(e.ruleId)},e.ruleId))})]})]}),(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-2 text-center",children:[(0,r.jsxs)("div",{className:"p-2 bg-accent-green/10 rounded-lg",children:[r.jsx("p",{className:"text-lg font-mono font-bold text-accent-green",children:e.filter(e=>e.matched).length}),r.jsx("p",{className:"text-[9px] text-text-tertiary",children:"Matched"})]}),(0,r.jsxs)("div",{className:"p-2 bg-error-red/10 rounded-lg",children:[r.jsx("p",{className:"text-lg font-mono font-bold text-error-red",children:e.filter(e=>!e.matched).length}),r.jsx("p",{className:"text-[9px] text-text-tertiary",children:"Failed"})]}),(0,r.jsxs)("div",{className:"p-2 bg-accent-purple/10 rounded-lg",children:[r.jsx("p",{className:"text-lg font-mono font-bold text-accent-purple",children:e.filter(e=>e.action).length}),r.jsx("p",{className:"text-[9px] text-text-tertiary",children:"With Actions"})]})]})]})]})}function oe({rule:e,isExpanded:t,onToggle:s}){return(0,r.jsxs)("div",{className:`rounded-lg border transition-all ${e.matched?"bg-accent-green/5 border-accent-green/20":"bg-white/5 border-white/10"}`,children:[(0,r.jsxs)("button",{onClick:s,className:"w-full p-2 flex items-center gap-2 text-left",children:[t?r.jsx(nL,{className:"w-3 h-3 text-text-tertiary"}):r.jsx(nO.Z,{className:"w-3 h-3 text-text-tertiary"}),e.matched?r.jsx(nQ,{className:"w-3 h-3 text-accent-green"}):r.jsx(n0,{className:"w-3 h-3 text-error-red"}),r.jsx("span",{className:"text-xs text-white flex-1 truncate",children:e.ruleLabel}),r.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${"HARD"===e.ruleType?"bg-error-red/20 text-error-red":"bg-accent-blue/20 text-accent-blue"}`,children:e.ruleType})]}),r.jsx(nw,{children:t&&r.jsx(np.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:(0,r.jsxs)("div",{className:"px-3 pb-3 pt-1 space-y-2 border-t border-white/5",children:[(0,r.jsxs)("div",{className:"p-2 bg-black/20 rounded",children:[r.jsx("p",{className:"text-[9px] text-text-tertiary mb-1",children:"Reason"}),r.jsx("p",{className:"text-[11px] text-white",children:e.reason})]}),e.action&&(0,r.jsxs)("div",{className:"p-2 bg-accent-purple/10 rounded",children:[r.jsx("p",{className:"text-[9px] text-text-tertiary mb-1",children:"Action"}),r.jsx("p",{className:"text-[11px] text-accent-purple font-mono",children:e.action})]}),e.forcedToken&&(0,r.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-accent-green/10 rounded",children:[r.jsx("span",{className:"text-[9px] text-text-tertiary",children:"Forces:"}),r.jsx("span",{className:"text-[10px] text-accent-green font-mono",children:e.forcedToken})]}),e.excludedTokens&&e.excludedTokens.length>0&&(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-[9px] text-text-tertiary mb-1",children:"Excludes:"}),r.jsx("div",{className:"flex flex-wrap gap-1",children:e.excludedTokens.map(e=>r.jsx("span",{className:"px-1.5 py-0.5 bg-error-red/20 text-error-red text-[9px] rounded",children:e},e))})]}),e.dslSnippet&&r.jsx("div",{className:"p-2 bg-black/30 rounded font-mono text-[9px] text-text-secondary overflow-x-auto",children:r.jsx("pre",{children:e.dslSnippet})})]})})})]})}function ot(){let e=(0,l.useRef)(null),[t,s]=(0,l.useState)(()=>lv()),[i,a]=(0,l.useState)(""),[n,o]=(0,l.useState)(!1),[c,d]=(0,l.useState)(!1),[h,u]=(0,l.useState)("normal"),[x,m]=(0,l.useState)(-1),[p,g]=(0,l.useState)([]),[f,y]=(0,l.useState)(!1),[v,b]=(0,l.useState)(!1),[j,w]=(0,l.useState)("pipeline"),[N,k]=(0,l.useState)(!1),[S,C]=(0,l.useState)(!1),[R,T]=(0,l.useState)(!1),{history:P,addEntry:M,clearHistory:D}=function(){let[e,t]=(0,l.useState)([]);return{history:e,addEntry:(e,s,i,a)=>{let n={id:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,timestamp:Date.now(),correlationId:e.correlationId,scenario:i,context:s,selectedRoute:e.selectedRoute,selectedRouteName:e.selectedRouteName,approved:e.authResult.approved,topScore:e.scoreBreakdown.find(t=>t.tokenId===e.selectedRoute)?.finalScore||0,totalLatency:a,ruleOverride:e.hardRuleOverride};t(e=>[n,...e].slice(0,20))},clearHistory:()=>{t([])}}}();!function(){let[e,t]=(0,l.useState)(null)}();let[A,E]=(0,l.useState)("scenario_dining_domestic"),[F,$]=(0,l.useState)(()=>{let e=n_.find(e=>"scenario_dining_domestic"===e.id);return{amount:50,currency:"USD",merchant:"Generic Merchant",mcc:5999,category:"other",country:"US",walletType:"apple_pay",isInPerson:!0,riskFlags:[],timestamp:Date.now(),correlationId:"",...e?.context}}),[I,L]=(0,l.useState)(()=>({...nz})),[O,V]=(0,l.useState)(null),[B,z]=(0,l.useState)(null),[U,_]=(0,l.useState)(null),[Z,H]=(0,l.useState)(null),[W,q]=(0,l.useState)([]),[G,X]=(0,l.useState)([]),[K,Y]=(0,l.useState)(0),J=lw(),Q=p.reduce((e,t)=>e+t.durationMs,0),ee=p.reduce((e,t)=>e+(t.actualDurationMs||0),0),et=B?.authResult.approved?"APPROVED":B?.authResult.approved===!1?"DECLINED":"",es=B?.selectedRouteName||"",ei=B?.selectionMethod||null,ea={decision:p.flatMap(e=>e.logs.filter(e=>["Route Selection","Optimization Scoring","Candidate Filtering","Rule Evaluation"].includes(e.stage))),policy:p.flatMap(e=>e.logs.filter(e=>["Policy Load (Registry)","Rule Compile"].includes(e.stage))),risk:p.flatMap(e=>e.logs.filter(e=>e.message.toLowerCase().includes("risk")||"Authorization Gateway"===e.stage))},en=(0,l.useCallback)(e=>{if(E(e),"custom"===e)return;let t=n_.find(t=>t.id===e);t&&$(e=>({...e,...t.context}))},[]),er=(0,l.useCallback)(async()=>{if(n&&!c)return;B&&_({selectedRoute:B.selectedRoute,scores:B.scoreBreakdown}),o(!0),d(!1),g([]),m(0),V(null),z(null),H(null),q([]),X([]);let s=new l$(t,h);e.current=s,a(s.getCorrelationId());try{let e=await s.runPipeline(F,I,(e,t)=>{m(t),g(t=>[...t,e])});V(e.trace),z(e.auditRecord),a(e.auditRecord.correlationId);let t=[...e.auditRecord.matchedRules,...e.auditRecord.failedRules];if(q(t),e.scoringResult.candidateCount>=2){let t=function(e,t,s=.1){let i=[],a=e.filter(e=>!e.excluded);if(a.length<2)return i;let n=a[0];for(let e of["rewards","credit","cashflow","risk"])for(let r of["increase","decrease"]){let l={...t},o="increase"===r?s:-s;l[e]=lM(l[e]+o,0,1);let c=l.rewards+l.credit+l.cashflow+l.risk;c>0&&(l.rewards/=c,l.credit/=c,l.cashflow/=c,l.risk/=c);let d=a.map(e=>{let t=e.subscores.rewards.normalized*l.rewards+e.subscores.credit.normalized*l.credit+e.subscores.cashflow.normalized*l.cashflow+e.subscores.risk.normalized*l.risk;return{tokenId:e.tokenId,tokenName:e.tokenName,score:lM(t+e.totalBonuses-e.totalPenalties,0,100)}});d.sort((e,t)=>t.score-e.score);let h=d[0];i.push({criterion:e,direction:r,perturbation:s,originalWinner:n.tokenId,newWinner:h.tokenId,winnerChanged:h.tokenId!==n.tokenId,newScore:lD(h.score)})}return i}(e.scoringResult.scores,e.scoringResult.weightsUsed,.1);X(t)}if(Y(e=>e+1),M(e.auditRecord,F,A,Q),U&&U.selectedRoute!==e.auditRecord.selectedRoute){let t=e.auditRecord.scoreBreakdown.map(e=>{let t=U.scores.find(t=>t.tokenId===e.tokenId);return{tokenId:e.tokenId,tokenName:e.tokenName,previousScore:t?.finalScore||0,newScore:e.finalScore,delta:e.finalScore-(t?.finalScore||0)}}).filter(e=>Math.abs(e.delta)>.5);H({previousSelection:U.selectedRoute,newSelection:e.auditRecord.selectedRoute,changedAtStage:e.auditRecord.hardRuleOverride?"Rule Evaluation":"Optimization Scoring",reason:e.auditRecord.hardRuleOverride?"Hard rule override changed selection":"Score optimization resulted in different winner",scoreDeltas:t}),b(!0)}}catch(e){console.error("Pipeline error:",e)}finally{o(!1),m(-1)}},[t,F,I,n,c,B,U,h]),el=(0,l.useCallback)(()=>{er()},[er]),eo=(0,l.useCallback)(()=>{s(lv()),a(""),g([]),V(null),z(null),_(null),H(null),X([])},[]),ec=(0,l.useCallback)(()=>{O&&os(JSON.stringify(O,null,2),`stop-trace-${i.slice(0,8)}.json`)},[O,i]),ed=(0,l.useCallback)(()=>{B&&os(JSON.stringify(B,null,2),`stop-audit-${i.slice(0,8)}.json`)},[B,i]),[eh,eu]=(0,l.useState)(0),ex=(0,l.useCallback)(e=>{(function(e){let t=lj.versions.find(e=>e.version===lj.currentVersion);if(!t)return;let s=t.rules.find(t=>t.id===e);s&&(s.enabled=!s.enabled,t.signatureHash=lb(t.rules),s.enabled)})(e),eu(e=>e+1)},[]),em=(0,l.useCallback)(e=>{L(t=>({...t,preferenceWeights:e}))},[]),ep=(0,l.useMemo)(()=>{if(B)return I.tokens.find(e=>e.id===B.selectedRoute)||I.drtTokens.find(e=>e.id===B.selectedRoute)},[B,I]),eg=(0,l.useMemo)(()=>{if(B)return B.scoreBreakdown.find(e=>e.tokenId===B.selectedRoute)},[B]),ef=(0,l.useCallback)(async e=>{let s=n_.find(t=>t.id===e);if(!s)return null;let i={...F,...s.context},a=new l$(t,"turbo");try{let e=(await a.runPipeline(i,I,()=>{})).scoringResult.scores.filter(e=>!e.excluded).sort((e,t)=>t.finalScore-e.finalScore);return{winner:e[0],runnerUp:e[1]||null}}catch{return null}},[F,I,t]),ey=(0,l.useCallback)(e=>{$(e.context),E(e.scenario),setTimeout(()=>er(),100)},[er]);return(0,r.jsxs)("div",{className:"h-screen flex flex-col bg-void grid-bg overflow-hidden",children:[r.jsx(n$,{correlationId:i,seed:t,policyVersion:J.version,policySignature:B?.policySignatureShort||"",policyCacheHit:B?.policyCacheHit||!1,isPinned:lN(),simulatedLatency:Q,actualLatency:ee,authResult:et,authProbability:B?.declineProbability||0,selectedRoute:es,selectionMethod:ei,isRunning:n,isPaused:c,speedMode:h,onSpeedModeChange:u,onRun:er,onStep:()=>{},onPause:()=>d(!c),onReplay:el,onNewSeed:eo,onExportTrace:ec,onExportAudit:ed,extraActions:(0,r.jsxs)(r.Fragment,{children:[r.jsx(lL,{baseWeights:I.preferenceWeights,context:F,user:I,seed:t}),r.jsx(lt,{currentScenario:A,onRunComparison:ef}),r.jsx(l1,{tokens:[...I.tokens,...I.drtTokens],currentMCC:String(F.mcc)}),r.jsx(lq,{onClick:()=>T(!0)}),r.jsx(lB,{history:P,onReplay:ey,onClear:D}),r.jsx(r6,{context:F,weights:I.preferenceWeights,seed:t,scenario:A}),r.jsx(r7,{auditRecord:B,context:F}),r.jsx(lm,{onClick:()=>C(!0)})]})}),r.jsx("div",{className:"lg:hidden flex border-b border-gray-800 bg-void-light",children:["inputs","pipeline","results"].map(e=>r.jsx("button",{onClick:()=>w(e),className:`flex-1 py-2 text-xs font-mono uppercase tracking-wider transition-colors ${j===e?"text-neon-cyan border-b-2 border-neon-cyan bg-neon-cyan/5":"text-gray-500 hover:text-gray-400"}`,children:e},e))}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col lg:flex-row overflow-hidden",children:[(0,r.jsxs)("div",{className:`${"inputs"===j?"flex":"hidden"} lg:flex w-full lg:w-80 border-r border-white/5 overflow-hidden flex-col bg-surface-100/50`,children:[r.jsx("div",{className:"panel-header px-4 py-3 border-b border-white/5 hidden lg:block bg-surface-50/50",children:r.jsx("span",{className:"font-mono text-[10px] text-text-tertiary uppercase tracking-wider",children:"Transaction Inputs"})}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[r.jsx(nq,{context:F,user:I,selectedScenario:A,onContextChange:$,onUserChange:L,onScenarioSelect:en}),r.jsx("div",{className:"p-3 border-t border-white/5",children:r.jsx(r_,{weights:I.preferenceWeights,onChange:em,disabled:n})})]})]}),(0,r.jsxs)("div",{className:`${"pipeline"===j?"flex":"hidden"} lg:flex flex-1 border-r border-white/5 overflow-hidden flex-col`,children:[(0,r.jsxs)("div",{className:"panel-header px-4 py-3 border-b border-white/5 hidden lg:flex items-center justify-between bg-surface-50/50",children:[r.jsx("span",{className:"font-mono text-[10px] text-text-tertiary uppercase tracking-wider",children:"Decision Engine Visualization"}),B&&(0,r.jsxs)(np.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[10px] text-text-secondary",children:"Result:"}),r.jsx("span",{className:`text-xs font-semibold px-2 py-0.5 rounded-full ${B.authResult.approved?"bg-accent-green/10 text-accent-green border border-accent-green/20":"bg-error-red/10 text-error-red border border-error-red/20"}`,children:B.authResult.approved?"APPROVED":"DECLINED"})]})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[!B&&!n&&(0,r.jsxs)(np.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center justify-center h-full text-center p-8",children:[r.jsx("div",{className:"w-16 h-16 rounded-2xl bg-accent-blue/10 border border-accent-blue/20 flex items-center justify-center mb-4",children:r.jsx("svg",{className:"w-8 h-8 text-accent-blue",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),r.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Ready to Optimize"}),(0,r.jsxs)("p",{className:"text-sm text-text-secondary mb-4 max-w-sm",children:["Configure your transaction inputs and click ",r.jsx("strong",{children:"Run"})," to see the intelligent payment routing engine in action."]}),r.jsx("button",{onClick:er,className:"px-4 py-2 bg-accent-blue/20 hover:bg-accent-blue/30 border border-accent-blue/40 rounded-lg text-accent-blue font-medium text-sm transition-colors",children:"Run Pipeline"})]}),n&&0===p.length&&r.jsx(ll,{}),B?.shadowOptimization&&r.jsx(r0,{shadow:B.shadowOptimization}),r.jsx(nw,{children:B&&r.jsx(rS,{isVisible:!!B,scores:B.scoreBreakdown,matchedRules:B.matchedRules,excludedTokens:B.excludedTokens,selectedTokenId:B.selectedRoute,selectedTokenName:B.selectedRouteName,isForced:B.hardRuleOverride,forcingRule:"FORCED"===B.selectionMethod.type?B.selectionMethod.ruleLabel:void 0})}),B&&B.scoreBreakdown.length>=2&&r.jsx(rZ,{scores:B.scoreBreakdown,selectedTokenId:B.selectedRoute}),B&&B.scoreBreakdown.length>0&&r.jsx(rR,{scores:B.scoreBreakdown,selectedTokenId:B.selectedRoute}),B&&(0,r.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[r.jsx(rG,{evaluations:W,scores:B.scoreBreakdown}),eg&&r.jsx(rQ,{score:eg,context:F,token:ep})]}),B&&B.scoreBreakdown.length>0&&r.jsx(rV,{scores:B.scoreBreakdown,selectedTokenId:B.selectedRoute}),B&&(0,r.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[r.jsx(li,{tokens:[...I.tokens,...I.drtTokens],scores:B.scoreBreakdown,selectedTokenId:B.selectedRoute}),r.jsx(ln,{scores:B.scoreBreakdown,selectedTokenId:B.selectedRoute,context:F,transactionCount:K})]}),B&&G.length>0&&r.jsx(r5,{sensitivity:G,currentWinnerName:B.selectedRouteName}),B&&r.jsx(lJ,{scores:B.scoreBreakdown,context:F,userTokens:[...I.tokens,...I.drtTokens]}),B&&(0,r.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[r.jsx(l2,{tokens:[...I.tokens,...I.drtTokens],selectedTokenId:B.selectedRoute,context:F}),r.jsx(l8,{})]}),(B||p.length>0)&&(0,r.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[r.jsx(l6,{stageResults:p,isRunning:n}),B&&r.jsx(l7,{evaluations:W,context:F,tokens:[...I.tokens,...I.drtTokens]})]}),(n||p.length>0)&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx("div",{className:"w-1 h-4 bg-accent-blue rounded-full"}),r.jsx("span",{className:"text-xs font-semibold text-white uppercase tracking-wider",children:"Pipeline Stages"})]}),r.jsx(n8,{stageResults:p,currentStageIndex:x,isRunning:n})]})]})]}),(0,r.jsxs)("div",{className:`${"results"===j?"flex":"hidden"} lg:flex w-full lg:w-[400px] overflow-hidden flex-col bg-surface-100/50`,children:[r.jsx("div",{className:"panel-header px-4 py-3 border-b border-white/5 hidden lg:block bg-surface-50/50",children:r.jsx("span",{className:"font-mono text-[10px] text-text-tertiary uppercase tracking-wider",children:"Trace Inspector"})}),r.jsx("div",{className:"flex-1 overflow-hidden",children:r.jsx(rn,{trace:O,auditRecord:B,logs:ea,sensitivity:G})})]})]}),r.jsx(ry,{rules:J.rules,evaluationResults:W,isExpanded:f,onToggleExpand:()=>y(!f),onToggleRule:ex}),r.jsx(nw,{children:v&&Z&&r.jsx(rN,{diff:Z,onClose:()=>b(!1)})}),r.jsx(rL,{isOpen:N,onClose:()=>{k(!1),localStorage.setItem("swipesmart-tour-seen","true")},onRunDemo:er}),!N&&r.jsx(rO,{onClick:()=>k(!0)}),r.jsx(lx,{isOpen:S,onClose:()=>C(!1)}),r.jsx(lW,{isOpen:R,onClose:()=>T(!1),onApplyRules:()=>{}})]})}function os(e,t){let s=new Blob([e],{type:"application/json"}),i=URL.createObjectURL(s),a=document.createElement("a");a.href=i,a.download=t,a.click(),URL.revokeObjectURL(i)}},1506:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,metadata:()=>a});var i=s(9510);s(7272);let a={title:"STOP Engine Lab",description:"Routing pipeline explorer with deterministic replay and full trace"};function n({children:e}){return i.jsx("html",{lang:"en",className:"dark",children:i.jsx("body",{className:"min-h-screen bg-void text-gray-100 antialiased",children:e})})}},908:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});let i=(0,s(8570).createProxy)(String.raw`/Users/noahzaroff/Downloads/stop-engine-lab/app/page.tsx#default`)},7272:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),i=t.X(0,[819,275],()=>s(2319));module.exports=i})();